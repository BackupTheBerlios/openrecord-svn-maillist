<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openrecord-svn] r21 - trunk/source
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/openrecord-svn/2005-April/index.html" >
   <LINK REL="made" HREF="mailto:openrecord-svn%40lists.berlios.de?Subject=Re%3A%20%5Bopenrecord-svn%5D%20r21%20-%20trunk/source&In-Reply-To=%3C200504052100.j35L0aDq005795%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000014.html">
   <LINK REL="Next"  HREF="000016.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openrecord-svn] r21 - trunk/source</H1>
    <B>Brian Douglas Skinner at BerliOS</B> 
    <A HREF="mailto:openrecord-svn%40lists.berlios.de?Subject=Re%3A%20%5Bopenrecord-svn%5D%20r21%20-%20trunk/source&In-Reply-To=%3C200504052100.j35L0aDq005795%40sheep.berlios.de%3E"
       TITLE="[openrecord-svn] r21 - trunk/source">skinner at sheep.berlios.de
       </A><BR>
    <I>Tue Apr  5 23:00:36 CEST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="000014.html">[openrecord-svn] r20 - trunk/source
</A></li>
        <LI>Next message: <A HREF="000016.html">[openrecord-svn] r22 - trunk/source
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15">[ date ]</a>
              <a href="thread.html#15">[ thread ]</a>
              <a href="subject.html#15">[ subject ]</a>
              <a href="author.html#15">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: skinner
Date: 2005-04-05 23:00:35 +0200 (Tue, 05 Apr 2005)
New Revision: 21

Added:
   trunk/source/BarChartPlugin.js
   trunk/source/DetailPlugin.js
   trunk/source/ItemView.js
   trunk/source/OutlinePlugin.js
   trunk/source/PageView.js
   trunk/source/RootView.js
   trunk/source/SectionView.js
   trunk/source/TablePlugin.js
   trunk/source/TextView.js
Removed:
   trunk/source/bar_chart_layout.js
   trunk/source/detail_layout.js
   trunk/source/item.js
   trunk/source/item_view.js
   trunk/source/outline_layout.js
   trunk/source/page_view.js
   trunk/source/rectangle.js
   trunk/source/root_view.js
   trunk/source/section_view.js
   trunk/source/stevedore.js
   trunk/source/table_layout.js
   trunk/source/text_view.js
   trunk/source/util.js
   trunk/source/view.js
Log:


Copied: trunk/source/BarChartPlugin.js (from rev 20, trunk/source/bar_chart_layout.js)

Copied: trunk/source/DetailPlugin.js (from rev 20, trunk/source/detail_layout.js)

Copied: trunk/source/ItemView.js (from rev 20, trunk/source/item_view.js)

Copied: trunk/source/OutlinePlugin.js (from rev 20, trunk/source/outline_layout.js)

Copied: trunk/source/PageView.js (from rev 18, trunk/source/page_view.js)

Copied: trunk/source/RootView.js (from rev 20, trunk/source/root_view.js)

Copied: trunk/source/SectionView.js (from rev 20, trunk/source/section_view.js)

Copied: trunk/source/TablePlugin.js (from rev 20, trunk/source/table_layout.js)

Copied: trunk/source/TextView.js (from rev 20, trunk/source/text_view.js)

Deleted: trunk/source/bar_chart_layout.js
===================================================================
--- trunk/source/bar_chart_layout.js	2005-04-05 05:02:08 UTC (rev 20)
+++ trunk/source/bar_chart_layout.js	2005-04-05 21:00:35 UTC (rev 21)
@@ -1,188 +0,0 @@
-/*****************************************************************************
- bar_chart_layout.js
- 
-******************************************************************************
- Written in 2005 by Brian Douglas Skinner &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openrecord-svn">brian.skinner at gumption.org</A>&gt;
-  
- Copyright rights relinquished under the Creative Commons  
- Public Domain Dedication:
-    <A HREF="http://creativecommons.org/licenses/publicdomain/">http://creativecommons.org/licenses/publicdomain/</A>
-  
- You can copy freely from this file.  This work may be freely reproduced, 
- distributed, transmitted, used, modified, built upon, or otherwise exploited
- by anyone for any purpose.
-  
- This work is provided on an &quot;AS IS&quot; basis, without warranties or conditions 
- of any kind, either express or implied, including, without limitation, any 
- warranties or conditions of title, non-infringement, merchantability, or 
- fitness for a particular purpose. You are solely responsible for determining 
- the appropriateness of using or distributing the work and assume all risks 
- associated with use of this work, including but not limited to the risks and 
- costs of errors, compliance with applicable laws, damage to or loss of data 
- or equipment, and unavailability or interruption of operations.
-
- In no event shall the authors or contributors have any liability for any 
- direct, indirect, incidental, special, exemplary, or consequential damages,
- however caused and on any theory of liability, whether in contract, strict 
- liability, or tort (including negligence), arising in any way out of or in 
- connection with the use or distribution of the work.
-*****************************************************************************/
-
-
-// -------------------------------------------------------------------
-// Dependencies:
-//   repository.js
-//   section_view.js
-//   page_view.js
-//   util.js
-// -------------------------------------------------------------------
-
-
-// -------------------------------------------------------------------
-// Register this layout type in the SectionView registry
-// -------------------------------------------------------------------
-SectionView.ourHashTableOfLayoutClassesKeyedByLayoutName[SectionView.LAYOUT_BAR_CHART] = BarChartLayout;
-
-
-/**
- * A BarChartLayout displays a set of content items for a SectionView. 
- *
- * @scope    public instance constructor
- * @extends  View
- * @param    inSectionView    The SectionView that serves as the superview for this view. 
- * @param    inDivElement    The HTMLDivElement to display this view in. 
- * @syntax   var barChart = new BarChartLayout()
- */
-BarChartLayout.prototype = new View();  // makes BarChartLayout be a subclass of View
-function BarChartLayout(inSectionView, inDivElement) {
-  this.setSuperview(inSectionView);
-  this.setDivElement(inDivElement);
-}
-
-
-/**
- * Returns the registered name of this type of layout.
- *
- * @scope    public instance method
- * @return   A string.
- */
-BarChartLayout.prototype.getLayoutName = function () {
-  return SectionView.LAYOUT_BAR_CHART;
-};
-
-
-/**
- * Re-creates all the HTML for the BarChartLayout, and hands the HTML to the 
- * browser to be re-drawn.
- *
- * @scope    public instance method
- */
-BarChartLayout.prototype.refresh = function () {
-  var listOfStrings = [];
-
-  var contentItem = null;
-  var attributeUuid = null;
-  var hashTableOfNumericValueIncidenceKeyedByAttributeUuid = {};
-  
-  // for each attribute, count the number of items where that attribute has a numeric value
-  // PENDING: how do we know our superview responds to getListOfContentItems()? 
-  var listOfContentItems = this.getSuperview().getListOfContentItems();
-  for (var iKey in listOfContentItems) {
-    contentItem = listOfContentItems[iKey];
-    var listOfAttributesForItem = contentItem.getListOfAttributeUuids();
-    for (var attributeKey in listOfAttributesForItem) {
-      attributeUuid = listOfAttributesForItem[attributeKey];
-      var valueList = contentItem.getValueListFromAttribute(attributeUuid);
-      if (valueList) {
-        var value = valueList[0];
-        if (Util.isNumber(value)) {
-          var count = hashTableOfNumericValueIncidenceKeyedByAttributeUuid[attributeUuid];
-          if (!count) {
-            count = 0;
-          }
-          count += 1;
-          hashTableOfNumericValueIncidenceKeyedByAttributeUuid[attributeUuid] = count;
-        }
-      }
-    }
-  }
-  
-  // find the attribute for which most of the items have a numeric value 
-  var maxIncidence = 0;
-  var selectedAttribute = null;
-  for (attributeUuid in hashTableOfNumericValueIncidenceKeyedByAttributeUuid) {
-    var incidence = hashTableOfNumericValueIncidenceKeyedByAttributeUuid[attributeUuid];
-    if (incidence &gt; maxIncidence) {
-      selectedAttribute = this.getStevedore().getItemFromUuid(attributeUuid);
-      maxIncidence = incidence;
-    }
-  }
-
-  // find the maximum value for the selected attribute
-  if (selectedAttribute) {
-    var maxValue = 0;
-    for (var jkey in listOfContentItems) {
-      contentItem = listOfContentItems[jkey];
-      var nextValueList = contentItem.getValueListFromAttribute(selectedAttribute);
-      var nextValue = nextValueList[0];
-      if (Util.isNumber(nextValue)) {
-        maxValue = Math.max(maxValue, nextValue);
-      }     
-    }
-  }
-
-  // add the table header row(s)
-  listOfStrings.push(&quot;&lt;table class=\&quot;&quot; + SectionView.ELEMENT_CLASS_SIMPLE_TABLE + &quot;\&quot;&gt;&quot;);
-  listOfStrings.push(&quot;&lt;tr&gt;&quot;);
-  var attributeCalledName = this.getStevedore().getItemFromUuid(Stevedore.UUID_FOR_ATTRIBUTE_NAME);
-  listOfStrings.push(&quot;&lt;th&gt;&quot; + attributeCalledName.getDisplayName() + &quot;&lt;/th&gt;&quot;);
-  if (selectedAttribute) {
-    listOfStrings.push(&quot;&lt;th&gt;&quot; + selectedAttribute.getDisplayName() + &quot;&lt;/th&gt;&quot;);
-  } else {
-    listOfStrings.push(&quot;&lt;th&gt;&quot; + &quot;Sorry, there are no attributes with numeric values to chart&quot; + &quot;&lt;/th&gt;&quot;);
-  }
-  listOfStrings.push(&quot;&lt;/tr&gt;&quot;);
-    
-  // add all the table body rows
-  for (var kKey in listOfContentItems) {
-    contentItem = listOfContentItems[kKey];
-    listOfStrings.push(&quot;&lt;tr&gt;&quot;);
-    listOfStrings.push(&quot;&lt;td class=\&quot;&quot; + SectionView.ELEMENT_CLASS_PLAIN + &quot;\&quot;&gt;&quot; + contentItem.getDisplayName(&quot;{no name}&quot;) + &quot;&lt;/td&gt;&quot;);
-    var numericValue = 0;
-    if (selectedAttribute) {
-      var listOfValues = contentItem.getValueListFromAttribute(selectedAttribute);
-      var firstValue = listOfValues[0];
-      if (Util.isNumber(firstValue)) {
-        numericValue = firstValue;
-      }
-    }
-    // listOfStrings.push(&quot;&lt;td class=\&quot;&quot; + SectionView.ELEMENT_CLASS_PLAIN + &quot;\&quot;&gt;&quot; + displayValue + &quot;&lt;/td&gt;&quot;);
-    var width = 0;
-    if (maxValue &gt; 0) {
-      width = (numericValue / maxValue) * 100; // 100 Percent
-    }
-    listOfStrings.push(&quot;&lt;td class=\&quot;bar_chart_frame\&quot;&gt;&lt;input disabled type=\&quot;text\&quot; class=\&quot;bar_chart_bar\&quot; value=\&quot;&quot; + numericValue + &quot;\&quot; size=\&quot;1\&quot; style=\&quot;width: &quot; + width + &quot;%;\&quot;&gt;&lt;/input&gt;&lt;/td&gt;&quot;);
-    listOfStrings.push(&quot;&lt;/tr&gt;&quot;);
-  }  
-  listOfStrings.push(&quot;&lt;/table&gt;&quot;);
-    
-  // return all the new content   
-  var finalString = listOfStrings.join(&quot;&quot;);
-  this.getDivElement().innerHTML = finalString;
-};
-
-
-/**
- * Does final clean-up.
- *
- * @scope    public instance method
- */
-BarChartLayout.prototype.endOfLife = function () {
-  this.getDivElement().innerHTML = &quot;&quot;;
-};
-
-
-// -------------------------------------------------------------------
-// End of file
-// -------------------------------------------------------------------
-

Deleted: trunk/source/detail_layout.js
===================================================================
--- trunk/source/detail_layout.js	2005-04-05 05:02:08 UTC (rev 20)
+++ trunk/source/detail_layout.js	2005-04-05 21:00:35 UTC (rev 21)
@@ -1,153 +0,0 @@
-/*****************************************************************************
- detail_layout.js
- 
-******************************************************************************
- Written in 2005 by Brian Douglas Skinner &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openrecord-svn">brian.skinner at gumption.org</A>&gt;
-  
- Copyright rights relinquished under the Creative Commons  
- Public Domain Dedication:
-    <A HREF="http://creativecommons.org/licenses/publicdomain/">http://creativecommons.org/licenses/publicdomain/</A>
-  
- You can copy freely from this file.  This work may be freely reproduced, 
- distributed, transmitted, used, modified, built upon, or otherwise exploited
- by anyone for any purpose.
-  
- This work is provided on an &quot;AS IS&quot; basis, without warranties or conditions 
- of any kind, either express or implied, including, without limitation, any 
- warranties or conditions of title, non-infringement, merchantability, or 
- fitness for a particular purpose. You are solely responsible for determining 
- the appropriateness of using or distributing the work and assume all risks 
- associated with use of this work, including but not limited to the risks and 
- costs of errors, compliance with applicable laws, damage to or loss of data 
- or equipment, and unavailability or interruption of operations.
-
- In no event shall the authors or contributors have any liability for any 
- direct, indirect, incidental, special, exemplary, or consequential damages,
- however caused and on any theory of liability, whether in contract, strict 
- liability, or tort (including negligence), arising in any way out of or in 
- connection with the use or distribution of the work.
-*****************************************************************************/
-
-
-// -------------------------------------------------------------------
-// Dependencies:
-//   repository.js
-//   section_view.js
-//   util.js
-// -------------------------------------------------------------------
-
-
-// -------------------------------------------------------------------
-// Register this layout type in the SectionView registry
-// -------------------------------------------------------------------
-SectionView.ourHashTableOfLayoutClassesKeyedByLayoutName[SectionView.LAYOUT_DETAIL] = DetailLayout;
-
-
-/**
- * A DetailLayout display one or more content items. 
- *
- * @scope    public instance constructor
- * @extends  View
- * @param    inSuperView    The superview for this view. 
- * @param    inDivElement    The HTMLDivElement to display this view in. 
- * @syntax   var detailLayout = new DetailLayout()
- */
-DetailLayout.prototype = new View();  // makes DetailLayout be a subclass of View
-function DetailLayout(inSuperView, inDivElement) {
-  this.setSuperview(inSuperView);
-  this.setDivElement(inDivElement);  
-}
-
-
-/**
- * Returns the registered name of this type of layout.
- *
- * @scope    public instance method
- * @return   A string.
- */
-DetailLayout.prototype.getLayoutName = function () {
-  return SectionView.LAYOUT_DETAIL;
-};
-
-  
-/**
- * Re-creates all the HTML for the DetailLayout, and hands the HTML to the 
- * browser to be re-drawn.
- *
- * @scope    public instance method
- */
-DetailLayout.prototype.refresh = function () {
-  var listOfStrings = [];
-
-  // for each content item, add its HTML representation to the output
-  // PENDING: how do we know our superview responds to getListOfContentItems()? 
-  var listOfContentItems = this.getSuperview().getListOfContentItems();
-  for (var contentItemKey in listOfContentItems) {
-    var contentItem = listOfContentItems[contentItemKey];
-    listOfStrings.push(this.getXhtmlTableForItem(contentItem));
-    listOfStrings.push(&quot;&lt;p&gt;&nbsp;&lt;/p&gt;&quot;);
-  }
-
-  // take all the HTML and put it together
-  var finalString = listOfStrings.join(&quot;&quot;);
-  this.getDivElement().innerHTML = finalString;
-};
-
-
-/**
- * Does final clean-up.
- *
- * @scope    public instance method
- */
-DetailLayout.prototype.endOfLife = function () {
-  this.getDivElement().innerHTML = &quot;&quot;;
-};
-
-
-/**
- * Given an item to be display, returns a string with XHTML to display
- * the item.
- *
- * @scope    public instance method
- * @param    inItem    An item to be displayed. 
- * @return   A string containing the XHTML to display the item.
- */
-DetailLayout.prototype.getXhtmlTableForItem = function (inItem) {
-  Util.assert(inItem instanceof Item);
-  
-  var listOfStrings = [];
-  var stevedore = this.getStevedore();
-  var attributeCalledName = stevedore.getItemFromUuid(Stevedore.UUID_FOR_ATTRIBUTE_NAME);
-  
-  listOfStrings.push(&quot;&lt;table class=\&quot;&quot; + SectionView.ELEMENT_CLASS_SIMPLE_TABLE + &quot;\&quot;&gt;&quot;);
-  listOfStrings.push(&quot;&lt;tr&gt;&quot;);
-  listOfStrings.push(&quot;&lt;td class=\&quot;&quot; + SectionView.ELEMENT_CLASS_LABEL + &quot; &quot; + SectionView.ELEMENT_CLASS_TITLE + &quot;\&quot;&gt;&quot; + attributeCalledName.getDisplayName() + &quot;&lt;/td&gt;&quot;);
-  listOfStrings.push(&quot;&lt;td class=\&quot;&quot; + SectionView.ELEMENT_CLASS_TITLE + &quot;\&quot;&gt;&quot; + inItem.getDisplayName() + &quot;&lt;/td&gt;&quot;);
-  listOfStrings.push(&quot;&lt;/tr&gt;&quot;);
-  var listOfAttributeUuids = inItem.getListOfAttributeUuids();
-  for (var key in listOfAttributeUuids) { 
-    var attributeUuid = listOfAttributeUuids[key];
-    if (attributeUuid != attributeCalledName.getUuid()) {
-      listOfStrings.push(&quot;&lt;tr&gt;&quot;);
-      var attribute = stevedore.getItemFromUuid(attributeUuid);
-      listOfStrings.push(&quot;&lt;td class=\&quot;&quot; + SectionView.ELEMENT_CLASS_LABEL + &quot;\&quot;&gt;&quot; + attribute.getDisplayName() + &quot;&lt;/td&gt;&quot;);
-      var valueList = inItem.getValueListFromAttribute(attributeUuid); 
-      listOfStrings.push(&quot;&lt;td class=\&quot;&quot; + SectionView.ELEMENT_CLASS_PLAIN + &quot;\&quot;&gt;&quot;);
-      for (var j = 0; j &lt; valueList.length; ++j) {
-        listOfStrings.push(SectionView.getStringForValue(valueList[j]) + &quot;&lt;br/&gt;&quot;);
-      }
-      listOfStrings.push(&quot;&lt;/td&gt;&quot;);
-      listOfStrings.push(&quot;&lt;/tr&gt;&quot;);
-    }
-  }
-  listOfStrings.push(&quot;&lt;/table&gt;&quot;);
-
-  // return all the new content
-  var finalString = listOfStrings.join(&quot;&quot;);
-  return finalString;
-};
-
-
-// -------------------------------------------------------------------
-// End of file
-// -------------------------------------------------------------------

Deleted: trunk/source/item.js
===================================================================
--- trunk/source/item.js	2005-04-05 05:02:08 UTC (rev 20)
+++ trunk/source/item.js	2005-04-05 21:00:35 UTC (rev 21)
@@ -1,369 +0,0 @@
-/*****************************************************************************
- item.js
- 
-******************************************************************************
- Written in 2005 by Brian Douglas Skinner &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openrecord-svn">brian.skinner at gumption.org</A>&gt;
-  
- Copyright rights relinquished under the Creative Commons  
- Public Domain Dedication:
-    <A HREF="http://creativecommons.org/licenses/publicdomain/">http://creativecommons.org/licenses/publicdomain/</A>
-  
- You can copy freely from this file.  This work may be freely reproduced, 
- distributed, transmitted, used, modified, built upon, or otherwise exploited
- by anyone for any purpose.
-  
- This work is provided on an &quot;AS IS&quot; basis, without warranties or conditions 
- of any kind, either express or implied, including, without limitation, any 
- warranties or conditions of title, non-infringement, merchantability, or 
- fitness for a particular purpose. You are solely responsible for determining 
- the appropriateness of using or distributing the work and assume all risks 
- associated with use of this work, including but not limited to the risks and 
- costs of errors, compliance with applicable laws, damage to or loss of data 
- or equipment, and unavailability or interruption of operations.
-
- In no event shall the authors or contributors have any liability for any 
- direct, indirect, incidental, special, exemplary, or consequential damages,
- however caused and on any theory of liability, whether in contract, strict 
- liability, or tort (including negligence), arising in any way out of or in 
- connection with the use or distribution of the work.
-*****************************************************************************/
-
- 
-// -------------------------------------------------------------------
-// Dependencies:
-//   util.js
-//   stevedore.js
-// -------------------------------------------------------------------
-
-
-/**
- * Instances of the Item class know how to store and retrieve their
- * attribute values.
- *
- * @scope    public instance constructor
- */
-function Item(inStevedore, inUuid) {
-  Util.assert(!inUuid || Util.isNumeric(inUuid));
-  
-  this._myStevedore = inStevedore;
-  this._myUuid = inUuid;
-  this._myListOfObservers = [];
-  this._myHashTableOfAssignmentsKeyedByAttributeUuid = {};
-}
-
-
-/**
- * Returns the display name of the item.
- *
- * @scope    public instance method
- * @return   A string with a display name for the item.
- */
-Item.prototype.toString = function () {
-  var returnString = &quot;[Item #&quot; + this.getUuid() + &quot; &quot;;
-  var listOfCategories = this.getValueListFromAttribute(Stevedore.UUID_FOR_ATTRIBUTE_CATEGORY);
-  for (var key in listOfCategories) {
-    var category = listOfCategories[key];
-    Util.assert(category instanceof Item);
-    returnString += &quot;(&quot; + category.getDisplayName() + &quot;)&quot;;
-  }
-  returnString += &quot; \&quot;&quot; + this.getDisplayName() + &quot;\&quot;&quot; + &quot;]&quot;;
-  return returnString; 
-};
-
-
-// -------------------------------------------------------------------
-// Attribute Accessor Methods
-// -------------------------------------------------------------------
-
-/**
- * Returns the display name of the item.
- *
- * @scope    public instance method
- * @return   A string with a display name for the item.
- */
-Item.prototype.getDisplayName = function (inDefaultString) {
-  return this._getStringUsingNameAttributes(Stevedore.UUID_FOR_ATTRIBUTE_NAME, null, inDefaultString);
-};
-  
-  
-/**
- * Returns a short display name for the item.
- *
- * @scope    public instance method
- * @return   A string with a short display name for the item.
- */
-Item.prototype.getShortName = function (inDefaultString) {
-  return this._getStringUsingNameAttributes(Stevedore.UUID_FOR_ATTRIBUTE_SHORT_NAME, Stevedore.UUID_FOR_ATTRIBUTE_NAME, inDefaultString);
-};
-
-
-/**
- * Given an attribute, this method returns the list of values that 
- * have been assigned to that attribute for this item.
- *
- * For example, to find out what color Kermit is: 
- * &lt;pre&gt;
- *    var valueList = kermit.getValueListFromAttribute(color);
- *    for (var i = 0; i &lt; valueList.length; ++i) {
- *      alert(&quot;Kermit is &quot; + valueList[i]);
- *    }
- * &lt;/pre&gt;
- *
- * @scope    public instance method
- * @param    inAttribute    The object to be removed from the set of observers. 
- */
-Item.prototype.getValueListFromAttribute = function (inAttribute) {
-  Util.assert(Util.isHashTable(this._myHashTableOfAssignmentsKeyedByAttributeUuid));
-  
-  var attributeUuid = this._myStevedore.getAttributeUuidFromAttributeOrUuid(inAttribute);
-  // PENDING: 
-  //   If this item isn't yet fully loaded into the cache, then we might need 
-  //   to ask our stevedore to get the attribute values for us.
-  var valueList = this._myHashTableOfAssignmentsKeyedByAttributeUuid[attributeUuid];
-  return (valueList || null);
-};
-
-
-/**
- * Assigns a value to an attribute in this item.
- *
- * Given an attribute and a value, assigns that value to the
- * attribute of the item. For example, to make a Kermit green:
- * &lt;pre&gt;
- *    kermit.assign(color, &quot;green&quot;);
- * &lt;/pre&gt;
- * Attributes can always have more than one assigned value, so
- * you can make Kermit be both blue and green by doing:
- * &lt;pre&gt;
- *    kermit.assign(color, &quot;green&quot;);
- *    kermit.assign(color, &quot;blue&quot;);
- * &lt;/pre&gt;
- *
- * @scope    public instance method
- * @param    inAttribute    The attribute to assign the value to, or the UUID of the attribute. 
- * @param    inValue    The value to be assigned. 
- */
-Item.prototype.assign = function (inAttribute, inValue) {
-  var cleanValue = inValue;
-  // alert(&quot;assign(&quot; + inAttribute + &quot;, &quot; + inValue + &quot;)&quot;);
-  if (Util.isString(inValue)) {
-    var cleanValue = Util.getCleanString(inValue);
-  }
-  var valueWasSet = this._initializeAttributeValue(inAttribute, cleanValue);
-  if (valueWasSet) {
-    this._myStevedore.markDirty(this);
-  }
-  // PENDING: 
-  //   We also need to create a change object, and we need to tell 
-  //   this._myStevedore about the change.
-  this._notifyObservers();
-};
-
-
-/**
- * Given an attribute, removes that attribute from the item's list
- * of attributes that have values assigned.
- *
- * @scope    public instance method
- * @param    inAttribute    The attribute to clear, or the UUID of the attribute. 
- * @return   Returns true if there was an existing attribute value to clear.
- */
-Item.prototype.clear = function (inAttribute) {
-  Util.assert(Util.isHashTable(this._myHashTableOfAssignmentsKeyedByAttributeUuid));
-
-  var valueWasDeleted = false;
-  var attributeUuid = this._myStevedore.getAttributeUuidFromAttributeOrUuid(inAttribute);
-  var currentValueList = this._myHashTableOfAssignmentsKeyedByAttributeUuid[attributeUuid];
-  if (currentValueList &amp;&amp; (currentValueList.length &gt; 0)) {
-    this._myHashTableOfAssignmentsKeyedByAttributeUuid[attributeUuid] = null;
-    valueWasDeleted = true;
-    this._myStevedore.markDirty(this);
-  }
-  
-  // PENDING: 
-  //   We also need to create a change object, and we need to tell 
-  //   this._myStevedore about the change.
-  this._notifyObservers();
-  
-  return valueWasDeleted;
-};
-
-
-// -------------------------------------------------------------------
-// Non-Attribute Accessor Methods
-// -------------------------------------------------------------------
-
-/**
- * Returns the UUID of the item.
- *
- * @scope    public instance method
- * @return   The UUID of the item.
- */
-Item.prototype.getUuid = function () {
-  return this._myUuid;
-};
-
-
-/**
- * Returns a list of the UUIDs for all the attributes that this item
- * has values assigned to.
- *
- * @scope    public instance method
- * @return   A list of UUIDs of attribute items.
- */
-Item.prototype.getListOfAttributeUuids = function () {
-  var listOfAttributeUuids = [];
-  for (var attributeUuid in this._myHashTableOfAssignmentsKeyedByAttributeUuid) {
-    listOfAttributeUuids.push(attributeUuid);
-  }
-  return listOfAttributeUuids;
-};
-
-
-/**
- * Given a category, returns &quot;true&quot; if the item has been assigned to 
- * that category.
- *
- * Also returns true if the item has been assigned to some category which is in
- * turn assigned to the given category, and so on, up the chain of category 
- * assignments.
- *
- * @scope    public instance method
- * @return   A boolean.  True if the item has been assigned to the category.
- */
-Item.prototype.isInCategory = function (inCategory) {
-  Util.assert(inCategory instanceof Item);
-
-  var valueList = this.getValueListFromAttribute(Stevedore.UUID_FOR_ATTRIBUTE_CATEGORY);
-  var key;
-  var value;
-  
-  // look at all the categories this item is assigned to, and see if one of them is &quot;inCategory&quot;
-  for (key in valueList) {
-    value = valueList[key];
-    if (value == inCategory) {
-      return true;
-    }
-  }
-  
-  // look at all the categories this item is assigned to, and see if one of them
-  // is in turn in the categoery &quot;inCategory&quot;
-  for (key in valueList) {
-    value = valueList[key];
-    // PENDING: 
-    //   This will go into an infinite loop if there is ever a cycle in the category 
-    //   assignments, like: A is in category B, and B is in C, and C is in A.
-    //   We need to use a non-recursive search of the graph.
-    // PENDING:
-    //   Do we also need to register as an observer of something, so that if we later
-    //   become a member of that category in question, then we can notify whoever
-    //   is observing us?
-    if ((value != this) &amp;&amp; (value.isInCategory(inCategory))) {
-      return true;
-    }
-  }
-  return false;
-};
- 
-
-// -------------------------------------------------------------------
-// Observer/Observable Methods
-// -------------------------------------------------------------------
-
-/**
- * Given an object, registers the object as an observer of this item, so that
- * the object will be notified when the item changes.
- *
- * @scope    public instance method
- * @param    inObserver    An object to be registered as an observer of the item. 
- */
-Item.prototype.addObserver = function (inObserver) {
-  Util.addObjectToSet(inObserver, this._myListOfObservers);
-};
-
-
-/**
- * Given an object, removes that object from the set of observers of this item, so 
- * that the object will no longer be notified when the item changes.
- *
- * @scope    public instance method
- * @param    inObserver    The object to be removed from the set of observers. 
- */
-Item.prototype.removeObserver = function (inObserver) {
-  Util.removeObjectFromSet(inObserver, this._myListOfObservers);
-};
-
-
-// -------------------------------------------------------------------
-// Private Methods
-// -------------------------------------------------------------------
-
-/**
- * Set the value of an attribute when the item is first being loaded
- * by the Stevedore.
- *
- * @scope    private instance method
- * @param    inAttribute    The attribute to assign the value to, or the UUID of the attribute. 
- * @param    inValue    The value to be assigned. 
- * @return   Returns true if the value was assigned.
- */
-Item.prototype._initializeAttributeValue = function (inAttribute, inValue) {
-  Util.assert(Util.isHashTable(this._myHashTableOfAssignmentsKeyedByAttributeUuid));
-
-  var attributeUuid = this._myStevedore.getAttributeUuidFromAttributeOrUuid(inAttribute);
-  if (!this._myHashTableOfAssignmentsKeyedByAttributeUuid[attributeUuid]) {
-    this._myHashTableOfAssignmentsKeyedByAttributeUuid[attributeUuid] = [];
-  }
-  // var 
-  var valueList = this._myHashTableOfAssignmentsKeyedByAttributeUuid[attributeUuid];
-  var valueWasAddedFlag = Util.addObjectToSet(inValue, valueList);
-  return valueWasAddedFlag;
-};
-
-
-/**
- * Returns some display name for the item, drawing on both the &quot;name&quot; and
- * &quot;short name&quot; attributes.
- *
- * @scope    private instance method
- * @return   A string with a display name for the item.
- */
-Item.prototype._getStringUsingNameAttributes = function (inPrimaryAttributeUuid, inSecondaryAttributeUuid, inDefaultString) {
-  var returnString = null;
-  var nameList = this.getValueListFromAttribute(inPrimaryAttributeUuid);
-  if (nameList) {
-    returnString = nameList[0];
-  }
-  if (!returnString &amp;&amp; inSecondaryAttributeUuid) {
-    nameList = this.getValueListFromAttribute(inSecondaryAttributeUuid);
-    if (nameList) {
-      returnString = nameList[0];
-    }
-  }
-  if (!returnString) {
-    returnString = inDefaultString;
-  }
-  if (!returnString) {
-    returnString = &quot;&quot;;
-  }
-  return returnString;
-};
-  
-
-/**
- * Sends messages to all the registered observers to let them know that
- * this item has changed.
- *
- * @scope    private instance method
- */
-Item.prototype._notifyObservers = function () {
-  for (var key in this._myListOfObservers) {
-    var observer = this._myListOfObservers[key];
-    observer.observedItemHasChanged(this);
-  }
-};
-
-
-// -------------------------------------------------------------------
-// End of file
-// -------------------------------------------------------------------

Deleted: trunk/source/item_view.js
===================================================================
--- trunk/source/item_view.js	2005-04-05 05:02:08 UTC (rev 20)
+++ trunk/source/item_view.js	2005-04-05 21:00:35 UTC (rev 21)
@@ -1,129 +0,0 @@
-/*****************************************************************************
- item_view.js
- 
-******************************************************************************
- Written in 2005 by Brian Douglas Skinner &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openrecord-svn">brian.skinner at gumption.org</A>&gt;
-  
- Copyright rights relinquished under the Creative Commons  
- Public Domain Dedication:
-    <A HREF="http://creativecommons.org/licenses/publicdomain/">http://creativecommons.org/licenses/publicdomain/</A>
-  
- You can copy freely from this file.  This work may be freely reproduced, 
- distributed, transmitted, used, modified, built upon, or otherwise exploited
- by anyone for any purpose.
-  
- This work is provided on an &quot;AS IS&quot; basis, without warranties or conditions 
- of any kind, either express or implied, including, without limitation, any 
- warranties or conditions of title, non-infringement, merchantability, or 
- fitness for a particular purpose. You are solely responsible for determining 
- the appropriateness of using or distributing the work and assume all risks 
- associated with use of this work, including but not limited to the risks and 
- costs of errors, compliance with applicable laws, damage to or loss of data 
- or equipment, and unavailability or interruption of operations.
-
- In no event shall the authors or contributors have any liability for any 
- direct, indirect, incidental, special, exemplary, or consequential damages,
- however caused and on any theory of liability, whether in contract, strict 
- liability, or tort (including negligence), arising in any way out of or in 
- connection with the use or distribution of the work.
-*****************************************************************************/
-
-
-// -------------------------------------------------------------------
-// Dependencies:
-//   repository.js
-//   util.js
-//   root_view.js
-//   detail_layout.js
-// -------------------------------------------------------------------
-
-
-// -------------------------------------------------------------------
-// ItemView public class constants
-// -------------------------------------------------------------------
-ItemView.ELEMENT_ID_DETAIL_DIV_PREFIX = &quot;detail_layout_div_for_item_&quot;;
-
-
-/**
- * The RootView uses an instance of a ItemView to display an Item in the
- * browser window.
- *
- * @scope    public instance constructor
- * @extends  View
- * @param    inRootView    The RootView that this ItemView is nested in. 
- * @param    inDivElement    The HTMLDivElement to display the HTML in. 
- * @param    inItem    The item to be displayed by this view. 
- */
-ItemView.prototype = new View();  // makes ItemView be a subclass of View
-function ItemView(inRootView, inDivElement, inItem) {
-  Util.assert(inItem instanceof Item);
-  Util.assert(inDivElement instanceof HTMLDivElement);
-  Util.assert(inRootView instanceof RootView);
-
-  // instance properties
-  this.setSuperview(inRootView);
-  this.setDivElement(inDivElement);
-  this.myItem = inItem;
-  // this.myDivElement = inDivElement;
-  // this.myRootView = inRootView;
-  this.myLayout = null;
-}
-
-
-/**
- * Returns a list with a single content item in it.
- *
- * @scope    public instance method
- * @return   A list with one item in it.
- */
-ItemView.prototype.getListOfContentItems = function () {
-  var listOfContentItems = [];
-  listOfContentItems.push(this.myItem);
-  return listOfContentItems;
-};
-
-
-/**
- * Returns a string that gives the name of the page.
- *
- * @scope    public instance method
- * @return   A string that gives the name of the page.
- */
-ItemView.prototype.getPageTitle = function () {
-  return this.myItem.getShortName();
-};
-
-
-/**
- * Re-creates all the HTML for the ItemView, and hands the HTML to the 
- * browser to be re-drawn.
- *
- * @scope    public instance method
- */
-ItemView.prototype.refresh = function () {
-  Util.assert(this.myItem instanceof Item);
-  // Util.assert(this.myDivElement instanceof HTMLDivElement);
-  // RootView.displayTextInDebugTextarea(&quot;ItemView.prototype.refresh&quot;); 
-  var listOfStrings = [];
-
-  // add an &lt;h1&gt; heading with the name of the page
-  listOfStrings.push(&quot;&lt;h1 id=\&quot;&quot; + RootView.URL_ITEM_PREFIX + this.myItem.getUuid() + &quot;\&quot;&gt;&quot; + this.myItem.getDisplayName() + &quot;&lt;/h1&gt;&quot;);
-
-  // add a &lt;div&gt; element for the detail layout
-  var detailDivId = ItemView.ELEMENT_ID_DETAIL_DIV_PREFIX + this.myItem.getUuid();
-  listOfStrings.push(&quot;&lt;div id=\&quot;&quot; + detailDivId + &quot;\&quot;&gt;&lt;/div&gt;&quot;);
-
-  // write out all the new content 
-  var finalString = listOfStrings.join(&quot;&quot;);
-  this.getDivElement().innerHTML = finalString;
-
-  // let the detailLayout add its own content
-  var detailLayoutDivElement = document.getElementById(detailDivId);
-  this.myLayout = new DetailLayout(this, detailLayoutDivElement);
-  this.myLayout.refresh();
-};
-
-
-// -------------------------------------------------------------------
-// End of file
-// -------------------------------------------------------------------

Deleted: trunk/source/outline_layout.js
===================================================================
--- trunk/source/outline_layout.js	2005-04-05 05:02:08 UTC (rev 20)
+++ trunk/source/outline_layout.js	2005-04-05 21:00:35 UTC (rev 21)
@@ -1,107 +0,0 @@
-/*****************************************************************************
- outline_layout.js
- 
-******************************************************************************
- Written in 2005 by Brian Douglas Skinner &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openrecord-svn">brian.skinner at gumption.org</A>&gt;
-  
- Copyright rights relinquished under the Creative Commons  
- Public Domain Dedication:
-    <A HREF="http://creativecommons.org/licenses/publicdomain/">http://creativecommons.org/licenses/publicdomain/</A>
-  
- You can copy freely from this file.  This work may be freely reproduced, 
- distributed, transmitted, used, modified, built upon, or otherwise exploited
- by anyone for any purpose.
-  
- This work is provided on an &quot;AS IS&quot; basis, without warranties or conditions 
- of any kind, either express or implied, including, without limitation, any 
- warranties or conditions of title, non-infringement, merchantability, or 
- fitness for a particular purpose. You are solely responsible for determining 
- the appropriateness of using or distributing the work and assume all risks 
- associated with use of this work, including but not limited to the risks and 
- costs of errors, compliance with applicable laws, damage to or loss of data 
- or equipment, and unavailability or interruption of operations.
-
- In no event shall the authors or contributors have any liability for any 
- direct, indirect, incidental, special, exemplary, or consequential damages,
- however caused and on any theory of liability, whether in contract, strict 
- liability, or tort (including negligence), arising in any way out of or in 
- connection with the use or distribution of the work.
-*****************************************************************************/
-
-
-// -------------------------------------------------------------------
-// Dependencies:
-//   repository.js
-//   section_view.js
-// -------------------------------------------------------------------
-
-
-// -------------------------------------------------------------------
-// Register this layout type in the SectionView registry
-// -------------------------------------------------------------------
-SectionView.ourHashTableOfLayoutClassesKeyedByLayoutName[SectionView.LAYOUT_OUTLINE] = OutlineLayout;
-
-
-/**
- * An OutlineLayout displays a set of content items for a SectionView. 
- *
- * @scope    public instance constructor
- * @extends  View
- * @param    inSectionView    The SectionView that serves as the superview for this view. 
- * @param    inDivElement    The HTMLDivElement to display this view in. 
- * @syntax   var outline = new OutlineLayout()
- */
-OutlineLayout.prototype = new View();  // makes OutlineLayout be a subclass of View
-function OutlineLayout(inSectionView, inDivElement) {
-  this.setSuperview(inSectionView);
-  this.setDivElement(inDivElement);
-}
-
-
-/**
- * Returns the registered name of this type of layout.
- *
- * @scope    public instance method
- * @return   A string.
- */
-OutlineLayout.prototype.getLayoutName = function () {
-  return SectionView.LAYOUT_OUTLINE;
-};
-
-  
-/**
- * Re-creates all the HTML for the OutlineLayout, and hands the HTML to the 
- * browser to be re-drawn.
- *
- * @scope    public instance method
- */
-OutlineLayout.prototype.refresh = function () {
-  var listOfContentItems = this.getSuperview().getListOfContentItems();
-  var outlineDiv = this.getDivElement();
-  var ulElement = View.createAndAppendElement(outlineDiv, &quot;ul&quot;);
-  for (var contentItemKey in listOfContentItems) {
-    var contentItem = listOfContentItems[contentItemKey];
-    var liElement = View.createAndAppendElement(ulElement, &quot;li&quot;);
-    View.createAndAppendTextNode(liElement, contentItem.getDisplayName(&quot;{no name}&quot;) + &quot; &quot;);
-    var anchorElement = View.createAndAppendElement(liElement, &quot;a&quot;, SectionView.ELEMENT_CLASS_MORE_LINK);
-    anchorElement.setAttribute(&quot;href&quot;, RootView.URL_HASH_ITEM_PREFIX + contentItem.getUuid());
-    // View.createAndAppendTextNode(anchorElement, &quot;(more &#8658;)&quot;);
-    anchorElement.innerHTML = &quot;(more &#8658;)&quot;;
-    Util.addEventListener(anchorElement, &quot;click&quot;, RootView.clickOnLocalLink);
-  }
-};
-
-
-/**
- * Does final clean-up.
- *
- * @scope    public instance method
- */
-OutlineLayout.prototype.endOfLife = function () {
-  this.getDivElement().innerHTML = &quot;&quot;;
-};
-
-
-// -------------------------------------------------------------------
-// End of file
-// -------------------------------------------------------------------

Deleted: trunk/source/page_view.js
===================================================================
--- trunk/source/page_view.js	2005-04-05 05:02:08 UTC (rev 20)
+++ trunk/source/page_view.js	2005-04-05 21:00:35 UTC (rev 21)
@@ -1,145 +0,0 @@
-/*****************************************************************************
- page_view.js
- 
-******************************************************************************
- Written in 2005 by Brian Douglas Skinner &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openrecord-svn">brian.skinner at gumption.org</A>&gt;
-  
- Copyright rights relinquished under the Creative Commons  
- Public Domain Dedication:
-    <A HREF="http://creativecommons.org/licenses/publicdomain/">http://creativecommons.org/licenses/publicdomain/</A>
-  
- You can copy freely from this file.  This work may be freely reproduced, 
- distributed, transmitted, used, modified, built upon, or otherwise exploited
- by anyone for any purpose.
-  
- This work is provided on an &quot;AS IS&quot; basis, without warranties or conditions 
- of any kind, either express or implied, including, without limitation, any 
- warranties or conditions of title, non-infringement, merchantability, or 
- fitness for a particular purpose. You are solely responsible for determining 
- the appropriateness of using or distributing the work and assume all risks 
- associated with use of this work, including but not limited to the risks and 
- costs of errors, compliance with applicable laws, damage to or loss of data 
- or equipment, and unavailability or interruption of operations.
-
- In no event shall the authors or contributors have any liability for any 
- direct, indirect, incidental, special, exemplary, or consequential damages,
- however caused and on any theory of liability, whether in contract, strict 
- liability, or tort (including negligence), arising in any way out of or in 
- connection with the use or distribution of the work.
-*****************************************************************************/
-
-
-// -------------------------------------------------------------------
-// Dependencies:
-//   repository.js
-//   util.js
-//   section_view.js
-// -------------------------------------------------------------------
-
-
-// -------------------------------------------------------------------
-// PageView public class constants
-// -------------------------------------------------------------------
-PageView.ELEMENT_ID_SECTION_DIV_PREFIX = &quot;section_view_&quot;;
-PageView.ELEMENT_ID_SECTION_DIV_MIDFIX = &quot;_in_page_&quot;;
-PageView.ELEMENT_ID_SUMMARY_VIEW_DIV_PREFIX = &quot;_summary_view_for_page_&quot;;
-
-PageView.ELEMENT_CLASS_EDIT_MODE = &quot;editmode&quot;;
-PageView.ELEMENT_CLASS_VIEW_MODE = &quot;viewmode&quot;;
-
-
-/**
- * The RootView uses an instance of a PageView to display a Page in the
- * browser window.
- *
- * @scope    public instance constructor
- * @extends  View
- * @param    inRootView    The RootView that this PageView is nested in. 
- * @param    inDivElement    The HTMLDivElement to display the HTML in. 
- * @param    inPage    The page item to be displayed by this view. 
- */
-PageView.prototype = new View();  // makes PageView be a subclass of View
-function PageView(inRootView, inDivElement, inPage) {
-  Util.assert(inRootView instanceof RootView);
-  Util.assert(inDivElement instanceof HTMLDivElement);
-  Util.assert(inPage instanceof Item);
-
-  // instance properties
-  this.setSuperview(inRootView);
-  this.setDivElement(inDivElement);
-  this.myPage = inPage;
-  this._myHasEverBeenDisplayedFlag = false;
-  
-  this._myPageSummaryView = null;
-  this.myListOfSectionViews = [];
-}
-
-
-/**
- * Returns a string that gives the name of the page.
- *
- * @scope    public instance method
- * @return   A string that gives the name of the page.
- */
-PageView.prototype.getPageTitle = function () {
-  return this.myPage.getShortName();
-};
-
-  
-/**
- * Updates the HTML elements in this view to reflect any changes in 
- * the data, and tells the sub-views to refresh themselves too.
- *
- * @scope    public instance method
- */
-PageView.prototype.refresh = function () {
-  if (!this._myHasEverBeenDisplayedFlag) {
-    this.doInitialDisplay();
-  } else {
-    this.getDivElement().className = (this.isInEditMode()) ? PageView.ELEMENT_CLASS_EDIT_MODE : PageView.ELEMENT_CLASS_VIEW_MODE;
-    this._myPageSummaryView.refresh();
-    for (var key in this.myListOfSectionViews) {
-      var sectionView = this.myListOfSectionViews[key];      
-      sectionView.refresh();
-    }
-  }
-};
-
-
-/**
- * Re-creates all the HTML for the PageView, and hands the HTML to the 
- * browser to be re-drawn.
- *
- * @scope    public instance method
- */
-PageView.prototype.doInitialDisplay = function () {
-  Util.assert(this.getDivElement() instanceof HTMLDivElement);
-  
-  var pageDivElement = this.getDivElement();
-  pageDivElement.className = (this.isInEditMode()) ? PageView.ELEMENT_CLASS_EDIT_MODE : PageView.ELEMENT_CLASS_VIEW_MODE;
-  
-  var headerElement = View.createAndAppendElement(pageDivElement, &quot;h1&quot;);
-  headerElement.innerHTML = this.myPage.getDisplayName();
-
-  var summaryViewDiv = View.createAndAppendElement(pageDivElement, &quot;div&quot;);
-  this._myPageSummaryView = new MultiLineTextView(this, summaryViewDiv, this.myPage, Stevedore.UUID_FOR_ATTRIBUTE_SUMMARY, SectionView.ELEMENT_CLASS_TEXT_VIEW);
-
-  // add &lt;div&gt; elements for each of the sections on the page
-  // and create a new SectionView for each section
-  var listOfSections = this.myPage.getValueListFromAttribute(Stevedore.UUID_FOR_ATTRIBUTE_SECTION);
-  var sectionNumber = 0;
-  for (var key in listOfSections) {
-    var section = listOfSections[key];
-    var sectionViewDiv = View.createAndAppendElement(pageDivElement, &quot;div&quot;);
-    var sectionView = new SectionView(this, sectionViewDiv, section, sectionNumber);
-    sectionNumber += 1;
-    this.myListOfSectionViews.push(sectionView);
-  }
-  this._myHasEverBeenDisplayedFlag = true;
-  this.refresh();
-};
-
-
-// -------------------------------------------------------------------
-// End of file
-// -------------------------------------------------------------------

Deleted: trunk/source/rectangle.js
===================================================================
--- trunk/source/rectangle.js	2005-04-05 05:02:08 UTC (rev 20)
+++ trunk/source/rectangle.js	2005-04-05 21:00:35 UTC (rev 21)
@@ -1,173 +0,0 @@
-// -------------------------------------------------------------------
-// Brian's 2005 JavaScript Coding Conventions
-//
-// + jslint approved
-//    + jslint returns &quot;ok&quot; when it looks at the code (with strictest settings)
-//    + do not use &quot;with&quot;
-//    + do not use &quot;new Function&quot;
-//    + do not use ++ and --
-// 
-// + naming conventions
-//    + capitalization
-//       + classes are initial caps (CamelCaps): &quot;Rectangle&quot;, &quot;FillPattern&quot;
-//       + all variable names and methods names are mixedCaps: &quot;fillPattern&quot;
-//       + acronyms appear in initial caps: &quot;myHtmlString&quot;, not &quot;myHTMLString&quot;
-//       + file names are the all lower case version of the class name, with underscores: &quot;rectangle&quot;, &quot;fill_pattern&quot;
-//       + directories should be all lower case, with underscores: &quot;basic_shapes&quot;
-//       + constants are all caps, with underscores: FILL_PATTERN_SOLID
-//    + variable scoping prefixes
-//       + class variables are prefixed with &quot;our&quot;
-//       + instance variables are prefixed with &quot;my&quot;
-//       + global variables are prefixed with &quot;window.global&quot;
-//       + locally scoped variables are not prefixed
-//       + function input parameters are prefixed with &quot;in&quot;
-//       + private variables are prefixed with &quot;_&quot;
-//    + class constants are prefixed with the type of the constant -- see LAYOUT_PORTRAIT
-//    + array variables are prefixed with &quot;ListOf&quot; or &quot;HashTableOf&quot; or &quot;ArrayOf&quot;
-//       + var myListOfBooks = []; &lt;-- a &quot;List&quot; has only values, no keys [&quot;Apple&quot;, &quot;Orange&quot;, &quot;Banana&quot;]
-//       + var myHashTableOfBooksKeyedByTitle = {}; &lt;-- a &quot;HashTable&quot; is an associative array with key-value pairs
-//       + var myArrayOfBooks = new Array(); &lt;-- an &quot;Array&quot; has values that are indexed by number array[23] = &quot;Apple&quot;
-//    + accessor methods are prefixed with &quot;get&quot; or &quot;is&quot; -- e.g. oval.getArea(), oval.isCircle()
-//       + any method that returns a value and does not change an object's state should be a &quot;get&quot; or &quot;is&quot; method
-//       + any method that does change an object's state should be a &quot;set&quot; method
-//    + problems are marked with PENDING
-//
-// + compatiblity with other browsers and other JavaScript libraries 
-//    + use &quot;get&quot; and &quot;set&quot; accessors -- do *not* assign Mozilla &quot;getter&quot; and &quot;setter&quot; methods
-//    + add methods in your own namespace -- do *not* extend built-in objects: String.prototype.toEsperanto = function ...
-//
-// + indenting, tabs, and line ending characters
-//    + 2-space indenting
-//    + only spaces, no tabs
-//    + Unix style line endings: just \n -- not \r or \r\n
-//
-// + file header and footer conventions
-//    + file name is given
-//    + copyright and license statements are included
-//    + file dependencies are listed
-//    + sections for: class constants, class properties, constructor, instance methods
-//    + &quot;End of file&quot; ending
-//
-// + scoping
-//    + locally scoped variables are declared before being used: &quot;var foo&quot;, not &quot;foo
-//    + global variables are not used, except for class names
-//    + instance methods are defined on the prototype -- see getArea()
-//    + accessor methods never have side-effects
-//
-// + PENDING
-//    + private instance properties?
-//    + private instance methods?
-//    + class methods?
-// -------------------------------------------------------------------
-
-
-
-
-/*****************************************************************************
- rectangle.js
- 
-******************************************************************************
- Written in 2005 by Brian Douglas Skinner &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openrecord-svn">brian.skinner at gumption.org</A>&gt;
-  
- Copyright rights relinquished under the Creative Commons  
- Public Domain Dedication:
-    <A HREF="http://creativecommons.org/licenses/publicdomain/">http://creativecommons.org/licenses/publicdomain/</A>
-  
- You can copy freely from this file.  This work may be freely reproduced, 
- distributed, transmitted, used, modified, built upon, or otherwise exploited
- by anyone for any purpose.
-  
- This work is provided on an &quot;AS IS&quot; basis, without warranties or conditions 
- of any kind, either express or implied, including, without limitation, any 
- warranties or conditions of title, non-infringement, merchantability, or 
- fitness for a particular purpose. You are solely responsible for determining 
- the appropriateness of using or distributing the work and assume all risks 
- associated with use of this work, including but not limited to the risks and 
- costs of errors, compliance with applicable laws, damage to or loss of data 
- or equipment, and unavailability or interruption of operations.
-
- In no event shall the authors or contributors have any liability for any 
- direct, indirect, incidental, special, exemplary, or consequential damages,
- however caused and on any theory of liability, whether in contract, strict 
- liability, or tort (including negligence), arising in any way out of or in 
- connection with the use or distribution of the work.
-*****************************************************************************/
-
-
-// -------------------------------------------------------------------
-// Dependencies:
-//   line.js
-// -------------------------------------------------------------------
-
-
-// -------------------------------------------------------------------
-// Rectangle public class constants
-// -------------------------------------------------------------------
-Rectangle.LAYOUT_PORTRAIT = &quot;Portrait&quot;;
-Rectangle.LAYOUT_LANDSCAPE = &quot;Landscape&quot;;
-
-Rectangle.FILL_SOLID = &quot;Solid&quot;;
-Rectangle.FILL_EMPTY = &quot;Empty&quot;;
-
-
-// -------------------------------------------------------------------
-// Rectangle class properties
-// -------------------------------------------------------------------
-Rectangle.ourHashTableOfColorsKeyedBySize = new Array();
-
-
-/**
- * Each Rectangle instances represents a single rectangle.
- *
- * @scope    public instance constructor
- * @syntax   var rect = new Rectangle()
- */
-function Rectangle() {
-  // instance properties
-  this.myWidth = null;
-  this.myHeight = null;
-}
-
-
-// -------------------------------------------------------------------
-// Public class methods
-// -------------------------------------------------------------------
-
-/**
- * Given two Rectangle object, returns new Rectangle large enough
- * to encompass both of the given Rectangles.
- *
- * @scope    public class method
- * @param    inRectOne    A Rectangle object. 
- * @param    inRectTwo    A Rectangle object. 
- * @return   A newly created Rectangle object.
- */
-Rectangle.union = function (inRectOne, inRectTwo) {
-  Util.assert(inRectOne instanceof Rectangle);
-  Util.assert(inRectTwo instanceof Rectangle);
-
-  var newRectangle = new Rectangle();
-  newRectangle.myWidth = Math.max(inRectOne.myWidth, inRectTwo.myWidth);
-  newRectangle.myHeight = Math.max(inRectOne.myHeight, inRectTwo.myHeight);
-  return newRectangle;
-};
-
-
-// -------------------------------------------------------------------
-// Public instance methods
-// -------------------------------------------------------------------
-
-/**
- * Returns the area of the rectangle.
- *
- * @scope    public instance method
- * @return   A number.
- */
-Rectangle.prototype.getArea = function () {
-  var area = this.myWidth * this.myHeight;
-  return area;
-};
-
-// -------------------------------------------------------------------
-// End of file
-// -------------------------------------------------------------------

Deleted: trunk/source/root_view.js
===================================================================
--- trunk/source/root_view.js	2005-04-05 05:02:08 UTC (rev 20)
+++ trunk/source/root_view.js	2005-04-05 21:00:35 UTC (rev 21)
@@ -1,454 +0,0 @@
-/*****************************************************************************
- root_view.js
- 
-******************************************************************************
- Written in 2005 by Brian Douglas Skinner &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openrecord-svn">brian.skinner at gumption.org</A>&gt;
-  
- Copyright rights relinquished under the Creative Commons  
- Public Domain Dedication:
-    <A HREF="http://creativecommons.org/licenses/publicdomain/">http://creativecommons.org/licenses/publicdomain/</A>
-  
- You can copy freely from this file.  This work may be freely reproduced, 
- distributed, transmitted, used, modified, built upon, or otherwise exploited
- by anyone for any purpose.
-  
- This work is provided on an &quot;AS IS&quot; basis, without warranties or conditions 
- of any kind, either express or implied, including, without limitation, any 
- warranties or conditions of title, non-infringement, merchantability, or 
- fitness for a particular purpose. You are solely responsible for determining 
- the appropriateness of using or distributing the work and assume all risks 
- associated with use of this work, including but not limited to the risks and 
- costs of errors, compliance with applicable laws, damage to or loss of data 
- or equipment, and unavailability or interruption of operations.
-
- In no event shall the authors or contributors have any liability for any 
- direct, indirect, incidental, special, exemplary, or consequential damages,
- however caused and on any theory of liability, whether in contract, strict 
- liability, or tort (including negligence), arising in any way out of or in 
- connection with the use or distribution of the work.
-*****************************************************************************/
-
-
-// -------------------------------------------------------------------
-// Dependencies:
-//   page_view.js
-//   repository.js
-//   util.js
-// -------------------------------------------------------------------
-
-
-// -------------------------------------------------------------------
-// RootView public class constants
-// -------------------------------------------------------------------
-RootView.ELEMENT_CLASS_PAGE_EDIT_BUTTON = &quot;page_edit_button&quot;;
-
-RootView.ELEMENT_ID_EDIT_BUTTON = &quot;edit_button&quot;;
-RootView.ELEMENT_ID_DEBUG_TEXTAREA = &quot;debug_textarea&quot;;
-
-RootView.URL_PAGE_PREFIX = &quot;page&quot;;
-RootView.URL_ITEM_PREFIX = &quot;item&quot;;
-RootView.URL_HASH_PAGE_PREFIX = &quot;#&quot; + RootView.URL_PAGE_PREFIX;
-RootView.URL_HASH_ITEM_PREFIX = &quot;#&quot; + RootView.URL_ITEM_PREFIX;
-
-
-// -------------------------------------------------------------------
-// RootView class properties
-// -------------------------------------------------------------------
-RootView.ourSingleInstance = null;
-
-
-/**
- * The OpenRecord app uses a single instance of RootView, which serves as the
- * outer-most view in the browser, and contains the current PageView as well
- * as some standard chrome (like the Edit button).
- *
- * @scope    public instance constructor
- * @syntax   var rootView = new RootView()
- */
-function RootView(inStevedore) {
-  RootView.ourSingleInstance = this;
-   
-  Util.assert(inStevedore instanceof Stevedore);
-
-  // instance properties
-  this._myStevedore = inStevedore;
-  this.myEditButtonId = RootView.ELEMENT_ID_EDIT_BUTTON;
-  this.myEditMode = false;
-  this.myNumberOfCallsToDebug = 0;
-  this.myDebugTextarea = null;
-  
-  this._myHashTableOfItemViewsKeyedByUuid = {};
-  this._myHashTableOfPageViewsKeyedByUuid = {};
-  this._myCurrentContentView = null;
-  
-  this.myHashTableOfPagesKeyedByUuid = {};
-  var categoryPage = this._myStevedore.getItemFromUuid(Stevedore.UUID_FOR_CATEGORY_PAGE);
-  var listOfPages = this._myStevedore.getListOfItemsInCategory(categoryPage);
-  for (var key in listOfPages) {
-    var page = listOfPages[key];
-    this.myHashTableOfPagesKeyedByUuid[page.getUuid()] = page; 
-  }
-
-  window.document.body.innerHTML = &quot;&quot;;
-  var rootDiv = View.createAndAppendElement(window.document.body, &quot;div&quot;);
- 
-  for (var uuid in this.myHashTableOfPagesKeyedByUuid) {
-    var aPage = this.myHashTableOfPagesKeyedByUuid[uuid];
-    var anchor = View.createAndAppendElement(rootDiv, &quot;a&quot;);
-    anchor.setAttribute(&quot;name&quot;, RootView.URL_PAGE_PREFIX + aPage.getUuid());
-  }
-  
-  var headerP = View.createAndAppendElement(rootDiv, &quot;p&quot;, &quot;header&quot;);
-  var logoSpan = View.createAndAppendElement(headerP, &quot;span&quot;, &quot;logo&quot;);
-  logoSpan.innerHTML = '&lt;a href=&quot;<A HREF="http://openrecord.org">http://openrecord.org</A>&quot;&gt;&lt;span class=&quot;logostart&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;logomiddle&quot;&gt;record&lt;/span&gt;&lt;span class=&quot;logoend&quot;&gt;.org&lt;/span&gt;&lt;/a&gt;';
-  var mainControlSpan = View.createAndAppendElement(headerP, &quot;span&quot;, null, &quot;main_control_span&quot;);
-  View.createAndAppendElement(headerP, &quot;br&quot;);
-  var navbarDiv = View.createAndAppendElement(rootDiv, &quot;div&quot;, &quot;navbar&quot;);
-  var contentAreaDiv = View.createAndAppendElement(rootDiv, &quot;div&quot;, &quot;content_area&quot;);
-  var contentViewDiv = View.createAndAppendElement(contentAreaDiv, &quot;div&quot;);
-  var debugDiv = View.createAndAppendElement(rootDiv, &quot;div&quot;, &quot;debug&quot;);
-
-  var footerP = View.createAndAppendElement(rootDiv, &quot;p&quot;, &quot;footer&quot;);
-  var copyrightSpan = View.createAndAppendElement(footerP, &quot;span&quot;, &quot;copyright&quot;);
-  copyrightSpan.innerHTML = 'You can copy freely from this site &mdash; ' +
-    'copyright rights relinquished under the Creative Commons ' +
-    '&lt;a rel=&quot;license external&quot; href=&quot;<A HREF="http://creativecommons.org/licenses/publicdomain/">http://creativecommons.org/licenses/publicdomain/</A>&quot;&gt;Public Domain Dedication&lt;/a&gt;.';
-
-  var statusBlurbSpan = View.createAndAppendElement(footerP, &quot;span&quot;, &quot;fileformat&quot;);
-  View.createAndAppendElement(footerP, &quot;br&quot;);
-  
-  this.myMainControlSpanElement = mainControlSpan;
-  this.myNavbarDivElement = navbarDiv;
-  this._myContentViewDivElement = contentViewDiv;
-  this.myDebugDivElement = debugDiv;
-  this.myStatusBlurbSpanElement = statusBlurbSpan;
-  
-  Util.setErrorReportCallback(RootView.displayTextInDebugTextarea);
-  this.setCurrentContentViewFromUrl();
-}
-
-
-// -------------------------------------------------------------------
-// Public instance methods
-// -------------------------------------------------------------------
-
-/**
- * Returns the Stevedore instance that this RootView is using.
- *
- * @scope    public instance method
- * @return   A Stevedore object. 
- */
-RootView.prototype.getStevedore = function () {
-  return this._myStevedore;
-};
-
-
-/**
- * Returns true if we are in Edit Mode.
- *
- * @scope    public instance method
- * @return   A boolean value. True if we are in Edit Mode.
- */
-RootView.prototype.isInEditMode = function () {
-  return this.myEditMode;
-};
-
-  
-/**
- * Gets the browser URL from window.location, finds or creates a corresponding
- * PageView or ItemView, and sets the current content view to the newly selected
- * PageView or ItemView.
- *
- * @scope    public instance method
- */
-RootView.prototype.setCurrentContentViewFromUrl = function () {
-  var contentViewToSwitchTo = null;
-  
-  if (window.location) {
-    if (window.location.hash) {
-      var originalHash = window.location.hash;
-      var uuidText = null;
-      var uuidNumber = null;
-      var pageFromUuid = null;
-      var itemFromUuid = null;
-      var divElement = null;
-      var isUrlForPage = (originalHash.indexOf(RootView.URL_HASH_PAGE_PREFIX) != -1);
-      var isUrlForItem = (originalHash.indexOf(RootView.URL_HASH_ITEM_PREFIX) != -1);
-      if (isUrlForItem) {
-        uuidText = originalHash.replace(RootView.URL_HASH_ITEM_PREFIX, &quot;&quot;);
-        uuidNumber = parseInt(uuidText);
-        contentViewToSwitchTo = this._myHashTableOfItemViewsKeyedByUuid[uuidNumber];
-        if (!contentViewToSwitchTo) {
-          itemFromUuid = this._myStevedore.getItemFromUuid(uuidNumber);
-          if (itemFromUuid) {
-            divElement = window.document.createElement(&quot;div&quot;); 
-            this._myContentViewDivElement.appendChild(divElement);
-            contentViewToSwitchTo = new ItemView(this, divElement, itemFromUuid);
-            this._myHashTableOfItemViewsKeyedByUuid[uuidNumber] = contentViewToSwitchTo;
-          }
-        }
-      } else {
-        if (isUrlForPage) {
-          uuidText = originalHash.replace(RootView.URL_HASH_PAGE_PREFIX, &quot;&quot;);
-          uuidNumber = parseInt(uuidText);
-          contentViewToSwitchTo = this._myHashTableOfPageViewsKeyedByUuid[uuidNumber];
-          if (!contentViewToSwitchTo) {
-            pageFromUuid = this.myHashTableOfPagesKeyedByUuid[uuidNumber];
-            if (pageFromUuid) {
-              divElement = window.document.createElement(&quot;div&quot;); 
-              this._myContentViewDivElement.appendChild(divElement);
-              contentViewToSwitchTo = new PageView(this, divElement, pageFromUuid);
-              this._myHashTableOfPageViewsKeyedByUuid[uuidNumber] = contentViewToSwitchTo;
-            }
-          }
-        } 
-      }
-    } 
-  }
-  
-  if (!contentViewToSwitchTo) {
-    var page = this._myStevedore.getHomePage();
-    contentViewToSwitchTo = this._myHashTableOfPageViewsKeyedByUuid[page.getUuid()];
-    if (!contentViewToSwitchTo) {
-      divElement = window.document.createElement(&quot;div&quot;); 
-      this._myContentViewDivElement.appendChild(divElement);
-      contentViewToSwitchTo = new PageView(this, divElement, page);
-      this._myHashTableOfPageViewsKeyedByUuid[page.getUuid()] = contentViewToSwitchTo;
-    }
-  }
-  if (this._myCurrentContentView) {
-    this._myCurrentContentView.includeOnScreen(false);
-  }
-  this._myCurrentContentView = contentViewToSwitchTo;
-  this.display();
-};
-
-  
-/**
- * Re-creates all the HTML for the RootView, including the chrome and 
- * the current PageView, and hands the HTML to the browser to be re-drawn.
- *
- * @scope    public instance method
- */
-RootView.prototype.display = function () {
-  Util.assert(this._myCurrentContentView instanceof Object);
-
-  document.title = this._myCurrentContentView.getPageTitle() + &quot; - openagenda.org&quot;;
-  this.displayControlSpan();
-  this.displayNavbar();
-  this.displayDebugArea();
-  this._myCurrentContentView.includeOnScreen(true);
-  window.focus();
-};
-
-
-/**
- * Re-creates the HTML for the chrome area containing the controls,
- * and hands the HTML to the browser to be re-drawn.
- *
- * @scope    public instance method
- */
-RootView.prototype.displayControlSpan = function () {
-  Util.assert(this.myMainControlSpanElement instanceof HTMLSpanElement);
-
-  var listOfStrings = [];
-  
-  var buttonValue = (this.myEditMode) ? &quot;Save&quot; : &quot;Edit&quot;;
-  listOfStrings.push(&quot;&lt;input type=\&quot;button\&quot; class=\&quot;&quot; + RootView.ELEMENT_CLASS_PAGE_EDIT_BUTTON + &quot;\&quot; id=\&quot;&quot; + this.myEditButtonId + &quot;\&quot; name=\&quot;layout\&quot; value=\&quot;&quot; + buttonValue + &quot;\&quot;&gt;&lt;/input&gt;&quot;);
-
-  // write out the new control span content 
-  var finalString = listOfStrings.join(&quot;&quot;);
-  this.myMainControlSpanElement.innerHTML = finalString;
-
-  // add event handlers for the newly created control span UI elements
-  var editButton = document.getElementById(this.myEditButtonId);
-  var listener = this;
-  Util.addEventListener(editButton, &quot;click&quot;,
-    function(event) { listener.clickOnEditButton(event);});
-};
-
-
-/**
- * Re-creates the HTML for the Navbar, and hands the HTML to the browser 
- * to be re-drawn.
- *
- * @scope    public instance method
- */
-RootView.prototype.displayNavbar = function () {
-  Util.assert(this.myNavbarDivElement instanceof HTMLDivElement);
-
-  var listOfStrings = [];
-
-  listOfStrings.push(&quot;&lt;ul class=\&quot;menu\&quot;&gt;&quot;);
-  
-  for (var uuid in this.myHashTableOfPagesKeyedByUuid) {
-    var page = this.myHashTableOfPagesKeyedByUuid[uuid];
-    var menuText = page.getShortName();
-    var menuUrl = RootView.URL_HASH_PAGE_PREFIX + page.getUuid();
-    listOfStrings.push(&quot;&lt;li class=\&quot;menu_item\&quot;&gt;&lt;a href=\&quot;&quot; + menuUrl + &quot;\&quot; onclick=\&quot;RootView.clickOnLocalLink(event)\&quot;&gt;&quot; + menuText + &quot;&lt;/a&gt;&lt;/li&gt;&quot;);
-  }
-
-  listOfStrings.push(&quot;&lt;/ul&gt;&quot;);
-  // listOfStrings.push(&quot;&lt;p&gt;&lt;a href=\&quot;<A HREF="http://www.opensource.org/\">http://www.opensource.org/\</A>&quot;&gt;&lt;img src=\&quot;osi-certified-60x50.png\&quot; width=\&quot;60\&quot; height=\&quot;50\&quot; alt=\&quot;OSI logo\&quot;&gt;&lt;/img&gt;&lt;/a&gt;&lt;/p&gt;&quot;);
-  
-  // write out the new control span content 
-  var finalString = listOfStrings.join(&quot;&quot;);
-  this.myNavbarDivElement.innerHTML = finalString;
-};
-
-
-/**
- * Re-creates the HTML for the Debug area, and hands the HTML to the browser 
- * to be re-drawn.
- *
- * @scope    public instance method
- */
-RootView.prototype.displayDebugArea = function () {
-  Util.assert(this.myDebugDivElement instanceof HTMLDivElement);
-
-  var listOfStrings = [];
-  listOfStrings.push(&quot;&lt;textarea readonly id=\&quot;&quot; + RootView.ELEMENT_ID_DEBUG_TEXTAREA + &quot;\&quot; rows=\&quot;20\&quot; cols=\&quot;100\&quot; wrap=\&quot;virtual\&quot;&gt;&lt;/textarea&gt;&quot;);
-  var finalString = listOfStrings.join(&quot;&quot;);
-  this.myDebugDivElement.innerHTML = finalString;
-  this.myDebugTextarea = document.getElementById(RootView.ELEMENT_ID_DEBUG_TEXTAREA);
-}
-
-
-// -------------------------------------------------------------------
-// Debug error display methods
-// -------------------------------------------------------------------
-
-/**
- * Displays a text string in the status blurb span.
- *
- * @scope    public class method
- * @param    inText    A text string to be displayed. 
- */
-RootView.displayStatusBlurb = function (inText) {
-  RootView.ourSingleInstance.displayStatusBlurb(inText);
-};
-
-
-/**
- * Displays a text string in the status blurb span.
- *
- * @scope    public instance method
- * @param    inText    A text string to be displayed. 
- */
-RootView.prototype.displayStatusBlurb = function (inText) {
-  this.myStatusBlurbSpanElement.innerHTML = inText;
-};
-
-
-/**
- * Displays a text string in the debug textarea.
- *
- * @scope    public class method
- * @param    inText    A text string to be displayed. 
- */
-RootView.displayTextInDebugTextarea = function (inText) {
-  RootView.ourSingleInstance.displayTextInDebugTextarea(inText);
-};
-
-
-/**
- * Displays a text string in the debug textarea.
- *
- * @scope    public instance method
- * @param    inText    A text string to be displayed. 
- */
-RootView.prototype.displayTextInDebugTextarea = function (inText) {
-  this.myNumberOfCallsToDebug++;
-  if (this.myNumberOfCallsToDebug &gt; 20) {
-    return;
-  }
-  this.myDebugTextarea.value += inText + &quot;\n\n============================\n\n&quot;;
-  this.myDebugTextarea.style.visibility = &quot;visible&quot;;
-  this.myDebugTextarea.style.display = &quot;block&quot;;
-  this.myDebugTextarea.scrollIntoView();
-};
-
-
-/**
- * Given a JavaScript object, gets all the values of all the object's properties,
- * and displays them in the debug textarea.
- *
- * @scope    public instance method
- * @param    inObject    Any sort of object. 
- */
-RootView.prototype.displayObjectInDebugTextarea = function (inObject) {
-  var outputText = &quot;&quot;;
-  for (var property in inObject) {
-    outputText += property + &quot; == &quot; + inObject[property] + &quot;\n&quot;;
-  }
-  this.displayTextInDebugTextarea(outputText);
-}
-
-
-// -------------------------------------------------------------------
-// Event handler methods
-// -------------------------------------------------------------------
-
-/**
- * Called when the user clicks on a menu item in the navbar, or on any other 
- * auto-generated link that points to other Blue-sky content.
- * 
- * Called from an HTML &quot;li&quot; element or an HTML &quot;a&quot; element on a generated page.
- * There is no need to call this method directly.
- *
- * @scope    public class method
- * @param    inEventObject    An event object. 
- */
-RootView.clickOnLocalLink = function (inEventObject) {
-  var eventObject = inEventObject || window.event;
-  
-  var startTiming = new Date();
-  
-  // &quot;wait&quot;, &quot;auto&quot;, &quot;default&quot;, &quot;crosshair&quot;, &quot;help&quot;
-  // &quot;n-resize&quot;, &quot;s-resize&quot;, &quot;e-resize&quot;, &quot;w-resize&quot;
-  // &quot;ne-resize&quot;, &quot;se-resize&quot;, &quot;nw-resize&quot;, &quot;sw-resize&quot;
-  // window.document.body.style.cursor = &quot;wait&quot;;
-
-  var htmlAnchorElement = Util.getTargetFromEvent(eventObject);
-  
-  window.location = htmlAnchorElement.href;
-  RootView.ourSingleInstance.setCurrentContentViewFromUrl();
-
-  // window.document.body.style.cursor = &quot;default&quot;;
-  
-  var stopTiming = new Date();
-  var delayInMilliseconds = stopTiming.getTime() - startTiming.getTime();
-  RootView.ourSingleInstance.displayStatusBlurb(&quot;Page load: &quot; + delayInMilliseconds + &quot; milliseconds&quot;);
-};
-
-  
-/**
- * Called when the user clicks on the big &quot;Edit&quot; button.
- * 
- * Called from an HTML &quot;input type='button'&quot; element on the generated page.  
- * There is no need to call this method directly.
- *
- * @scope    public instance method
- * @param    inEventObject    An event object. 
- */
-RootView.prototype.clickOnEditButton = function (inEventObject) {
-  var stevedore = this.getStevedore();
-  if (this.myEditMode) {
-    stevedore.endTransaction();
-    window.document.body.style.cursor = &quot;auto&quot;;
-  } else {
-    stevedore.beginTransaction();
-    window.document.body.style.cursor = &quot;crosshair&quot;;
-  }
-  this.myEditMode = !this.myEditMode;
-  this.display();
-  // this.displayTextInDebugTextarea(this.myEditMode);
-  if (!this.myEditMode &amp;&amp; window.location &amp;&amp; (window.location.protocol == &quot;file:&quot;)) {
-    RootView.displayTextInDebugTextarea(stevedore._getJsonStringRepresentingAllItems());
-  }
-};
-
-
-// -------------------------------------------------------------------
-// End of file
-// -------------------------------------------------------------------

Deleted: trunk/source/section_view.js
===================================================================
--- trunk/source/section_view.js	2005-04-05 05:02:08 UTC (rev 20)
+++ trunk/source/section_view.js	2005-04-05 21:00:35 UTC (rev 21)
@@ -1,273 +0,0 @@
-/*****************************************************************************
- section_view.js
- 
-******************************************************************************
- Written in 2005 by Brian Douglas Skinner &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openrecord-svn">brian.skinner at gumption.org</A>&gt;
-  
- Copyright rights relinquished under the Creative Commons  
- Public Domain Dedication:
-    <A HREF="http://creativecommons.org/licenses/publicdomain/">http://creativecommons.org/licenses/publicdomain/</A>
-  
- You can copy freely from this file.  This work may be freely reproduced, 
- distributed, transmitted, used, modified, built upon, or otherwise exploited
- by anyone for any purpose.
-  
- This work is provided on an &quot;AS IS&quot; basis, without warranties or conditions 
- of any kind, either express or implied, including, without limitation, any 
- warranties or conditions of title, non-infringement, merchantability, or 
- fitness for a particular purpose. You are solely responsible for determining 
- the appropriateness of using or distributing the work and assume all risks 
- associated with use of this work, including but not limited to the risks and 
- costs of errors, compliance with applicable laws, damage to or loss of data 
- or equipment, and unavailability or interruption of operations.
-
- In no event shall the authors or contributors have any liability for any 
- direct, indirect, incidental, special, exemplary, or consequential damages,
- however caused and on any theory of liability, whether in contract, strict 
- liability, or tort (including negligence), arising in any way out of or in 
- connection with the use or distribution of the work.
-*****************************************************************************/
-
-
-// -------------------------------------------------------------------
-// Dependencies:
-//   repository.js
-//   util.js
-//   page_view.js
-//   table_layout.js
-// -------------------------------------------------------------------
-
-
-// -------------------------------------------------------------------
-// SectionView public class constants
-// -------------------------------------------------------------------
-SectionView.LAYOUT_TABLE = &quot;Table&quot;;
-SectionView.LAYOUT_OUTLINE = &quot;Outline&quot;;
-SectionView.LAYOUT_DETAIL = &quot;Detail&quot;;
-SectionView.LAYOUT_BAR_CHART = &quot;Bar Chart&quot;;
-
-SectionView.ELEMENT_CLASS_SECTION = &quot;section&quot;;
-SectionView.ELEMENT_CLASS_SECTION_LAYOUT_MENU = &quot;section_layout_menu&quot;;
-SectionView.ELEMENT_CLASS_SIMPLE_TABLE = &quot;simple_table&quot;;
-SectionView.ELEMENT_CLASS_NEW_ITEM = &quot;newitem&quot;;
-SectionView.ELEMENT_CLASS_PLAIN = &quot;plain&quot;;
-SectionView.ELEMENT_CLASS_LABEL = &quot;label&quot;;
-SectionView.ELEMENT_CLASS_TITLE = &quot;title&quot;;
-SectionView.ELEMENT_CLASS_TEXT_FIELD_IN_TABLE_CELL = &quot;text_field_in_table_cell&quot;;
-SectionView.ELEMENT_CLASS_SELECTED = &quot;selected&quot;;
-SectionView.ELEMENT_CLASS_MORE_LINK = &quot;more&quot;;
-SectionView.ELEMENT_CLASS_TEXT_VIEW = &quot;text_view&quot;;
-
-SectionView.ELEMENT_ID_SELECT_MENU_PREFIX = &quot;select_menu_&quot;;
-SectionView.ELEMENT_ID_SELECT_MENU_SUFFIX = &quot;_select_menu&quot;;
-SectionView.ELEMENT_ID_LAYOUT_DIV_SUFFIX = &quot;_layout_div&quot;;
-SectionView.ELEMENT_ID_CELL_PREFIX = &quot;section_&quot;;
-SectionView.ELEMENT_ID_CELL_MIDFIX = &quot;_cell_&quot;;
-SectionView.ELEMENT_ID_SUMMARY_DIV_SUFFIX = &quot;_summary_div&quot;;
-
-SectionView.ELEMENT_ATTRIBUTE_SECTION_NUMBER = &quot;section_number&quot;;
-SectionView.ELEMENT_ATTRIBUTE_CELL_NUMBER = &quot;cell_number&quot;;
-
-
-// -------------------------------------------------------------------
-// SectionView class properties
-// -------------------------------------------------------------------
-SectionView.ourHashTableOfLayoutClassesKeyedByLayoutName = {};
-
-
-/**
- * A PageView uses instances of a SectionViews to display the Sections 
- * of a page. 
- *
- * @scope    public instance constructor
- * @extends  View
- * @param    inPageView    The PageView that serves as the superview for this view. 
- * @param    inDivElement    The HTMLDivElement to display the HTML in. 
- * @param    inSection    The Section item to be displayed in by this view. 
- * @param    inSectionNumber    The number of the section on the page (1, 2, 3, 4...). 
- * @syntax   var sectionView = new SectionView()
- */
-SectionView.prototype = new View();  // makes SectionView be a subclass of View
-function SectionView(inPageView, inDivElement, inSection, inSectionNumber) {
-  Util.assert(inPageView instanceof PageView);
-  Util.assert(inSection instanceof Item);
-  
-  // instance properties
-  // PENDING: these should all be private
-  this.setSuperview(inPageView);
-  this.setDivElement(inDivElement);
-  this.mySection = inSection;
-  this.mySectionNumber = inSectionNumber;
-  var query = inSection.getValueListFromAttribute(Stevedore.UUID_FOR_ATTRIBUTE_QUERY)[0];
-  this.myListOfContentItems = this.getStevedore().getListOfResultItemsForQuery(query); 
-
-  this._myLayout = null;
-  this._myLayoutDiv = null;
-  this._myHasEverBeenDisplayedFlag = false;
-  this._mySectionSummaryView = null;
-}
-
-
-// -------------------------------------------------------------------
-// Public class methods
-// -------------------------------------------------------------------
-
-/**
- * Given a string or an item, returns a string.
- *
- * @scope    public class method
- * @param    inValue    A string or an Item. 
- * @return   A string.
- */
-SectionView.getStringForValue = function (inValue) {
-  var string = &quot;&quot;;
-  if (Util.isString(inValue)) {
-    string = inValue;
-  }
-  if (inValue instanceof Item) {
-    string = inValue.getDisplayName();
-  }
-  return string;
-};
-
-
-// -------------------------------------------------------------------
-// Public instance methods
-// -------------------------------------------------------------------
-
-/**
- * Given the name of a layout (&quot;Table&quot;, &quot;Outline&quot;, etc.), returns a newly
- * created layout object of that type, initialized to be the layout for this 
- * SectionView.
- *
- * @scope    public instance method
- * @param    inLayoutName    A string. One of the registered layout names. 
- * @param    inLayoutDiv    The HTMLDivElement to display the layout in. 
- * @return   A newly created layout object, initialized to be the layout for this section.
- */
-SectionView.prototype.getLayoutFromLayoutName = function (inLayoutName, inLayoutDiv) {
-  Util.assert(Util.isString(inLayoutName));
-  
-  var newLayout = null;
-  var layoutClass = SectionView.ourHashTableOfLayoutClassesKeyedByLayoutName[inLayoutName];
-  if (layoutClass) {
-    newLayout = new layoutClass(this, inLayoutDiv);
-  }
-  return newLayout;
-};
-
-
-/**
- * Returns a list of content items to be displayed in this SectionView.
- *
- * @scope    public instance method
- * @return   A list of content items.
- */
-SectionView.prototype.getListOfContentItems = function () {
-  var query = this.mySection.getValueListFromAttribute(Stevedore.UUID_FOR_ATTRIBUTE_QUERY)[0];
-  this.myListOfContentItems = this.getStevedore().getListOfResultItemsForQuery(query); 
-  return this.myListOfContentItems;
-};
-
-
-/**
- * Updates the HTML elements in this view to reflect any changes in 
- * the data, and tells the sub-views to refresh themselves too.
- *
- * @scope    public instance method
- */
-SectionView.prototype.refresh = function () {
-  if (!this._myHasEverBeenDisplayedFlag) {
-    this.doInitialDisplay();
-  } else {
-    // refresh the &lt;h2&gt; element with the value: this.mySection.getDisplayName();  
-    this._mySectionSummaryView.refresh();
-    this._myLayout.refresh();
-  }
-};
-
-
-/**
- * Re-creates all the HTML for the SectionView, and hands the HTML to the 
- * browser to be re-drawn.
- *
- * @scope    public instance method
- */
-SectionView.prototype.doInitialDisplay = function () {
-  if (!this.getDivElement()) {
-    return;
-  }
-  var selectedLayoutName = this.mySection.getValueListFromAttribute(Stevedore.UUID_FOR_ATTRIBUTE_LAYOUT_NAME)[0];
-  var query = this.mySection.getValueListFromAttribute(Stevedore.UUID_FOR_ATTRIBUTE_QUERY)[0];
-  this.myListOfContentItems = this.getStevedore().getListOfResultItemsForQuery(query); 
-  if (!this.myListOfContentItems) {
-    return;
-  }
-
-  var sectionDiv = this.getDivElement();
-  var outerDiv = View.createAndAppendElement(sectionDiv, &quot;div&quot;, SectionView.ELEMENT_CLASS_SECTION);
-  var headerH2 = View.createAndAppendElement(outerDiv, &quot;h2&quot;);
-  headerH2.innerHTML = this.mySection.getDisplayName();
-  var summaryDiv = View.createAndAppendElement(outerDiv, &quot;div&quot;);
-  this._mySectionSummaryView = new MultiLineTextView(this, summaryDiv, this.mySection, Stevedore.UUID_FOR_ATTRIBUTE_SUMMARY, SectionView.ELEMENT_CLASS_TEXT_VIEW);
-  View.createAndAppendElement(outerDiv, &quot;p&quot;);
-
-  // create the layout editing controls, if we're in edit mode
-  var selectMenuId = SectionView.ELEMENT_ID_SELECT_MENU_PREFIX + this.mySection.getUuid();
-  var selectElement = View.createAndAppendElement(outerDiv, &quot;select&quot;, SectionView.ELEMENT_CLASS_SECTION_LAYOUT_MENU, selectMenuId);
-  selectElement.setAttribute(&quot;name&quot;, selectMenuId);
-  selectElement.setAttribute(SectionView.ELEMENT_ATTRIBUTE_SECTION_NUMBER, this.mySectionNumber);
-  for (var layoutName in SectionView.ourHashTableOfLayoutClassesKeyedByLayoutName) {
-    var optionElement = View.createAndAppendElement(selectElement, &quot;option&quot;);
-    optionElement.selected = (selectedLayoutName == layoutName);
-    optionElement.setAttribute(&quot;value&quot;, layoutName);
-    // Util.addEventListener(optionElement, &quot;click&quot;, SectionView.clickOnLayoutSelectionMenu);
-    var listener = this; 
-    Util.addEventListener(optionElement, &quot;click&quot;, function(event) {listener.clickOnLayoutSelectionMenu(event);});
-    optionElement.innerHTML = layoutName;
-  }
-
-  // create a div element for the layout class to use
-  this._myLayoutDiv = View.createAndAppendElement(outerDiv, &quot;div&quot;);
-  this._myLayout = this.getLayoutFromLayoutName(selectedLayoutName, this._myLayoutDiv);
-  this._myHasEverBeenDisplayedFlag = true;
-  this.refresh();
-};
-  
-
-// -------------------------------------------------------------------
-// Event handler methods
-// -------------------------------------------------------------------
-
-/**
- * Called when the user clicks on any of the layout option-select controls.
- * Called from an HTML option element within an HTML select element.
- *
- * @scope    public instance method
- * @param    inEventObject    An event object. 
- */
-SectionView.prototype.clickOnLayoutSelectionMenu = function (inEventObject) {
-  var eventObject = inEventObject || window.event;
-  var optionElement = Util.getTargetFromEvent(eventObject);
-  // PENDING: We could replace the lines above with &quot;var optionElement = this;&quot;
-  // That would work fine in Firefox, but maybe it wouldn't work in other browsers?  
-  
-  var selectElement = optionElement.parentNode;
-  var newChoiceName = optionElement.value;
-
- 
-  if (this._myLayout.getLayoutName() == newChoiceName) {
-    return;
-  } else {
-    this._myLayout.endOfLife();
-    this._myLayout = this.getLayoutFromLayoutName(newChoiceName, this._myLayoutDiv);
-    this.mySection.clear(Stevedore.UUID_FOR_ATTRIBUTE_LAYOUT_NAME);
-    this.mySection.assign(Stevedore.UUID_FOR_ATTRIBUTE_LAYOUT_NAME, newChoiceName);
-    this.refresh();
-  }
-};
-
-
-// -------------------------------------------------------------------
-// End of file
-// -------------------------------------------------------------------

Deleted: trunk/source/stevedore.js
===================================================================
--- trunk/source/stevedore.js	2005-04-05 05:02:08 UTC (rev 20)
+++ trunk/source/stevedore.js	2005-04-05 21:00:35 UTC (rev 21)
@@ -1,638 +0,0 @@
-/*****************************************************************************
- stevedore.js
- 
-******************************************************************************
- Written in 2005 by Brian Douglas Skinner &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openrecord-svn">brian.skinner at gumption.org</A>&gt;
-  
- Copyright rights relinquished under the Creative Commons  
- Public Domain Dedication:
-    <A HREF="http://creativecommons.org/licenses/publicdomain/">http://creativecommons.org/licenses/publicdomain/</A>
-  
- You can copy freely from this file.  This work may be freely reproduced, 
- distributed, transmitted, used, modified, built upon, or otherwise exploited
- by anyone for any purpose.
-  
- This work is provided on an &quot;AS IS&quot; basis, without warranties or conditions 
- of any kind, either express or implied, including, without limitation, any 
- warranties or conditions of title, non-infringement, merchantability, or 
- fitness for a particular purpose. You are solely responsible for determining 
- the appropriateness of using or distributing the work and assume all risks 
- associated with use of this work, including but not limited to the risks and 
- costs of errors, compliance with applicable laws, damage to or loss of data 
- or equipment, and unavailability or interruption of operations.
-
- In no event shall the authors or contributors have any liability for any 
- direct, indirect, incidental, special, exemplary, or consequential damages,
- however caused and on any theory of liability, whether in contract, strict 
- liability, or tort (including negligence), arising in any way out of or in 
- connection with the use or distribution of the work.
-*****************************************************************************/
-
- 
-// -------------------------------------------------------------------
-// Dependencies:
-//   util.js
-//   item.js
-// -------------------------------------------------------------------
-
-
-// -------------------------------------------------------------------
-// Stevedore public class constants
-// -------------------------------------------------------------------
-Stevedore.UUID_FOR_ATTRIBUTE_UUID = 100;
-Stevedore.UUID_FOR_ATTRIBUTE_SHORT_NAME = 101;
-Stevedore.UUID_FOR_ATTRIBUTE_NAME = 102;
-Stevedore.UUID_FOR_ATTRIBUTE_SUMMARY = 103;
-Stevedore.UUID_FOR_ATTRIBUTE_BODY = 104;
-Stevedore.UUID_FOR_ATTRIBUTE_CATEGORY = 105;
-Stevedore.UUID_FOR_ATTRIBUTE_USERSTAMP = 106;
-Stevedore.UUID_FOR_ATTRIBUTE_TIMESTAMP = 107;
-Stevedore.UUID_FOR_ATTRIBUTE_SECTION = 108;
-Stevedore.UUID_FOR_ATTRIBUTE_QUERY = 109;
-Stevedore.UUID_FOR_ATTRIBUTE_QUERY_MATCHING_CATEGORY = 110;
-Stevedore.UUID_FOR_ATTRIBUTE_QUERY_MATCHING_ITEM = 111;
-Stevedore.UUID_FOR_ATTRIBUTE_LAYOUT_NAME = 112;
-
-Stevedore.UUID_FOR_CATEGORY_BOOK = 141;      // here as an example only
-Stevedore.UUID_FOR_CATEGORY_MOVIE = 142;     // here as an example only
-Stevedore.UUID_FOR_CATEGORY_ATTRIBUTE = 143;
-Stevedore.UUID_FOR_CATEGORY_CATEGORY = 144;
-Stevedore.UUID_FOR_CATEGORY_PAGE = 145;
-Stevedore.UUID_FOR_CATEGORY_SECTION = 146;
-Stevedore.UUID_FOR_CATEGORY_QUERY = 147;
-
-Stevedore.JSON_MEMBER_FORMAT = &quot;format&quot;;
-Stevedore.JSON_MEMBER_TIMESTAMP = &quot;timestamp&quot;;
-Stevedore.JSON_MEMBER_DATA = &quot;data&quot;;
-Stevedore.JSON_FORMAT_2005_MARCH = &quot;2005_MARCH_ITEM_CENTRIC_LIST&quot;;
-
-Stevedore.JSON_MEMBER_TYPE = &quot;type&quot;;
-Stevedore.JSON_MEMBER_VALUE = &quot;value&quot;;
-Stevedore.JSON_TYPE_STRING_VALUE = &quot;StringValue&quot;;
-Stevedore.JSON_TYPE_UUID = &quot;Uuid&quot;;
-Stevedore.JSON_TYPE_FOREIGN_UUID = &quot;ForeignUuid&quot;;
-Stevedore.JSON_TYPE_NUMBER_VALUE = &quot;NumberValue&quot;;
-
-
-/**
- * Instances of the Stevedore class know how to store and retrieve items to 
- * and from a data source.
- *
- * @scope    public instance constructor
- */
-function Stevedore() {
-  this._myNextAvailableUuid = 1;
-  this._myHashTableOfItemsKeyedByUuid = {};
-  this._myCountOfNestedTransactions = 0;
-  this._myHomePageItem = null;
-  this._myXMLHttpRequestObject = this._newXMLHttpRequestObject();
-  this._myListOfDirtyItems = [];
-  // this._myDirtyFlag = false;
-  
-  this._loadBootstrapItems();
-}
-
-
-/**
- * Returns a newly created item.
- *
- * @scope    public instance method
- * @param    inObserver    Optional. An object to be registered as an observer of the returned item. 
- * @return   A newly created item.
- */
-Stevedore.prototype.newItem = function (inObserver) {
-  var uuid = this._myNextAvailableUuid;
-  this._myNextAvailableUuid += 1;
-  var item = new Item(this, uuid);
-  this._myHashTableOfItemsKeyedByUuid[uuid] = item;
-  item.addObserver(inObserver);
-  this.markDirty(item);
-  return item;
-};
-
-
-// -------------------------------------------------------------------
-// Accessor Methods
-// -------------------------------------------------------------------
-
-/**
- * Given a UUID, returns the item identified by that UUID.
- *
- * @scope    public instance method
- * @param    inUuid    The UUID of the item to be returned. 
- * @param    inObserver    Optional. An object to be registered as an observer of the returned item. 
- * @return   The item identified by the given UUID.
- */
-Stevedore.prototype.getItemFromUuid = function (inUuid, inObserver) {
-  Util.assert(Util.isNumeric(inUuid));
-  
-  var item = this._myHashTableOfItemsKeyedByUuid[inUuid];
-  if (item &amp;&amp; inObserver) {
-    item.addObserver(inObserver);
-  }
-  return item;
-};
-
-
-/**
- * Given an attribute or an attribute's UUID, return the attribute's UUID.
- *
- * @scope    public instance method
- * @param    inAttributeOrUuid    An attribute, or an attribute's UUID. 
- * @return   The UUID of the attribute.
- */
-Stevedore.prototype.getAttributeUuidFromAttributeOrUuid = function (inAttributeOrUuid) {
-  Util.assert((inAttributeOrUuid instanceof Item) || Util.isNumeric(inAttributeOrUuid));
-
-  var uuid = null;
-  if (Util.isNumeric(inAttributeOrUuid)) {
-    uuid = inAttributeOrUuid;
-  }
-  if (inAttributeOrUuid instanceof Item) {
-    uuid = inAttributeOrUuid.getUuid();
-  }
-  return uuid;
-};
-
-
-/**
- * Returns the page item to be used as the home page.
- *
- * @scope    public instance method
- * @return   A page item.
- */
-Stevedore.prototype.getHomePage = function () {
-  return this._myHomePageItem; 
-};
-
-
-/**
- * Given a query item, this method returns a list of all the items that 
- * match the query criteria.
- *
- * @scope    public instance method
- * @param    inQuery    A query item. 
- * @return   A list of items.
- */
-Stevedore.prototype.getListOfResultItemsForQuery = function (inQuery) {
-  Util.assert(inQuery instanceof Item);
-
-  var listOfQueryResultItems = null;
-  var listOfMatchingCategories = inQuery.getValueListFromAttribute(Stevedore.UUID_FOR_ATTRIBUTE_QUERY_MATCHING_CATEGORY);
-  var listOfMatchingItems = inQuery.getValueListFromAttribute(Stevedore.UUID_FOR_ATTRIBUTE_QUERY_MATCHING_ITEM);
-  var isCategoryMatchingQuery = (listOfMatchingCategories &amp;&amp; (listOfMatchingCategories.length &gt; 0));
-  var isItemMatchingQuery = (listOfMatchingItems &amp;&amp; (listOfMatchingItems.length &gt; 0));
-
-  Util.assert(!(isCategoryMatchingQuery &amp;&amp; isItemMatchingQuery));
-
-  if (isItemMatchingQuery) {
-    listOfQueryResultItems = listOfMatchingItems;
-  }
-  
-  if (isCategoryMatchingQuery) {
-    listOfQueryResultItems = [];
-    // This is a wildly inefficient search.  But maybe it doesn't matter,
-    // because this code should all be replaced someday by server code.
-    for (var uuid in this._myHashTableOfItemsKeyedByUuid) {
-      var item = this._myHashTableOfItemsKeyedByUuid[uuid];
-      var includeItem = true;
-      for (var key in listOfMatchingCategories) {
-        var category = listOfMatchingCategories[key];
-        if (includeItem &amp;&amp; !(item.isInCategory(category))) {
-          includeItem = false;
-        }
-      }
-      if (includeItem) {
-        listOfQueryResultItems.push(item);
-      }
-    }
-  }
-  
-  if (!isItemMatchingQuery &amp;&amp; !isCategoryMatchingQuery) {
-    listOfQueryResultItems = [];
-    for (var uuid in this._myHashTableOfItemsKeyedByUuid) {
-      var item = this._myHashTableOfItemsKeyedByUuid[uuid];
-      listOfQueryResultItems.push(item);
-    }
-  }
-  
-  return listOfQueryResultItems; 
-};
-
-
-
-/**
- * Given an item and a query item, this method modifies the attributes 
- * of the item so that when the query is next evaluated the item will be 
- * included in query result list.
- *
- * @scope    public instance method
- * @param    inItem    An item, which will be modified so that it matches the query. 
- * @param    inQuery    A query item. 
- */
-Stevedore.prototype.setItemToBeIncludedInQueryResultList = function (inItem, inQuery) {
-  Util.assert(inItem instanceof Item);
-  Util.assert(inQuery instanceof Item);
-
-  var listOfMatchingCategories = inQuery.getValueListFromAttribute(Stevedore.UUID_FOR_ATTRIBUTE_QUERY_MATCHING_CATEGORY);
-  var listOfMatchingItems = inQuery.getValueListFromAttribute(Stevedore.UUID_FOR_ATTRIBUTE_QUERY_MATCHING_ITEM);
-  var isCategoryMatchingQuery = (listOfMatchingCategories &amp;&amp; (listOfMatchingCategories.length &gt; 0));
-  var isItemMatchingQuery = (listOfMatchingItems &amp;&amp; (listOfMatchingItems.length &gt; 0));
-
-  Util.assert(!(isCategoryMatchingQuery &amp;&amp; isItemMatchingQuery));
-
-  if (isItemMatchingQuery) {
-    inQuery.assign(Stevedore.UUID_FOR_ATTRIBUTE_QUERY_MATCHING_ITEM, inItem);
-  }
-  
-  if (isCategoryMatchingQuery) {
-    for (var key in listOfMatchingCategories) {
-      var category = listOfMatchingCategories[key];
-      if (!(inItem.isInCategory(category))) {
-        inItem.assign(Stevedore.UUID_FOR_ATTRIBUTE_CATEGORY, category);
-      }
-    }
-  }
-};
-
-
-/**
- * Given a category, this method returns a list of all the items that have been 
- * assigned to that category.
- *
- * @scope    public instance method
- * @param    inCategory    A category item. 
- * @return   A list of items.
- */
-Stevedore.prototype.getListOfItemsInCategory = function (inCategory) {
-  Util.assert(inCategory instanceof Item);
-
-  var listOfItems = [];
-  for (var uuid in this._myHashTableOfItemsKeyedByUuid) {
-    var item = this._myHashTableOfItemsKeyedByUuid[uuid];
-    if (item.isInCategory(inCategory)) {
-      listOfItems.push(item);
-    }
-    // var kindList = item.getValueListFromAttribute(Repository.ATTRIBUTE_CALLED_KIND);
-    // if (kindList) {
-    //   if (kindList[0] == inKind) {
-    //     listOfItems.push(item);
-    //   }
-    // }
-  }
-  return listOfItems; 
-};
-
-// -------------------------------------------------------------------
-// Transaction Methods
-// -------------------------------------------------------------------
-
-/**
- * Marks the beginning of a transaction.
- *
- * Each time you call beginTransaction() you open a new transaction, 
- * which you need to close later using endTransation().  Transactions
- * may be nested, but the beginTransaction and endTransation calls
- * always need to come in pairs. 
- *
- * @scope    public instance method
- */
-Stevedore.prototype.beginTransaction = function () {
-  this._myCountOfNestedTransactions += 1;
-  // PENDING:
-  //   This is just a stub method for now.  Once we start implementing
-  //   support for transactions we'll have to put some real code here.
-};
- 
-
-/**
- * Marks the end of a transaction.
- *
- * @scope    public instance method
- */
-Stevedore.prototype.endTransaction = function () {
-  this._myCountOfNestedTransactions -= 1;
-  Util.assert(this._myCountOfNestedTransactions &gt;= 0);
-  // PENDING:
-  //   This is just a stub method for now.  Once we start implementing
-  //   support for transactions we'll have to put some real code here.
-  if (this._myCountOfNestedTransactions === 0) {
-    RootView.displayStatusBlurb(this._myListOfDirtyItems.length + &quot; changes made&quot;);
-    if (this._myListOfDirtyItems &amp;&amp; (this._myListOfDirtyItems.length &gt; 0)) {
-      this._saveChangesToServer();
-      this._myListOfDirtyItems = [];
-    }
-  }
-};
-
-
-/**
- * Marks an item as having been edited during the transaction.
- *
- * @scope    public instance method
- */
-Stevedore.prototype.markDirty = function (anItem) {
-  Util.assert(Util.isArray(this._myListOfDirtyItems));
-  this._myListOfDirtyItems.push(anItem);
-};
-
-
-// -------------------------------------------------------------------
-// Private Methods
-// -------------------------------------------------------------------
-
-/**
- * Given a UUID, either (a) returns the existing item identified by that UUID, 
- * or (b) creates an new item object, set its UUID, and returns that object.
- *
- * @scope    public instance method
- * @param    inUuid    The UUID of the item to be returned. 
- * @param    inObserver    Optional. An object to be registered as an observer of the returned item. 
- * @return   The item identified by the given UUID.
- */
-Stevedore.prototype._getItemFromUuidOrBootstrapItem = function (inUuid, inObserver) {
-  var item = this.getItemFromUuid(inUuid, inObserver);
-  if (!item) {
-    item = new Item(this, inUuid);
-    this._myHashTableOfItemsKeyedByUuid[inUuid] = item;
-    this._myNextAvailableUuid = Math.max(this._myNextAvailableUuid, (inUuid + 1));   
-    item.addObserver(inObserver);
-  }
-  return item;
-};
-
-
-/**
- * Loads the basic items that needed in order to anything else, like
- * the items for &quot;name&quot;, &quot;attribute&quot;, and &quot;category&quot;.
- *
- * @scope    private instance method
- */
-Stevedore.prototype._loadBootstrapItems = function () {
-  var uuid;
-  var name;
-  var item;
-  
-  // associate display names with the UUIDs of all the attributes
-  var hashTableOfAttributeNamesKeyedByUuid = {};
-  hashTableOfAttributeNamesKeyedByUuid[Stevedore.UUID_FOR_ATTRIBUTE_SHORT_NAME] = &quot;Short Name&quot;;
-  hashTableOfAttributeNamesKeyedByUuid[Stevedore.UUID_FOR_ATTRIBUTE_NAME] = &quot;Name&quot;;
-  hashTableOfAttributeNamesKeyedByUuid[Stevedore.UUID_FOR_ATTRIBUTE_SUMMARY] = &quot;Summary&quot;;
-  hashTableOfAttributeNamesKeyedByUuid[Stevedore.UUID_FOR_ATTRIBUTE_BODY] = &quot;Body&quot;;
-  hashTableOfAttributeNamesKeyedByUuid[Stevedore.UUID_FOR_ATTRIBUTE_CATEGORY] = &quot;Category&quot;;
-  hashTableOfAttributeNamesKeyedByUuid[Stevedore.UUID_FOR_ATTRIBUTE_USERSTAMP] = &quot;Userstamp&quot;;
-  hashTableOfAttributeNamesKeyedByUuid[Stevedore.UUID_FOR_ATTRIBUTE_TIMESTAMP] = &quot;Timestamp&quot;;
-  hashTableOfAttributeNamesKeyedByUuid[Stevedore.UUID_FOR_ATTRIBUTE_SECTION] = &quot;Section&quot;;
-  hashTableOfAttributeNamesKeyedByUuid[Stevedore.UUID_FOR_ATTRIBUTE_QUERY] = &quot;Query&quot;;
-  hashTableOfAttributeNamesKeyedByUuid[Stevedore.UUID_FOR_ATTRIBUTE_QUERY_MATCHING_CATEGORY] = &quot;Matching Category&quot;;
-  hashTableOfAttributeNamesKeyedByUuid[Stevedore.UUID_FOR_ATTRIBUTE_QUERY_MATCHING_ITEM] = &quot;Matching Item&quot;;
-  hashTableOfAttributeNamesKeyedByUuid[Stevedore.UUID_FOR_ATTRIBUTE_LAYOUT_NAME] = &quot;Layout Name&quot;;
-
-  // create all the Item objects for the attributes
-  for (uuid in hashTableOfAttributeNamesKeyedByUuid) {
-    this._getItemFromUuidOrBootstrapItem(uuid);
-  }
-  
-  // associate display names with the UUIDs of all the categories
-  var hashTableOfCategoryNamesKeyedByUuid = {};
-  hashTableOfCategoryNamesKeyedByUuid[Stevedore.UUID_FOR_CATEGORY_ATTRIBUTE] = &quot;Attribute&quot;;
-  hashTableOfCategoryNamesKeyedByUuid[Stevedore.UUID_FOR_CATEGORY_CATEGORY] = &quot;Category&quot;;
-  hashTableOfCategoryNamesKeyedByUuid[Stevedore.UUID_FOR_CATEGORY_PAGE] = &quot;Page&quot;;
-  hashTableOfCategoryNamesKeyedByUuid[Stevedore.UUID_FOR_CATEGORY_SECTION] = &quot;Section&quot;;
-  hashTableOfCategoryNamesKeyedByUuid[Stevedore.UUID_FOR_CATEGORY_QUERY] = &quot;Query&quot;;
-
-  // create all the Item objects for the categories
-  for (uuid in hashTableOfCategoryNamesKeyedByUuid) {
-    this._getItemFromUuidOrBootstrapItem(uuid);
-  }
- 
-  // set the display names of all the attributes, and put them in the category called &quot;Attribute&quot;
-  var categoryAttribute = this._getItemFromUuidOrBootstrapItem(Stevedore.UUID_FOR_CATEGORY_ATTRIBUTE);
-  for (uuid in hashTableOfAttributeNamesKeyedByUuid) {
-    item = this.getItemFromUuid(uuid);
-    name = hashTableOfAttributeNamesKeyedByUuid[uuid];
-    item._initializeAttributeValue(Stevedore.UUID_FOR_ATTRIBUTE_NAME, name);
-    item._initializeAttributeValue(Stevedore.UUID_FOR_ATTRIBUTE_CATEGORY, categoryAttribute);
-  }
-  
-  // set the display names of all the categories, and put them in the category called &quot;Category&quot;
-  var categoryCategory = this._getItemFromUuidOrBootstrapItem(Stevedore.UUID_FOR_CATEGORY_CATEGORY);
-  for (uuid in hashTableOfCategoryNamesKeyedByUuid) {
-    item = this.getItemFromUuid(uuid);
-    name = hashTableOfCategoryNamesKeyedByUuid[uuid];
-    item._initializeAttributeValue(Stevedore.UUID_FOR_ATTRIBUTE_NAME, name);
-    item._initializeAttributeValue(Stevedore.UUID_FOR_ATTRIBUTE_CATEGORY, categoryCategory);
-  }
-  
-};
-
-
-/**
- * Loads sample data.
- *
- * Given a set of sample data in JSON format, bootstraps 
- * new instances of items corresponding to the sample data.
- * 
- * @scope    private instance method
- * @param    inDataSet    A list of items to be loaded, in JSON format. 
- */
-Stevedore.prototype._loadItemsFromList = function (inDataSet) {
-  Util.assert(Util.isArray(inDataSet) || Util.isObject(inDataSet));
-  
-  var uuidValue;
-  var uuid;
-  var item;
-  var listOfItems;
-  
-  if (Util.isArray(inDataSet)) {
-    // this is an old, pre-March-15-2005, file format
-    listOfItems = inDataSet;
-  } else {
-    // this is newer file format, circa March-16-2005
-    var fileFormat = inDataSet[Stevedore.JSON_MEMBER_FORMAT];
-    Util.assert(fileFormat == Stevedore.JSON_FORMAT_2005_MARCH);
-    listOfItems = inDataSet[Stevedore.JSON_MEMBER_DATA];
-    Util.assert(Util.isArray(listOfItems));
-  }
-  
-  for (var entryKey in listOfItems) {
-    var entry = listOfItems[entryKey];
-    uuidValue = entry[Stevedore.UUID_FOR_ATTRIBUTE_UUID];
-    uuid = uuidValue[Stevedore.JSON_MEMBER_VALUE];
-    item = this._getItemFromUuidOrBootstrapItem(uuid);
-    for (var propertyKey in entry) {
-      if (propertyKey != Stevedore.UUID_FOR_ATTRIBUTE_UUID) { 
-        var propertyValue = entry[propertyKey];
-        var attributeUuid = propertyKey;
-        Util.assert(Util.isArray(propertyValue));
-        for (var valueKey in propertyValue) {
-          var valueObject = propertyValue[valueKey];
-          var valueType = valueObject[Stevedore.JSON_MEMBER_TYPE];
-          var valueValue = valueObject[Stevedore.JSON_MEMBER_VALUE];
-          var finalValue = null;
-          switch (valueType) {
-            case Stevedore.JSON_TYPE_FOREIGN_UUID:
-              finalValue = this._getItemFromUuidOrBootstrapItem(valueValue);
-              break;
-            case Stevedore.JSON_TYPE_STRING_VALUE:
-              finalValue = valueValue;
-              break;
-            case Stevedore.JSON_TYPE_NUMBER_VALUE:
-              finalValue = valueValue;
-              break;
-          }
-          item._initializeAttributeValue(attributeUuid, finalValue);
-        }
-      }
-    }
-  }
-  
-  // PENDING:
-  // If we don't have a designated &quot;home page&quot; for this data set, then just
-  // look through all the items and set the home page to be the first page 
-  // item we come across.  This, of course, is a hack.
-  if (!this._myHomePageItem) {
-    var categoryPage = this.getItemFromUuid(Stevedore.UUID_FOR_CATEGORY_PAGE);
-    for (uuid in this._myHashTableOfItemsKeyedByUuid) {
-      item = this.getItemFromUuid(uuid);
-      if (item.isInCategory(categoryPage)) {
-        this._myHomePageItem = this._myHomePageItem || item;
-      }
-    }
-  }
-};
-
-
-/**
- * Returns a huge string, containing a JavaScript &quot;object literal&quot;
- * representation of the entire cache.
- *
- * @scope    private instance method
- * @return   A string in JavaScript &quot;object literal&quot; format, representing all the items in the cache. 
- */
-Stevedore.prototype._getJsonStringRepresentingAllItems = function () {
-  var timestamp = new Date();
-  var timestampString = timestamp.toString();
-  var listOfStrings = [];
-  
-  listOfStrings.push('// Repository dump, in JSON format' + '\n');
-  listOfStrings.push('Stevedore._ourRepositoryInJsonFormat = {' + '\n');
-  listOfStrings.push('  &quot;' + Stevedore.JSON_MEMBER_FORMAT + '&quot;: &quot;' + Stevedore.JSON_FORMAT_2005_MARCH + '&quot;, ' + '\n');
-  listOfStrings.push('  &quot;' + Stevedore.JSON_MEMBER_TIMESTAMP + '&quot;: &quot;' + timestampString + '&quot;, ' + '\n');
-  listOfStrings.push('  &quot;' + Stevedore.JSON_MEMBER_DATA + '&quot;: ' + '[' + '\n');
-  for (var uuid in this._myHashTableOfItemsKeyedByUuid) {
-    var uuidInJsonForm = '{ &quot;' + Stevedore.JSON_MEMBER_TYPE + '&quot;: &quot;' + Stevedore.JSON_TYPE_UUID + '&quot;, &quot;' + Stevedore.JSON_MEMBER_VALUE + '&quot;: ' + uuid + ' }';
-    listOfStrings.push('  { &quot;' + Stevedore.UUID_FOR_ATTRIBUTE_UUID + '&quot;: ' + uuidInJsonForm + ',' + '\n');
-    var item = this.getItemFromUuid(uuid);
-    var listOfAttributeUuids = item.getListOfAttributeUuids();
-    for (var attributeKey in listOfAttributeUuids) {
-      var attributeUuid = listOfAttributeUuids[attributeKey];
-      var attribute = this.getItemFromUuid(attributeUuid);
-      Util.assert(attribute instanceof Item);
-      var attributeName = attribute.getDisplayName();
-      var attributeNameSubstring = (attributeName + '          ').substring(0, 10);
-      listOfStrings.push('    /* ' + attributeNameSubstring + ' */   ');
-      listOfStrings.push('&quot;' + attributeUuid + '&quot;: [');
-      var listOfAttributeValues = item.getValueListFromAttribute(attribute);
-      for (var valueKey in listOfAttributeValues) {
-        var value = listOfAttributeValues[valueKey];
-        var pickleString = &quot;&quot;;
-        var typeString = null;
-        var valueString = null;
-        if (Util.isNumber(value)) {
-          typeString = Stevedore.JSON_TYPE_NUMBER_VALUE;
-          valueString = value;
-        }
-        if (Util.isString(value)) {
-          typeString = Stevedore.JSON_TYPE_STRING_VALUE;
-          valueString = '&quot;' + value + '&quot;';
-        }
-        if (value instanceof Item) {
-          typeString = Stevedore.JSON_TYPE_FOREIGN_UUID;
-          valueString = value.getUuid();
-        }
-        pickleString = '{ &quot;' + Stevedore.JSON_MEMBER_TYPE + '&quot;: &quot;' + typeString + '&quot;, &quot;' + Stevedore.JSON_MEMBER_VALUE + '&quot;: ' + valueString + ' }';
-        listOfStrings.push(pickleString + ', ');
-      }
-      listOfStrings.push('],\n');
-    }
-    listOfStrings.push(&quot;  },&quot; + &quot;\n&quot;);
-  }
-  listOfStrings.push(&quot;]};&quot; + &quot;\n&quot;);
-  var finalString = listOfStrings.join(&quot;&quot;);
-  return finalString;
-};
-
-
-/**
- * Returns a newly created XMLHttpRequest object.
- *
- * @scope    private instance method
- * @return   A newly created XMLHttpRequest object. 
- */
-Stevedore.prototype._newXMLHttpRequestObject = function () {
-  var newXMLHttpRequestObject = null;
-  if (window.XMLHttpRequest) {
-    newXMLHttpRequestObject = new XMLHttpRequest();
-  } else {
-    if (window.ActiveXObject) {
-      newXMLHttpRequestObject = new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);
-    }
-  }
-  if (newXMLHttpRequestObject) {
-    newXMLHttpRequestObject.onreadystatechange = function() {
-      alert(&quot;onreadystatechange:\n&quot; +
-        &quot;readyState: &quot; + this._myXMLHttpRequestObject.readyState + &quot;\n&quot; +
-        &quot;status: &quot; + this._myXMLHttpRequestObject.status + &quot;\n&quot; +
-        &quot;statusText: &quot; + this._myXMLHttpRequestObject.statusText + &quot;\n&quot; +
-        &quot;responseText: &quot; + this._myXMLHttpRequestObject.responseText + &quot;\n&quot;);
-    };
-  }
-  return newXMLHttpRequestObject;
-};
-
-
-/**
- * Sends all the changed items to the server, so that the server can save the
- * changes.
- *
- * @scope    private instance method
- */
-Stevedore.prototype._saveChangesToServer = function () {
-  var saveChanges = false;
-  if (window.location) {
-    if (window.location.protocol == &quot;http:&quot;) {
-      saveChanges = true;
-    }
-    if (window.location.protocol == &quot;file:&quot;) {
-      alert(&quot;I can't save changes to server, because this page was loaded from a \&quot;<A HREF="file:///\">file:///\</A>&quot; location, not a real \&quot;<A HREF="http://\">http://\</A>&quot; location.  Sorry.&quot;); 
-    }
-  }
-  
-  if (saveChanges) {
-    var url = &quot;save_changes.php&quot;;
-    this._myXMLHttpRequestObject.open(&quot;POST&quot;, url, true);
-    this._myXMLHttpRequestObject.setRequestHeader(&quot;Content-Type&quot;, &quot;text/xml&quot;);
-    this._myXMLHttpRequestObject.send(this._getJsonStringRepresentingAllItems());
-  }
-  
-};
-
-
-/**
- * This is the event handler method that we register with the XMLHttpRequest
- * object's onreadystatechange property.
- *
- * @scope    private class method
- */
-Stevedore._handleStateChangeForXMLHttpRequestObject = function () {
-  alert(&quot;_handleStateChangeForXMLHttpRequestObject()\n&quot;); // +
-  //  &quot;readyState: &quot; + this._myXMLHttpRequestObject.readyState + &quot;\n&quot; +
-  //  &quot;status: &quot; + this._myXMLHttpRequestObject.status + &quot;\n&quot; +
-  //  &quot;statusText: &quot; + this._myXMLHttpRequestObject.statusText + &quot;\n&quot; +
-  //  &quot;responseText: &quot; + this._myXMLHttpRequestObject.responseText + &quot;\n&quot;);
-};
-
-// -------------------------------------------------------------------
-// End of file
-// -------------------------------------------------------------------

Deleted: trunk/source/table_layout.js
===================================================================
--- trunk/source/table_layout.js	2005-04-05 05:02:08 UTC (rev 20)
+++ trunk/source/table_layout.js	2005-04-05 21:00:35 UTC (rev 21)
@@ -1,467 +0,0 @@
-/*****************************************************************************
- table_layout.js
- 
-******************************************************************************
- Written in 2005 by Brian Douglas Skinner &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openrecord-svn">brian.skinner at gumption.org</A>&gt;
-  
- Copyright rights relinquished under the Creative Commons  
- Public Domain Dedication:
-    <A HREF="http://creativecommons.org/licenses/publicdomain/">http://creativecommons.org/licenses/publicdomain/</A>
-  
- You can copy freely from this file.  This work may be freely reproduced, 
- distributed, transmitted, used, modified, built upon, or otherwise exploited
- by anyone for any purpose.
-  
- This work is provided on an &quot;AS IS&quot; basis, without warranties or conditions 
- of any kind, either express or implied, including, without limitation, any 
- warranties or conditions of title, non-infringement, merchantability, or 
- fitness for a particular purpose. You are solely responsible for determining 
- the appropriateness of using or distributing the work and assume all risks 
- associated with use of this work, including but not limited to the risks and 
- costs of errors, compliance with applicable laws, damage to or loss of data 
- or equipment, and unavailability or interruption of operations.
-
- In no event shall the authors or contributors have any liability for any 
- direct, indirect, incidental, special, exemplary, or consequential damages,
- however caused and on any theory of liability, whether in contract, strict 
- liability, or tort (including negligence), arising in any way out of or in 
- connection with the use or distribution of the work.
-*****************************************************************************/
-
- 
-// -------------------------------------------------------------------
-// Dependencies:
-//   repository.js
-//   section_view.js
-//   page_view.js
-//   util.js
-// -------------------------------------------------------------------
-
-
-// -------------------------------------------------------------------
-// Register this layout type in the SectionView registry
-// -------------------------------------------------------------------
-SectionView.ourHashTableOfLayoutClassesKeyedByLayoutName[SectionView.LAYOUT_TABLE] = TableLayout;
-
-
-// -------------------------------------------------------------------
-// TableLayout public class constants
-// -------------------------------------------------------------------
-TableLayout.ELEMENT_ID_CURRENT_EDIT_FIELD = &quot;current_edit_field&quot;;
-
-
-/**
- * When the TableLayout creates an HTML table, it sets up each HTML &quot;td&quot; table 
- * cell element in the table to point to a corresponding CellDelegate instance.
- *
- * @scope    private instance constructor
- */
-TableLayout._CellDelegate = function (inRowDelegate, inCellElementId, inCellCount, inColumnNumber, inAttribute, inTableLayout) {
-  Util.assert(inRowDelegate instanceof TableLayout._RowDelegate);
-  Util.assert(inAttribute instanceof Item);
-  Util.assert(inTableLayout instanceof TableLayout);
-
-  this.myRowDelegate = inRowDelegate;
-  this.myCellElementId = inCellElementId;
-  this.myCellCount = inCellCount;
-  this.myColumnNumber = inColumnNumber;
-  this.myAttribute = inAttribute;
-  this.myTableLayout = inTableLayout;
-}
-
-
-/**
- * When the TableLayout creates an HTML table, it sets up each HTML &quot;tr&quot; table
- * row element in the table to point to a corresponding RowDelegate instance.
- *
- * @scope    private instance constructor
- */
-TableLayout._RowDelegate = function (inContentItem, inRowNumber) {
-  Util.assert((inContentItem == null) || (inContentItem instanceof Item));
-
-  this.myContentItem = inContentItem;
-  this.myRowNumber = inRowNumber;
-  this.myArrayOfCellDelegates = new Array();
-}
-
-
-/**
- * The TableLayout class knows how to display a Section of a Page as an
- * HTML table.
- *
- * @scope    public instance constructor
- * @extends  View
- * @param    inSectionView    The SectionView that this TableLayout will appears in. 
- * @param    inDivElement    The HTMLDivElement to display this view in. 
- */
-TableLayout.prototype = new View();  // makes TableLayout be a subclass of View
-function TableLayout(inSectionView, inDivElement) {
-  this.setSuperview(inSectionView);
-  this.setDivElement(inDivElement);  
-
-  this.myNumColumns = null;
-  this.myNumRows = null;
-  this.myArrayOfRowDelegates = new Array();
-  this.myNewItemCreatedFlag = false;
-}
-
-
-/**
- * Returns a string with the display name for this type of layout.
- *
- * @scope    public instance method
- * @return   A String with a display name for this type of layout. 
- */
-TableLayout.prototype.getLayoutName = function () {
-  return SectionView.LAYOUT_TABLE;
-};
-
-  
-/**
- * Re-creates all the HTML for the TableLayout, and hands the HTML to the 
- * browser to be re-drawn.
- *
- * @scope    public instance method
- */
-TableLayout.prototype.refresh = function () {
-  var listOfStrings = [];
-  var hashTableOfAttributesKeyedByUuid = {};
-  var hashTableOfCellDelegatesKeyedByElementId = {};
-  var attribute = null;
-  var attributeUuid = null;
-  var contentItem = null;
-  var columnCount = 0;
-  
-  // find the union of the attribute lists of all the content items
-  // PENDING: how do we know our superview responds to getListOfContentItems()? 
-  var listOfContentItems = this.getSuperview().getListOfContentItems();
-  for (var iKey in listOfContentItems) {
-    contentItem = listOfContentItems[iKey];
-    var listOfAttributesForItem = contentItem.getListOfAttributeUuids();
-    for (var attributeKey in listOfAttributesForItem) {
-      attributeUuid = listOfAttributesForItem[attributeKey];
-      if (attributeUuid != Stevedore.UUID_FOR_ATTRIBUTE_CATEGORY) {
-        hashTableOfAttributesKeyedByUuid[attributeUuid] = this.getStevedore().getItemFromUuid(attributeUuid);
-      }
-    }
-  }
-
-  // add the table header row
-  listOfStrings.push(&quot;&lt;table class=\&quot;&quot; + SectionView.ELEMENT_CLASS_SIMPLE_TABLE + &quot;\&quot;&gt;&quot;);
-  listOfStrings.push(&quot;&lt;tr&gt;&quot;);
-  this.myNumColumns = 0;
-  for (var jKey in hashTableOfAttributesKeyedByUuid) {
-    attribute = hashTableOfAttributesKeyedByUuid[jKey];
-    this.myNumColumns += 1;
-    listOfStrings.push(&quot;&lt;th&gt;&quot; + attribute.getDisplayName() + &quot;&lt;/th&gt;&quot;);
-  }
-  listOfStrings.push(&quot;&lt;/tr&gt;&quot;);
-  
-  // add all the table body rows
-  var cellCount = 0;
-  var cellIdPrefix = SectionView.ELEMENT_ID_CELL_PREFIX + this.getSuperview().mySectionNumber + SectionView.ELEMENT_ID_CELL_MIDFIX;
-  var cellId = &quot;&quot;;
-  this.myNumRows = 0;
-  for (var kKey in listOfContentItems) {
-    contentItem = listOfContentItems[kKey];
-    listOfStrings.push(&quot;&lt;tr&gt;&quot;);
-    var rowDelegate = new TableLayout._RowDelegate(contentItem, this.myNumRows);
-    this.myArrayOfRowDelegates[this.myNumRows] = rowDelegate;
-    this.myNumRows += 1;
-    columnCount = 0;
-    for (var lKey in hashTableOfAttributesKeyedByUuid) {
-      attribute = hashTableOfAttributesKeyedByUuid[lKey];
-      cellCount += 1;
-      cellId = cellIdPrefix + cellCount;
-      var valueList = contentItem.getValueListFromAttribute(attribute);
-      var string = &quot;&quot;;
-      if (valueList) {
-        string = SectionView.getStringForValue(valueList[0]);
-      }
-      if (this.isInEditMode()) {
-        listOfStrings.push(&quot;&lt;td class=\&quot;&quot; + SectionView.ELEMENT_CLASS_PLAIN + &quot;\&quot; id=\&quot;&quot; + cellId + &quot;\&quot; &quot; + SectionView.ELEMENT_ATTRIBUTE_SECTION_NUMBER + &quot;=\&quot;&quot; + this.getSuperview().mySectionNumber + &quot;\&quot; &quot; + SectionView.ELEMENT_ATTRIBUTE_CELL_NUMBER + &quot;=\&quot;&quot; + cellCount + &quot;\&quot; onclick=\&quot;TableLayout.clickOnCell(event)\&quot;&gt;&quot; + string + &quot;&lt;/td&gt;&quot;);
-        var cellDelegate = new TableLayout._CellDelegate(rowDelegate, cellId, cellCount, columnCount, attribute, this);
-        rowDelegate.myArrayOfCellDelegates[columnCount] = cellDelegate;
-        hashTableOfCellDelegatesKeyedByElementId[cellId] = cellDelegate;
-      } else {
-        // if (columnCount == 0) {
-        //   string = &quot;&lt;a href=\&quot;&quot; + RootView.URL_HASH_ITEM_PREFIX + contentItem.getUuid() + &quot;\&quot; onclick=\&quot;RootView.clickOnLocalLink(event)\&quot;&gt;&quot; + string + &quot;&lt;/a&gt;&quot;;
-        // }
-        listOfStrings.push(&quot;&lt;td class=\&quot;&quot; + SectionView.ELEMENT_CLASS_PLAIN + &quot;\&quot;&gt;&quot; + string + &quot;&lt;/td&gt;&quot;);
-      }
-      columnCount += 1;
-    }
-    listOfStrings.push(&quot;&lt;/tr&gt;&quot;);
-  }  
-
-  // if we're in edit mode, add a row at the bottom of the table for entering new items
-  var firstCell = true;
-  var lastRowDelegate = new TableLayout._RowDelegate(null, this.myNumRows);
-  this.myArrayOfRowDelegates[this.myNumRows] = lastRowDelegate;
-  this.myNumRows += 1;
-  if (this.isInEditMode()) {
-    listOfStrings.push(&quot;&lt;tr&gt;&quot;);
-    columnCount = 0;
-    for (var mKey in hashTableOfAttributesKeyedByUuid) {
-      attribute = hashTableOfAttributesKeyedByUuid[mKey];
-      var contentString = (firstCell) ? &quot;&gt;&quot; : &quot;&quot;;
-      firstCell = false;
-      cellCount += 1;
-      cellId = cellIdPrefix + cellCount;
-      listOfStrings.push(&quot;&lt;td class=\&quot;&quot; + SectionView.ELEMENT_CLASS_NEW_ITEM + &quot;\&quot; id=\&quot;&quot; + cellId + &quot;\&quot; &quot; + SectionView.ELEMENT_ATTRIBUTE_SECTION_NUMBER + &quot;=\&quot;&quot; + this.getSuperview().mySectionNumber + &quot;\&quot; &quot; + SectionView.ELEMENT_ATTRIBUTE_CELL_NUMBER + &quot;=\&quot;&quot; + cellCount + &quot;\&quot; onclick=\&quot;TableLayout.clickOnCell(event)\&quot;&gt;&quot; + contentString + &quot;&lt;/td&gt;&quot;);
-      var lastRowCellDelegate = new TableLayout._CellDelegate(lastRowDelegate, cellId, cellCount, columnCount, attribute, this);
-      lastRowDelegate.myArrayOfCellDelegates[columnCount] = lastRowCellDelegate;
-      hashTableOfCellDelegatesKeyedByElementId[cellId] = lastRowCellDelegate;
-      columnCount += 1;
-    }
-    listOfStrings.push(&quot;&lt;/tr&gt;&quot;);
-  }
-
-
-  listOfStrings.push(&quot;&lt;/table&gt;&quot;);
-  
-  // write out all the new content   
-  var finalString = listOfStrings.join(&quot;&quot;);
-  this.getDivElement().innerHTML = finalString;
-  
-  // attach back-pointers to the newly created UI elements
-  for (var elementId in hashTableOfCellDelegatesKeyedByElementId) {
-    var aCellDelegate = hashTableOfCellDelegatesKeyedByElementId[elementId];
-    var cellElement = document.getElementById(elementId);
-    cellElement.mydelegate = aCellDelegate;
-  }
-};
-  
-
-/**
- * Does final clean-up.
- *
- * @scope    public instance method
- */
-TableLayout.prototype.endOfLife = function () {
-  this.getDivElement().innerHTML = &quot;&quot;;
-};
-
-
-/**
- * Called when the user clicks on a table cell.
- * 
- * Called from an HTML &quot;td&quot; element on the generated page.  There is no need
- * to call this method directly.
- *
- * @scope    public class method
- */
-TableLayout.clickOnCell = function (inEventObject) {
-  var eventObject = inEventObject;
-  if (!eventObject) { eventObject = window.event; } 
-  // PENDING: try this instead: var eventObject = inEventObject || window.event;
-  
-  var htmlElement = Util.getTargetFromEvent(eventObject);
-  // PENDING: We could replace the two lines above with &quot;var htmlElement = this;&quot;
-  // That would work fine in Firefox, but maybe it wouldn't work in other browsers?
-
-  var currentEditField = document.getElementById(TableLayout.ELEMENT_ID_CURRENT_EDIT_FIELD);
-  if (currentEditField &amp;&amp; (currentEditField == htmlElement)) {
-    // another click in the cell we're already editing -- just ignore it
-    return; 
-  }
-  TableLayout.leaveEditField();
-  TableLayout.startEditingInCell(htmlElement);
-};
-
-
-/**
- * Called when the user first moves the cursor into one of the cells of
- * the bottom table row, which is the row used for creating new items.
- * 
- * @scope    public instance method
- * @param    inColumnNumber    An integer column number, telling which column to start editing in. 
- */
-TableLayout.prototype.startEditingInCellForNewItemAtColumn = function (inColumnNumber) {
-  var rowForNewItemEntry = this.myNumRows - 1;
-  var rowDelegateForNewItemEntry = this.myArrayOfRowDelegates[rowForNewItemEntry];
-  var cellDelegate = rowDelegateForNewItemEntry.myArrayOfCellDelegates[inColumnNumber];
-  var nextCell = document.getElementById(cellDelegate.myCellElementId);
-  TableLayout.startEditingInCell(nextCell);
-};
-
-
-/**
- * Given an HTML table cell element, adds a text field inside the
- * table cell, so the user can edit the cell.
- * 
- * @scope    public class method
- * @param    inCellElement    An HTMLTableCellElement. 
- */
-TableLayout.startEditingInCell = function (inCellElement) {
-  Util.assert(inCellElement instanceof HTMLTableCellElement);
-
-  var initialEditValue = inCellElement.innerHTML.replace(/&quot;/g, &quot;&amp;quot&quot;);
-  var editFieldString = &quot;&lt;input type=\&quot;text\&quot; class=\&quot;&quot; + SectionView.ELEMENT_CLASS_TEXT_FIELD_IN_TABLE_CELL + &quot;\&quot; id=\&quot;&quot; + TableLayout.ELEMENT_ID_CURRENT_EDIT_FIELD + &quot;\&quot; value=\&quot;&quot; + initialEditValue + &quot;\&quot; size=\&quot;1\&quot;&gt;&lt;/input&gt;&quot;;
-  inCellElement.innerHTML = editFieldString;
-  inCellElement.className = SectionView.ELEMENT_CLASS_SELECTED + &quot; &quot; + inCellElement.className;
-  // var listener = this; 
-  // Util.addEventListener(editField, &quot;blur&quot;, function(event) {listener.onBlur(event);});
-      
-  var newEditField = document.getElementById(TableLayout.ELEMENT_ID_CURRENT_EDIT_FIELD);
-  newEditField.onkeypress = TableLayout.keyPressOnEditField;
-  newEditField.select();
-  newEditField.focus();
-};
-
-
-/**
- * Called when the user is done editing a table cell. 
- *
- * @scope    public class method
- */
-TableLayout.leaveEditField = function () {
-  var currentEditField = document.getElementById(TableLayout.ELEMENT_ID_CURRENT_EDIT_FIELD);
-
-  if (currentEditField) {
-    var newValueString = currentEditField.value;
-    var cellElement = currentEditField.parentNode;
-    var cellDelegate = cellElement.mydelegate;
-
-    // find the content item for this cell, and set the attribute to the new cell value
-    var contentItem = cellDelegate.myRowDelegate.myContentItem;
-    if (!contentItem) {
-      var sectionView = cellDelegate.myTableLayout.getSuperview();
-      var stevedore = sectionView.getStevedore();
-      contentItem = stevedore.newItem(); 
-      cellDelegate.myTableLayout.myNewItemCreatedFlag = true;
-      cellDelegate.myRowDelegate.myContentItem = contentItem;
-      var queryList = sectionView.mySection.getValueListFromAttribute(Stevedore.UUID_FOR_ATTRIBUTE_QUERY);
-      if (queryList) {
-        var query = queryList[0];
-        // PENDING: We should NOT get a value from the item's PRIVATE _myStevedore property
-        contentItem._myStevedore.setItemToBeIncludedInQueryResultList(contentItem, query);
-      }
-    }
-    var attribute = cellDelegate.myAttribute;
-    var valueList = contentItem.getValueListFromAttribute(attribute);
-    var oldValueString = &quot;&quot;;
-    if (valueList) {
-      oldValueString = SectionView.getStringForValue(valueList[0]);
-    }
-    if (oldValueString != newValueString) {
-      contentItem.clear(attribute);
-      contentItem.assign(attribute, newValueString);
-    }
-    
-    // remove the edit field from the cell, and replace it with the new cell value
-    valueList = contentItem.getValueListFromAttribute(attribute);
-    newValueString = &quot;&quot;;
-    if (valueList) {
-      newValueString = SectionView.getStringForValue(valueList[0]);
-    } 
-    cellElement.innerHTML = newValueString;
-    var regularExpression = new RegExp(SectionView.ELEMENT_CLASS_SELECTED, &quot;i&quot;);
-    cellElement.className = cellElement.className.replace(regularExpression, &quot;&quot;);    
-  }
-};
-
-
-/**
- * Called when the user types a character when editing a table cell. 
- *
- * Called from an HTML &quot;input type='text'&quot; element within an HTML &quot;td&quot;
- * table cell element on the generated page.  There is no need
- * to call this method directly.
- * 
- * @scope    public class method
- */
-TableLayout.keyPressOnEditField = function (inEventObject) {
-  var eventObject = inEventObject;
-  if (!eventObject) { eventObject = window.event; }
-  var asciiValueOfKey = eventObject.keyCode;
-  var shiftKeyPressed = eventObject.shiftKey;
-  
-  var MOVE_LEFT = &quot;left&quot;;
-  var MOVE_UP = &quot;up&quot;;
-  var MOVE_RIGHT = &quot;right&quot;;
-  var MOVE_DOWN = &quot;down&quot;;
-  
-  var move = null;
-  switch (asciiValueOfKey) {
-    case Util.ASCII_VALUE_FOR_LEFT_ARROW:
-      move = MOVE_LEFT;
-      break;
-    case Util.ASCII_VALUE_FOR_UP_ARROW:
-      move = MOVE_UP;
-      break;
-    case Util.ASCII_VALUE_FOR_RIGHT_ARROW:
-      move = MOVE_RIGHT;
-      break;
-    case Util.ASCII_VALUE_FOR_DOWN_ARROW:
-      move = MOVE_DOWN;
-      break;
-    case Util.ASCII_VALUE_FOR_RETURN:
-      move = (shiftKeyPressed) ? MOVE_UP : MOVE_DOWN;
-      break;
-    case Util.ASCII_VALUE_FOR_TAB:
-      move = (shiftKeyPressed) ? MOVE_LEFT : MOVE_RIGHT;
-      break;
-    default:
-      move = null;
-      break;
-  }
-  
-  if (move) {
-    var currentEditField = document.getElementById(TableLayout.ELEMENT_ID_CURRENT_EDIT_FIELD);
-    Util.assert(currentEditField == Util.getTargetFromEvent(eventObject));
-
-    var cellElement = currentEditField.parentNode;
-    var cellDelegate = cellElement.mydelegate;
-    var tableLayout = cellDelegate.myTableLayout;
-    var sectionView = tableLayout.mySectionView;
-    var userHitReturnInLastRow = false;
-    var nextCellDelegate = null;
-    var shiftBy;
-    
-    if (move == MOVE_LEFT || move == MOVE_RIGHT) {
-      shiftBy = (move == MOVE_LEFT) ? -1 : 1;
-      var nextColumnNumber = cellDelegate.myColumnNumber + shiftBy;
-      // PENDING: We should be able to do this in one line, using a modulo operator
-      if (nextColumnNumber &lt; 0) {
-        nextColumnNumber = (tableLayout.myNumColumns - 1);
-      }
-      if (nextColumnNumber &gt;= tableLayout.myNumColumns) {
-        nextColumnNumber = 0;
-      }
-      nextCellDelegate = cellDelegate.myRowDelegate.myArrayOfCellDelegates[nextColumnNumber];
-    }
-    
-    if (move == MOVE_UP || move == MOVE_DOWN) {
-      shiftBy = (move == MOVE_UP) ? -1 : 1;
-      var nextRowNumber = cellDelegate.myRowDelegate.myRowNumber + shiftBy;
-      if (nextRowNumber &lt; 0) {
-        nextRowNumber = (tableLayout.myNumRows - 1);
-      }
-      if (nextRowNumber &gt;= tableLayout.myNumRows) {
-        nextRowNumber = 0;
-        userHitReturnInLastRow = true;
-      }
-      var nextRowDelegate = tableLayout.myArrayOfRowDelegates[nextRowNumber];
-      nextCellDelegate = nextRowDelegate.myArrayOfCellDelegates[cellDelegate.myColumnNumber];
-    }
-    
-    var nextCellId = nextCellDelegate.myCellElementId;    
-    var nextCell = document.getElementById(nextCellId);
-    TableLayout.leaveEditField();
-    if (userHitReturnInLastRow &amp;&amp; tableLayout.myNewItemCreatedFlag) {
-      tableLayout.myNewItemCreatedFlag = false;
-      tableLayout.refresh();
-      tableLayout.startEditingInCellForNewItemAtColumn(cellDelegate.myColumnNumber);
-    } else {
-      if (nextCell) {
-        TableLayout.startEditingInCell(nextCell);
-      }
-    }
-  }
-};
-
-
-// -------------------------------------------------------------------
-// End of file
-// -------------------------------------------------------------------

Deleted: trunk/source/text_view.js
===================================================================
--- trunk/source/text_view.js	2005-04-05 05:02:08 UTC (rev 20)
+++ trunk/source/text_view.js	2005-04-05 21:00:35 UTC (rev 21)
@@ -1,188 +0,0 @@
-/*****************************************************************************
- text_view.js
- 
-******************************************************************************
- Written in 2005 by Brian Douglas Skinner &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openrecord-svn">brian.skinner at gumption.org</A>&gt;
- and Chih-Chao Lam &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openrecord-svn">chao at cs.stanford.edu</A>&gt;
-  
- Copyright rights relinquished under the Creative Commons  
- Public Domain Dedication:
-    <A HREF="http://creativecommons.org/licenses/publicdomain/">http://creativecommons.org/licenses/publicdomain/</A>
-  
- You can copy freely from this file.  This work may be freely reproduced, 
- distributed, transmitted, used, modified, built upon, or otherwise exploited
- by anyone for any purpose.
-  
- This work is provided on an &quot;AS IS&quot; basis, without warranties or conditions 
- of any kind, either express or implied, including, without limitation, any 
- warranties or conditions of title, non-infringement, merchantability, or 
- fitness for a particular purpose. You are solely responsible for determining 
- the appropriateness of using or distributing the work and assume all risks 
- associated with use of this work, including but not limited to the risks and 
- costs of errors, compliance with applicable laws, damage to or loss of data 
- or equipment, and unavailability or interruption of operations.
-
- In no event shall the authors or contributors have any liability for any 
- direct, indirect, incidental, special, exemplary, or consequential damages,
- however caused and on any theory of liability, whether in contract, strict 
- liability, or tort (including negligence), arising in any way out of or in 
- connection with the use or distribution of the work.
-*****************************************************************************/
-
-
-// -------------------------------------------------------------------
-// Dependencies:
-//   repository.js
-//   util.js
-// -------------------------------------------------------------------
-
-
-// -------------------------------------------------------------------
-// MultiLineTextView public class constants
-// -------------------------------------------------------------------
-MultiLineTextView.ELEMENT_CLASS_TEXT_BLOCK = &quot;text_block&quot;;
-
-
-/**
- * An instance of MultiLineTextView can be placed in any parent container View
- * to display and (if in edit mode) edit multi-lines of text
- *
- * @scope    public instance constructor
- * @extends  View
- * @param    theSuperview    The view that this view is nested in. 
- * @param    theItem    The Item to be displayed and edited by this view. 
- * @param    theAttribute    The attribute of the item to be displayed.
- * @param    theDivElement    The HTMLDivElement to display the HTML in. 
- * @param    theClassType    A string that gives a class name to assign to the HTML element. 
- */
-MultiLineTextView.prototype = new View();  // makes MultiLineTextView be a subclass of View
-function MultiLineTextView(theSuperview, theDivElement, theItem, theAttribute, theClassType) {
-  Util.assert(theItem instanceof Item);
-  //Util.assert(theAttribute instanceof Attribute); PENDING need to check that attribute is an attribute
-  
-  this.setSuperview(theSuperview);
-  this.setDivElement(theDivElement);
-  this.textItem = theItem;
-  this.attribute = theAttribute;
-  this.editField = null;
-  this.textObj = null;
-  this.classType = theClassType;
-  this.isEditing = false;
-  this._myHasEverBeenDisplayedFlag = false;
-};
-
-
-/**
- * Updates the HTML elements in this view to reflect any changes in 
- * the item's attribute values.
- *
- * @scope    public instance method
- */
-MultiLineTextView.prototype.refresh = function() {
-  if (!this._myHasEverBeenDisplayedFlag) {
-    this.doInitialDisplay();
-  } else {
-    // if (weHaveBeenNotifiedOfChangesTo(this.textItem)) {
-    //   var newText = getNewValueFrom(this.textItem);
-    //   this.textNode.data = newText;
-    // }
-  }
-};
-
-
-/**
- * Re-creates all the HTML for the MultiLineTextView, and hands the HTML to the 
- * browser to be re-drawn.
- *
- * @scope    public instance method
- */
-MultiLineTextView.prototype.doInitialDisplay = function() {
-  var divElement = this.getDivElement();
-  Util.assert(divElement instanceof HTMLDivElement);
-  
-  divElement.className = MultiLineTextView.ELEMENT_CLASS_TEXT_BLOCK;
-  var textList = this.textItem.getValueListFromAttribute(this.attribute);
-  var textString = &quot;&quot;;
-  for (var i in textList) {
-    textString = textList[i] + &quot;\n&quot; + textString;
-  };
-  
-  this.textNode = document.createTextNode(textString);
-  divElement.appendChild(this.textNode);
-
-  var listener = this;
-  Util.addEventListener(divElement, &quot;click&quot;, function(event) { listener.onClick(event);});
-    
-  this._myHasEverBeenDisplayedFlag = true;
-};
-
-
-/**
- * Switch to edit text field for editing.
- *
- * @scope    public instance method
- */
-MultiLineTextView.prototype.startEditing = function() {
-  if (!this.isEditing) {
-    var editField = this.editField;
-    if (!editField) {
-      editField = this.editField = document.createElement(&quot;textarea&quot;);
-      editField.className = this.classType;
-      //editField.cols=80; now using css style sheet &quot;text_view&quot;
-      var listener = this; 
-      Util.addEventListener(editField, &quot;blur&quot;, function(event) {listener.onBlur(event);});
-      editField.defaultValue = this.textNode.data;
-    }
-    editField.style.height = this.getDivElement().offsetHeight + &quot;px&quot;;
-    this.getDivElement().replaceChild(editField, this.textNode);
-    editField.focus();
-    editField.select();
-    this.isEditing = true;
-  }
-};
-
-
-// -------------------------------------------------------------------
-// Event handler methods
-// -------------------------------------------------------------------
-
-/**
- * Called when the user clicks on the text.
- *
- * Handles the mouse click event on text view. Called by listener.
- *
- * @scope    public instance method
- * @param    inEventObject    An event object. 
- */
-MultiLineTextView.prototype.onClick = function(inEventObject) {
-  if (this.isInEditMode()) {
-    this.startEditing();
-  }
-};
-
-
-/**
- * Called when focus leaves the text view.
- *
- * Handles loss of focus for text view. Called by listener. Switches back 
- * to static text from editable text.
- *
- * @scope    public instance method
- * @param    inEventObject    An event object. 
- */
-MultiLineTextView.prototype.onBlur = function(inEventObject) {
-  if (this.isEditing) {
-    var newText = this.editField.value;
-    this.textItem.clear(this.attribute);
-    this.textItem.assign(this.attribute, newText); // PENDING: need to deal with multi valued attrs
-    this.textNode.data = newText;
-    this.getDivElement().replaceChild(this.textNode, this.editField);
-    this.isEditing = false;
-  }
-};
-
-
-// -------------------------------------------------------------------
-// End of file
-// -------------------------------------------------------------------
-  
\ No newline at end of file

Deleted: trunk/source/util.js
===================================================================
--- trunk/source/util.js	2005-04-05 05:02:08 UTC (rev 20)
+++ trunk/source/util.js	2005-04-05 21:00:35 UTC (rev 21)
@@ -1,411 +0,0 @@
-/*****************************************************************************
- util.js
- 
-******************************************************************************
- Written in 2005 by Brian Douglas Skinner &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openrecord-svn">brian.skinner at gumption.org</A>&gt;
-  
- Copyright rights relinquished under the Creative Commons  
- Public Domain Dedication:
-    <A HREF="http://creativecommons.org/licenses/publicdomain/">http://creativecommons.org/licenses/publicdomain/</A>
-  
- You can copy freely from this file.  This work may be freely reproduced, 
- distributed, transmitted, used, modified, built upon, or otherwise exploited
- by anyone for any purpose.
-  
- This work is provided on an &quot;AS IS&quot; basis, without warranties or conditions 
- of any kind, either express or implied, including, without limitation, any 
- warranties or conditions of title, non-infringement, merchantability, or 
- fitness for a particular purpose. You are solely responsible for determining 
- the appropriateness of using or distributing the work and assume all risks 
- associated with use of this work, including but not limited to the risks and 
- costs of errors, compliance with applicable laws, damage to or loss of data 
- or equipment, and unavailability or interruption of operations.
-
- In no event shall the authors or contributors have any liability for any 
- direct, indirect, incidental, special, exemplary, or consequential damages,
- however caused and on any theory of liability, whether in contract, strict 
- liability, or tort (including negligence), arising in any way out of or in 
- connection with the use or distribution of the work.
-*****************************************************************************/
- 
-
-/**
- * The Util class offers general utility methods that might
- * be useful in a wide variety of applications.
- *
- * There is no need to ever call this constructor.  All the Util
- * methods are class methods, not instance methods, and the only 
- * reason this constructor exists is to cause the name &quot;Util&quot;
- * to be a globally-scoped class name, which the class methods 
- * can then be attached to.
- *
- * @scope    public instance constructor
- * @syntax   DO NOT CALL THIS CONSTRUCTOR
- */
-function Util() {
-  throw new Error(&quot;Util is a static class. You can't create instances of it.&quot;);
-}
-
-
-// -------------------------------------------------------------------
-// Util public class constants
-// -------------------------------------------------------------------
-Util.ASCII_VALUE_FOR_RETURN = 13;
-Util.ASCII_VALUE_FOR_TAB = 9;
-Util.ASCII_VALUE_FOR_ESCAPE = 27;
-
-// &#37; = %
-// &#38; = &amp;
-// &#39; = '
-// &#40; = (
-Util.ASCII_VALUE_FOR_LEFT_ARROW = 37;  // 123
-Util.ASCII_VALUE_FOR_UP_ARROW = 38;    // 126
-Util.ASCII_VALUE_FOR_RIGHT_ARROW = 39; // 124
-Util.ASCII_VALUE_FOR_DOWN_ARROW = 40;  // 125
-
-
-// -------------------------------------------------------------------
-// String manipulation methods
-// -------------------------------------------------------------------
-
-/**
- * Returns a copy of the input string, cleaned up so that it can be 
- * included in a valid HTML page.
- *
- * Returns a copy of the string, but with the original characters 
- * '&lt;', '&gt;', and '&amp;' all replaced by their HTML entities: &quot;&lt;&quot;, 
- * &quot;&gt;&quot;, and &quot;&amp;&quot;.  Allows strings to displayed on HTML pages.
- *
- * @scope    public class method
- * @syntax   var cleanString = Util.getCleanString(dirtyString);
- * @param    inString    A dirty string to be cleaned up.
- * @return   String
- */
-Util.getCleanString = function(inString) {
-  Util.assert(Util.isString(inString));
-  
-  var returnString = inString;
-  returnString = returnString.replace(/&amp;/g, &quot;&amp;&quot;);
-  returnString = returnString.replace(/&lt;/g, &quot;&lt;&quot;);
-  returnString = returnString.replace(/&gt;/g, &quot;&gt;&quot;);
-  returnString = returnString.replace(/&quot;/g, &quot;&quot;&quot;);
-  returnString = returnString.replace(/\n/g, &quot; &quot;);
-  return returnString;
-};
-
-
-// -------------------------------------------------------------------
-// Assertions and error handling methods
-// -------------------------------------------------------------------
-
-/**
- * Registers a function to be used to report errors.
- *
- * @scope    public class method
- * @param    inFunction    A function which takes a single string argument. 
- */
-Util.setErrorReportCallback = function (inFunction) {
-  Util.ourErrorReporter = inFunction;
-};
-
-
-/**
- * This defaultErrorReporter simply calls &quot;alert&quot; to report errors.
- *
- * @scope    public class method
- * @param    inText    The error message to be reported. 
- */
-Util.defaultErrorReporter = function (inText) {
-  window.alert(inText);
-};
-Util.ourErrorReporter = Util.defaultErrorReporter;
-
- 
- /**
- * Pops up an alert box showing an error message.
- *
- * @scope    public class method
- * @param    inMessage    A string describing the error.
- * @param    inUrl    A string that gives the name of the file where the error was found.
- * @param    inLine    The line number where the error was found.
- */
-Util.handleError = function (inMessage, inUrl, inLine) {
-  Util.ourErrorReporter(&quot;Util.handleError()\n&quot; + inMessage + &quot;\nline: &quot; + inLine + &quot;\nURL: &quot; + inUrl);
-};
-
-
-/**
- * Pops up an alert box if the assertion fails.
- *
- * If the asserted condition is true, this method does nothing. If the condition
- * is false, this method pops up an alert box.  The alert box explains that an
- * assertion failed, and it gives a stack trace showing the file name and line
- * number where the assertion failed.
- *
- * @scope    public class method
- * @param    inBoolean    A boolean value, which needs to be true for the assertion to succeed. 
- * @param    inMessage    Optional. A string describing the assertion.
- */
-Util.assert = function (inBoolean, inMessage) {
-  var exception = new Error();  // create an exception, just to get a stack trace
-  var stackString = exception.stack;
-  var stackList = stackString.split(&quot;\n&quot;);
-  stackList.shift(); // get rid of the &quot;ReferenceError()@:0&quot; at the start of the list
-  stackList.shift(); // get rid of the &quot;(false)@file ... util.js:67&quot; at the start of the list
-  stackList.pop();   // get rid of the trailing &quot;\n&quot;
-  stackList.pop();   // get rid of the &quot;@:0&quot; at the end of the list
-  stackString = stackList.join(&quot;\n&quot;);
-  if (Util.isBoolean(inBoolean)) {
-    if (!inBoolean) {    
-      Util.ourErrorReporter(&quot;An assert statement failed.\nThe method Util.assert() was called with a 'false' value.\nHere's the stack trace, with the line number where the assert statement failed:\n&quot; + (stackString || &quot;&quot;));
-    }
-  } else {
-    Util.ourErrorReporter(&quot;An assert statement went sour.\nThe method Util.assert() was passed a non-boolean argument.\nHere's the stack trace, with the line number where the assert statement failed:\n&quot; + (stackString || &quot;&quot;));
-  }
-};
-
-
-// -------------------------------------------------------------------
-// Type checking methods
-// -------------------------------------------------------------------
-
-/**
- * Returns true if the given value is a string.
- *
- * @scope    public class method
- * @param    inValue    Any object or literal value. 
- * @return   A boolean value. True if inValue is a string.
- */
-Util.isString = function (inValue) {
-  return (typeof(inValue) == &quot;string&quot;);
-};
-
-
-/**
- * Returns true if the given value is a number (and is finite number).
- *
- * @scope    public class method
- * @param    inValue    Any object or literal value. 
- * @return   A boolean value. True if inValue is a number.
- */
-Util.isNumber = function (inValue) {
-  return ((typeof(inValue) == &quot;number&quot;) &amp;&amp; isFinite(inValue));
-};
-
-
-/**
- * Returns true if the given value is a number or a string that 
- * represents a number.
- *
- * @scope    public class method
- * @param    inValue    Any object or literal value. 
- * @return   A boolean value. True if inValue is a number or a string that represents a number.
- */
-Util.isNumeric = function (inValue) {
-  var isNumber = Util.isNumber(inValue);
-  if (isNumber) {
-    return true;
-  }
-  var isNumeric = Util.isString(inValue) &amp;&amp; Util.isNumber(parseInt(inValue));
-  return isNumeric;
-};
-
-
-/**
- * Returns true if the given value is a boolean.
- *
- * @scope    public class method
- * @param    inValue    Any object or literal value. 
- * @return   A boolean value. True if inValue is a boolean.
- */
-Util.isBoolean = function (inValue) {
-  return (typeof(inValue) == &quot;boolean&quot;);
-};
-
-
-/**
- * Returns true if the given value is an object.
- *
- * @scope    public class method
- * @param    inValue    Any object or literal value. 
- * @return   A boolean value. True if inValue is an object.
- */
-Util.isObject = function (inValue) {
-  return (inValue &amp;&amp; (typeof(inValue) == &quot;object&quot;));
-};
-
-
-/**
- * Returns true if the given value is an array.
- *
- * @scope    public class method
- * @param    inValue    Any object or literal value. 
- * @return   A boolean value. True if inValue is an array.
- */
-Util.isArray = function (inValue) {
-  return (inValue &amp;&amp; (typeof(inValue) == &quot;object&quot;) &amp;&amp; (inValue.constructor == Array));
-};
-
-
-/**
- * Returns true if the given value is a hash table.
- *
- * @scope    public class method
- * @param    inValue    Any object or literal value. 
- * @return   A boolean value. True if inValue is a hash table.
- */
-Util.isHashTable = function (inValue) {
-  return (inValue &amp;&amp; (typeof(inValue) == &quot;object&quot;));  // PENDING: we should be more restrictive!
-};
-
-
-// -------------------------------------------------------------------
-// Methods that operate on Sets
-// -------------------------------------------------------------------
-
-/**
- * Returns true if the given object is a member of the set.  
- * 
- * @scope    public class method
- * @param    inObject    The object to look for. 
- * @param    inSet    The Array to look for the object in. 
- * @return   Returns true if the object was found in the set.
- */
-Util.isObjectInSet = function (inObject, inSet) {
-  Util.assert(Util.isArray(inSet));
-  
-  for (var i=0; i&lt;inSet.length; i+=1) {
-    if (inSet[i] == inObject) {
-      return true;
-    }
-  }
-  return false;
-};
-
-
-/**
- * Removes an object from an array.  
- * 
- * @scope    public class method
- * @param    inObject    The object to be removed. 
- * @param    inSet    The Array that the object should be removed from. 
- * @return   Returns true if the object was removed from the array.
- */
-Util.removeObjectFromSet = function (inObject, inSet) {
-  Util.assert(Util.isArray(inSet));
-  
-  if (!inObject) {
-    return false;
-  }
-  for (var i=0; i&lt;inSet.length; i+=1) {
-    if (inSet[i] == inObject) {
-      inSet.splice(i, 1);
-      return true;
-    }
-  }
-  return false;
-};
-
-
-/**
- * This method is similar to array.push(object), but it will only add the
- * object to the array if the object is not already in the array.  
- * 
- * @scope    public class method
- * @param    inObject    The object to be added. 
- * @param    inSet    The Array that the object should be added to. 
- * @return   Returns true if the object was added to the array.
- */
-Util.addObjectToSet = function (inObject, inSet) {
-  Util.assert(Util.isArray(inSet));
-
-  if (!inObject) {
-    return false;
-  }
-  if (Util.isObjectInSet(inObject, inSet)) {
-    return false;
-  }
-  inSet.push(inObject);
-  return true;
-};
-
-
-// -------------------------------------------------------------------
-// Methods that deal with event handling
-// -------------------------------------------------------------------
-
-/**
- * Given an event object, returns the HTML element that was the 
- * target of the event.  
- * 
- * Should work for IE, Mozilla, and _some_ other browsers.  
- *
- * @scope    public class method
- * @param    inEventObject    An event object. 
- * @return   An HTML element.
- */
-Util.getTargetFromEvent = function (inEventObject) {
-  var target = null;
-  if (inEventObject.target) {
-    target = inEventObject.target;
-  } else {
-    if (inEventObject.srcElement) {
-      target = inEventObject.srcElement;
-    }
-  }
-  if (target &amp;&amp; target.nodeType == 3) { // defeat Safari bug
-    target = target.parentNode;
-  }
-  return target;
-};
-
-
-/**
- * A cross-browser compatibility method for registering event listeners. 
- *
- * @scope public class method
- * @param inElement    An HTMLElement.
- * @param inEventType    The type of event (e.g. &quot;mousedown&quot;, &quot;click&quot;).
- * @param inCallback    The function to call when the event happens.
- * @param inCaptures    True if the event should be captured by this function.
- */
-Util.addEventListener = function (inElement, inEventType, inCallback, inCaptures) {
-  if (inElement.addEventListener) {
-    // for DOM Level 2 browsers, like Firefox
-    inElement.addEventListener(inEventType, inCallback, inCaptures);
-  } else {
-    if (inElement.attachEvent) {
-      // for Internet Explorer
-      inElement.attachEvent(&quot;on&quot;+inEventType, inCallback, inCaptures);
-    }
-  } 
-};
-
-// -------------------------------------------------------------------
-// HTML document manipulation
-// -------------------------------------------------------------------
-
-/**
- * Looks at all the anchor links in the document, finds the ones with the 
- * attribute rel=&quot;external&quot;, and sets the target attribute of those anchor
- * links so that the links will open in a new browser window.  
- * 
- * @scope    public class method
- */
-Util.setTargetsForExternalLinks = function () {
-  if (!window.document.getElementsByTagName) {
-    return;
-  }
-  var listOfAnchorElements = window.document.getElementsByTagName(&quot;a&quot;);
-  var regExp = new RegExp(&quot;\\b&quot; + &quot;external&quot; + &quot;\\b&quot;);
-  for (var i=0; i&lt;listOfAnchorElements.length; i+=1) {
-    var anchor = listOfAnchorElements[i];
-    if (anchor.getAttribute(&quot;href&quot;) &amp;&amp; (anchor.getAttribute(&quot;rel&quot;)) &amp;&amp; (anchor.getAttribute(&quot;rel&quot;).search(regExp) != -1)) {
-      anchor.target = &quot;_blank&quot;;
-    }
-  }
-};
-
-// -------------------------------------------------------------------
-// End of file
-// -------------------------------------------------------------------

Deleted: trunk/source/view.js
===================================================================
--- trunk/source/view.js	2005-04-05 05:02:08 UTC (rev 20)
+++ trunk/source/view.js	2005-04-05 21:00:35 UTC (rev 21)
@@ -1,198 +0,0 @@
-/*****************************************************************************
- view.js
- 
-******************************************************************************
- Written in 2005 by Brian Douglas Skinner &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openrecord-svn">brian.skinner at gumption.org</A>&gt;
-  
- Copyright rights relinquished under the Creative Commons  
- Public Domain Dedication:
-    <A HREF="http://creativecommons.org/licenses/publicdomain/">http://creativecommons.org/licenses/publicdomain/</A>
-  
- You can copy freely from this file.  This work may be freely reproduced, 
- distributed, transmitted, used, modified, built upon, or otherwise exploited
- by anyone for any purpose.
-  
- This work is provided on an &quot;AS IS&quot; basis, without warranties or conditions 
- of any kind, either express or implied, including, without limitation, any 
- warranties or conditions of title, non-infringement, merchantability, or 
- fitness for a particular purpose. You are solely responsible for determining 
- the appropriateness of using or distributing the work and assume all risks 
- associated with use of this work, including but not limited to the risks and 
- costs of errors, compliance with applicable laws, damage to or loss of data 
- or equipment, and unavailability or interruption of operations.
-
- In no event shall the authors or contributors have any liability for any 
- direct, indirect, incidental, special, exemplary, or consequential damages,
- however caused and on any theory of liability, whether in contract, strict 
- liability, or tort (including negligence), arising in any way out of or in 
- connection with the use or distribution of the work.
-*****************************************************************************/
-
-
-// -------------------------------------------------------------------
-// Dependencies:
-//   util.js
-// -------------------------------------------------------------------
-
-
-/**
- * The View class serves as an abstract superclass for other view classes.
- *
- * @scope    public instance constructor
- * @syntax   DO NOT CALL THIS CONSTRUCTOR
- */
-function View() {
-  // alert(&quot;View constructor&quot;);
-  this._mySuperview = null;
-  this._myDivElement = null;
-}
-
-
-/**
- * Tells the View who its parent is in the view hierarchy.
- *
- * @scope    public instance method
- * @param    inSuperview    The superview for this view. 
- */
-View.prototype.setSuperview = function (inSuperview) {
-  // Util.assert(ViewInterface.isImplementedBy(inSuperview));
-
-  this._mySuperview = inSuperview;
-};
-
-
-/**
- * Returns the parent view in the view hierarchy.
- *
- * @scope    public instance method
- * @return   A View object. 
- */
-View.prototype.getSuperview = function () {
-  return this._mySuperview;
-};
-
-
-/**
- * Tells the View what HTMLDivElement to display itself in.
- *
- * @scope    public instance method
- * @param    inDivElement    The HTMLDivElement to display the view in. 
- */
-View.prototype.setDivElement = function (inDivElement) {
-  Util.assert(inDivElement instanceof HTMLDivElement);
-
-  this._myDivElement = inDivElement;
-  // this.display();
-};
-
-
-/**
- * Returns the HTMLDivElement that the view displays itself in.
- *
- * @scope    public instance method
- * @return   An HTMLDivElement. 
- */
-View.prototype.getDivElement = function () {
-  return this._myDivElement;
-};
-
-
-/**
- * Returns the Stevedore instance that this view is using.
- *
- * @scope    public instance method
- * @return   A Stevedore object. 
- */
-View.prototype.getStevedore = function () {
-  return this._mySuperview.getStevedore();
-};
-
-
-/**
- * Returns true if we are in Edit Mode.
- *
- * @scope    public instance method
- * @return   A boolean value. True if we are in Edit Mode.
- */
-View.prototype.isInEditMode = function () {
-  return this._mySuperview.isInEditMode();
-};
-
-
-/**
- * A toggle switch to set whether this view is drawn on-screen or hidden
- * off-screen.
- *
- * @scope    public instance method
- * @param    inBoolean    True if the view should be visible on screen. False if the view should be hidden off screen.
- */
-View.prototype.includeOnScreen = function (inBoolean) {
-  Util.assert(Util.isBoolean(inBoolean));
-
-  if (inBoolean) {
-    this.refresh();
-    this._myDivElement.style.display = &quot;block&quot;;
-  } else {
-    this._myDivElement.style.display = &quot;none&quot;;
-  }
-};
-
-
-// -------------------------------------------------------------------
-// HTML element helper methods
-// -------------------------------------------------------------------
-
-/**
- * Given an HTML element, we first call document.createElement() to 
- * create a new element, and then call appendChild() to add the new 
- * element to the given element.
- *
- * @scope    public class method
- * @param    inElement    The existing element that we should append the new element to. 
- * @param    inTagName    The HTML tag for the element (&quot;div&quot;, &quot;p&quot;, &quot;span&quot;, etc.). 
- * @param    inClassName    Optional. The HTML/CSS class to assign to the new element. 
- * @param    inId    Optional. The HTML id to assign to the new element. 
- * @return   The newly created HTML element.
- */
-View.createAndAppendElement = function (inElement, inTagName, inClassName, inId) {
-  Util.assert(inElement instanceof HTMLElement);
-  Util.assert(Util.isString(inTagName));
-  Util.assert(!inClassName || Util.isString(inClassName));
-  Util.assert(!inId || Util.isString(inId));
-
-  var newElement = window.document.createElement(inTagName);
-  if (inClassName) {
-    newElement.className = inClassName;
-  }
-  if (inId) {
-    newElement.id = inId;
-  }
-  inElement.appendChild(newElement);
-  return newElement;
-};
-
-
-/**
- * Given an HTML element, we first call document.createTextNode() to 
- * create a new text node, and then call appendChild() to add the new 
- * text node to the given element.
- *
- * @scope    public class method
- * @param    inElement    The existing element that we should append the new element to. 
- * @param    inText    The text string to put in the text node.
- * @return   The newly created text node.
- */
-View.createAndAppendTextNode = function (inElement, inText) {
-  Util.assert(inElement instanceof HTMLElement);
-  Util.assert(Util.isString(inText));
-
-  var newTextNode = window.document.createTextNode(inText);
-  inElement.appendChild(newTextNode);
-  return newTextNode;
-};
-
-
-// -------------------------------------------------------------------
-// End of file
-// -------------------------------------------------------------------
-


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000014.html">[openrecord-svn] r20 - trunk/source
</A></li>
	<LI>Next message: <A HREF="000016.html">[openrecord-svn] r22 - trunk/source
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15">[ date ]</a>
              <a href="thread.html#15">[ thread ]</a>
              <a href="subject.html#15">[ subject ]</a>
              <a href="author.html#15">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/openrecord-svn">More information about the openrecord-svn
mailing list</a><br>
</body></html>
