<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openrecord-svn] r148 - in trunk: documentation source source/model
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/openrecord-svn/2005-June/index.html" >
   <LINK REL="made" HREF="mailto:openrecord-svn%40lists.berlios.de?Subject=Re%3A%20%5Bopenrecord-svn%5D%20r148%20-%20in%20trunk%3A%20documentation%20source%20source/model&In-Reply-To=%3C200506162001.j5GK1Irp027981%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000133.html">
   <LINK REL="Next"  HREF="000135.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openrecord-svn] r148 - in trunk: documentation source source/model</H1>
    <B>Brian Douglas Skinner at BerliOS</B> 
    <A HREF="mailto:openrecord-svn%40lists.berlios.de?Subject=Re%3A%20%5Bopenrecord-svn%5D%20r148%20-%20in%20trunk%3A%20documentation%20source%20source/model&In-Reply-To=%3C200506162001.j5GK1Irp027981%40sheep.berlios.de%3E"
       TITLE="[openrecord-svn] r148 - in trunk: documentation source source/model">skinner at sheep.berlios.de
       </A><BR>
    <I>Thu Jun 16 22:01:18 CEST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="000133.html">[openrecord-svn] r147 - trunk/source
</A></li>
        <LI>Next message: <A HREF="000135.html">[openrecord-svn] r149 - in trunk/source: . model
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#134">[ date ]</a>
              <a href="thread.html#134">[ thread ]</a>
              <a href="subject.html#134">[ subject ]</a>
              <a href="author.html#134">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: skinner
Date: 2005-06-16 22:01:15 +0200 (Thu, 16 Jun 2005)
New Revision: 148

Added:
   trunk/source/model/ContentRecord.js
Removed:
   trunk/source/model/IdentifiedRecord.js
Modified:
   trunk/documentation/release_planning.txt
   trunk/source/LintTool.js
   trunk/source/Util.js
   trunk/source/demo_page.html
   trunk/source/model/DeltaVirtualServer.js
   trunk/source/model/Entry.js
   trunk/source/model/Item.js
   trunk/source/model/LintTest.js
   trunk/source/model/ModelTest.html
   trunk/source/model/Ordinal.js
   trunk/source/model/StubVirtualServer.js
   trunk/source/model/Vote.js
   trunk/source/model/World.js
Log:
Renamed IdentifiedRecord to be ContentRecord

Modified: trunk/documentation/release_planning.txt
===================================================================
--- trunk/documentation/release_planning.txt	2005-06-16 17:49:03 UTC (rev 147)
+++ trunk/documentation/release_planning.txt	2005-06-16 20:01:15 UTC (rev 148)
@@ -158,8 +158,8 @@
        |          |         |  1. Set up a prototype of the OpenRecord.org &quot;dogfood&quot; site
 mignon | 0.25 IED | 0.5 IED |  2. Have identifiedRecord.getUserstamp() get the user from the UUID
 mignon | 0.5  IED | 0.5 IED |  3. Switch data model to use time-based UUIDs for timestamps &amp; userstamps
-brian  | 0        | 0.25    |     Update the JSON repository file to use time-based UUIDs
-brian  | 0.5  IED | 0.5 IED |  4. Store transaction info in repository
+brian  | 0        | 0.5     |     Update the JSON repository file to use time-based UUIDs
+brian  | 0.5  IED | 0.25    |  4. Store transaction info in repository
        |          |         |  5. UI for deleting a row from a table
 brian  | 0.5  IED |         |  6. Save provisional item and then set the category, in that order, and in on transaction
        |          |         |  7. Fix the bug that happens when you call the PHP server code with no POST data

Modified: trunk/source/LintTool.js
===================================================================
--- trunk/source/LintTool.js	2005-06-16 17:49:03 UTC (rev 147)
+++ trunk/source/LintTool.js	2005-06-16 20:01:15 UTC (rev 148)
@@ -29,6 +29,11 @@
 *****************************************************************************/
  
 
+// -------------------------------------------------------------------
+// Dependencies, expressed in the syntax that JSLint understands:
+/*global Util, jslint */
+// -------------------------------------------------------------------
+
 /**
  * The LintTool class is just a thin wrapper around Douglas Crockford's
  * JSLint utility.

Modified: trunk/source/Util.js
===================================================================
--- trunk/source/Util.js	2005-06-16 17:49:03 UTC (rev 147)
+++ trunk/source/Util.js	2005-06-16 20:01:15 UTC (rev 148)
@@ -32,6 +32,11 @@
 *****************************************************************************/
  
 
+// -------------------------------------------------------------------
+// Dependencies, expressed in the syntax that JSLint understands:
+/*global window, document, hex_md5 */
+// -------------------------------------------------------------------
+
 /**
  * The Util class offers general utility methods that might
  * be useful in a wide variety of applications.
@@ -329,7 +334,7 @@
   if ((typeof inValue) != &quot;string&quot;) {
     return false;
   }
-  return (uuid.length == 36);  
+  return (inValue.length == 36);  
 };
 
 
@@ -365,7 +370,7 @@
 // -------------------------------------------------------------------
 
 Util.getArrayIndex = function(inArray, inElt) {
-  for (i=0; i&lt;inArray.length; ++i) {
+  for (var i=0; i&lt;inArray.length; ++i) {
     if (inArray[i] == inElt) {return i;}
   }
   return -1;
@@ -818,7 +823,7 @@
  * @return   A string containing the contents of the file.
  */
 Util.getStringContentsOfFileAtURL = function (inUrl) {
-  var anXMLHttpRequestObject = new XMLHttpRequest();
+  var anXMLHttpRequestObject = new window.XMLHttpRequest();
   anXMLHttpRequestObject.open(&quot;GET&quot;, inUrl, false);
   anXMLHttpRequestObject.send(null);
   var fileContents = anXMLHttpRequestObject.responseText;

Modified: trunk/source/demo_page.html
===================================================================
--- trunk/source/demo_page.html	2005-06-16 17:49:03 UTC (rev 147)
+++ trunk/source/demo_page.html	2005-06-16 20:01:15 UTC (rev 148)
@@ -34,7 +34,7 @@
 
     &lt;script type=&quot;text/javascript&quot; src=&quot;model/Ordinal.js&quot;&gt;&lt;/script&gt;
     &lt;script type=&quot;text/javascript&quot; src=&quot;model/Vote.js&quot;&gt;&lt;/script&gt;
-    &lt;script type=&quot;text/javascript&quot; src=&quot;model/IdentifiedRecord.js&quot;&gt;&lt;/script&gt;
+    &lt;script type=&quot;text/javascript&quot; src=&quot;model/ContentRecord.js&quot;&gt;&lt;/script&gt;
     &lt;script type=&quot;text/javascript&quot; src=&quot;model/Item.js&quot;&gt;&lt;/script&gt;
     &lt;script type=&quot;text/javascript&quot; src=&quot;model/Entry.js&quot;&gt;&lt;/script&gt;
     &lt;script type=&quot;text/javascript&quot; src=&quot;model/Transaction.js&quot;&gt;&lt;/script&gt;

Copied: trunk/source/model/ContentRecord.js (from rev 147, trunk/source/model/IdentifiedRecord.js)
===================================================================
--- trunk/source/model/IdentifiedRecord.js	2005-06-16 17:49:03 UTC (rev 147)
+++ trunk/source/model/ContentRecord.js	2005-06-16 20:01:15 UTC (rev 148)
@@ -0,0 +1,450 @@
+/*****************************************************************************
+ ContentRecord.js
+ 
+******************************************************************************
+ Written in 2005 by Brian Douglas Skinner &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openrecord-svn">brian.skinner at gumption.org</A>&gt;
+  
+ Copyright rights relinquished under the Creative Commons  
+ Public Domain Dedication:
+    <A HREF="http://creativecommons.org/licenses/publicdomain/">http://creativecommons.org/licenses/publicdomain/</A>
+  
+ You can copy freely from this file.  This work may be freely reproduced, 
+ distributed, transmitted, used, modified, built upon, or otherwise exploited
+ by anyone for any purpose.
+  
+ This work is provided on an &quot;AS IS&quot; basis, without warranties or conditions 
+ of any kind, either express or implied, including, without limitation, any 
+ warranties or conditions of title, non-infringement, merchantability, or 
+ fitness for a particular purpose. You are solely responsible for determining 
+ the appropriateness of using or distributing the work and assume all risks 
+ associated with use of this work, including but not limited to the risks and 
+ costs of errors, compliance with applicable laws, damage to or loss of data 
+ or equipment, and unavailability or interruption of operations.
+
+ In no event shall the authors or contributors have any liability for any 
+ direct, indirect, incidental, special, exemplary, or consequential damages,
+ however caused and on any theory of liability, whether in contract, strict 
+ liability, or tort (including negligence), arising in any way out of or in 
+ connection with the use or distribution of the work.
+*****************************************************************************/
+
+
+// -------------------------------------------------------------------
+// Dependencies:
+//   Vote.js
+//   Ordinal.js
+//   Util.js
+//   World.js
+// -------------------------------------------------------------------
+
+/**
+ * The ContentRecord class serves as an abstract superclass for the class Item
+ * and the class Entry.
+ *
+ * @scope    public instance constructor
+ * @syntax   DO NOT CALL THIS CONSTRUCTOR
+ */
+function ContentRecord() {
+}
+
+
+// -------------------------------------------------------------------
+// Protected methods
+// -------------------------------------------------------------------
+
+/**
+ * Called from the constructor function of each subclass of ContentRecord.
+ *
+ * @scope    protected instance method
+ * @param    inWorld    The world that this ContentRecord is a part of. 
+ * @param    inUuid    The UUID for this ContentRecord. 
+ */
+ContentRecord.prototype._ContentRecord = function (inWorld, inUuid) {
+  // Util.assert(!inUuid || Util.isNumeric(inUuid));
+  
+  this.__myWorld = inWorld;
+  this.__myUuid = inUuid;
+  
+  this.__myCreationTimestamp = null;
+  this.__myCreationUserstamp = null;
+
+  // Don't create these properties until we know we need them.
+  // this.__mySetOfVotes = null;
+  // this.__mySetOfOrdinals = null;
+};
+
+
+/**
+ * Initializes a new contentRecord that has just been created by a user action.
+ *
+ * WARNING: This method should be called ONLY from subclasses.
+ *
+ * @scope    protected instance method
+ */
+ContentRecord.prototype._initializeContentRecord = function () {
+};
+
+
+/**
+ * Sets the properties of a newly rehydrated contentRecord object.
+ *
+ * WARNING: This method should be called ONLY from subclasses.
+ *
+ * @scope    protected instance method
+ * @param    inTimestamp    A Date object with the creation timestamp for this item. 
+ * @param    inUserstamp    The user who created this item. 
+ */
+ContentRecord.prototype._rehydrateContentRecord = function (inTimestamp, inUserstamp) {
+  this.__myCreationTimestamp = inTimestamp;
+  this.__myCreationUserstamp = inUserstamp;
+};
+
+
+/**
+ * Returns the UUID of the item. 
+ *
+ * WARNING: This method should be called ONLY from a 
+ * VirtualServer implementation.
+ *
+ * If you're writing code in the view layer, call
+ * item.getUniqueKeyString() instead of item._getUuid();
+ *
+ * @scope    protected instance method
+ * @return   The UUID of the item.
+ */
+ContentRecord.prototype._getUuid = function () {
+  return this.__myUuid;
+};
+
+
+/**
+ * Records a user's vote to retain or delete this ContentRecord.
+ *
+ * @scope    protected instance method
+ * @param    inVote    A vote to retain or delete this ContentRecord. 
+ */
+ContentRecord.prototype._addVote = function (inVote) {
+  if (!this.__mySetOfVotes) {
+    this.__mySetOfVotes = [];
+  }
+  this.__mySetOfVotes.push(inVote);
+};
+
+
+/**
+ * Records the ordinal number that a user sets for this ContentRecord.
+ *
+ * @scope    protected instance method
+ * @param    inOrdinal    A vote to retain or delete this ContentRecord. 
+ */
+ContentRecord.prototype._addOrdinal = function (inOrdinal) {
+  if (!this.__mySetOfOrdinals) {
+    this.__mySetOfOrdinals = [];
+  }
+  this.__mySetOfOrdinals.push(inOrdinal);
+};
+
+
+// -------------------------------------------------------------------
+// Simple accessor methods
+// -------------------------------------------------------------------
+
+/**
+ * Returns the world that this item was created in.
+ *
+ * @scope    public instance method
+ * @return   A world object.
+ */
+ContentRecord.prototype.getWorld = function () {
+  return this.__myWorld;
+};
+
+
+/**
+ * Returns a Date object with the creation timestamp for this item.
+ *
+ * @scope    public instance method
+ * @return   A Date object.
+ */
+ContentRecord.prototype.getTimestamp = function() {
+  if (this.__myCreationTimestamp) {
+    // This case is now here only for the (temporary) benefit of _rehydrateContentRecord.
+    return this.__myCreationTimestamp;
+  }
+  var hexTimeLow = this.__myUuid.split('-')[0];
+  var hexTimeMid = this.__myUuid.split('-')[1];
+  var hexTimeHigh = this.__myUuid.split('-')[2];
+  var timeLow = parseInt(hexTimeLow, Util.HEX_RADIX);
+  var timeMid = parseInt(hexTimeMid, Util.HEX_RADIX);
+  var timeHigh = parseInt(hexTimeHigh, Util.HEX_RADIX);
+  var hundredNanosecondIntervalsSince1582 = timeHigh &amp; 0x0FFF;
+  hundredNanosecondIntervalsSince1582 &lt;&lt;= 16;
+  hundredNanosecondIntervalsSince1582 += timeMid;
+  // What we really want to do next is shift left 32 bits, but the result will be too big
+  // to fit in an int, so we'll multiply by 2^32, and the result will be a floating point approximation.
+  hundredNanosecondIntervalsSince1582 *= 0x100000000;
+  hundredNanosecondIntervalsSince1582 += timeLow;
+  var millisecondsSince1582 = hundredNanosecondIntervalsSince1582 / 10000;
+
+  // Again, this will be a floating point approximation.
+  // We can make things exact later if we need to.
+  var secondsPerHour = 60 * 60;
+  var hoursBetween1582and1970 = Util.GREGORIAN_CHANGE_OFFSET_IN_HOURS;
+  var secondsBetween1582and1970 = hoursBetween1582and1970 * secondsPerHour;
+  var millisecondsBetween1582and1970 = secondsBetween1582and1970 * 1000;
+
+  var millisecondsSince1970 = millisecondsSince1582 - millisecondsBetween1582and1970;
+  return millisecondsSince1970;
+};
+
+
+/**
+ * Returns the item representing the user who created this item.
+ *
+ * @scope    public instance method
+ * @return   A user item.
+ */
+ContentRecord.prototype.getUserstamp = function() {
+  if (this.__myCreationUserstamp) {
+    // This case is now here only for the (temporary) benefit of _rehydrateContentRecord.
+    return this.__myCreationUserstamp;
+  }
+  var allUsers = this.__myWorld.getUsers();
+  var myPseudonode = this.__myUuid.split('-')[4];
+  for (key in allUsers) {
+    var usersPseudonode = allUsers[key]._getUuid().split('-')[4];
+    if (usersPseudonode == myPseudonode) {
+      return allUsers[key];
+    }
+  }
+  throw new Error(&quot;User not found.  Database may be corrupted.&quot;);
+};
+
+
+/**
+ * Returns a string which can be used as a unique key in a hash table. 
+ *
+ * @scope    public instance method
+ * @return   A string which can serve as a unique key.
+ */
+ContentRecord.prototype.getUniqueKeyString = function () {
+  return this.__myUuid;
+};
+
+
+/**
+ * Returns the ordinal number that this contentRecord was given at creation. 
+ *
+ * @scope    public instance method
+ * @return   A number.
+ */
+ContentRecord.prototype.getOrdinalNumberAtCreation = function () {
+  // return (0 - this.__myCreationTimestamp.valueOf());
+  return (0 - this.__myUuid);
+};
+
+
+// -------------------------------------------------------------------
+// Accessor methods
+// -------------------------------------------------------------------
+
+/**
+ * Returns the ordinal number for this contentRecord. 
+ *
+ * @scope    public instance method
+ * @return   A number.
+ */
+ContentRecord.prototype.getOrdinalNumber = function () {
+  if (!this.__mySetOfOrdinals || this.__mySetOfOrdinals.length === 0) {
+    return this.getOrdinalNumberAtCreation();
+  }
+
+  var ordinalNumber = this.getOrdinalNumberAtCreation();
+  var key;
+  var ordinal;
+  var filter = this.__myWorld.getRetrievalFilter();
+  
+  switch (filter) {
+    case World.RETRIEVAL_FILTER_LAST_EDIT_WINS:
+      // APPROACH A: 
+      //   I tried this first, but it fails in the unit tests.
+      //   It fails because two objects will have identical timestamps if they
+      //   were created in the same millisecond.  One solution would be to
+      //   create a Timestamp class that offers sub-millisecond timestamp
+      //   resolution.  For example, see scrap_yard/Timestamp.js.  However,
+      //   for now the simplest thing to do is just move on to APPROACH B:
+      /*
+      var mostRecentOrdinal = this.__mySetOfOrdinals[0];
+      for (key in this.__mySetOfOrdinals) {
+        ordinal = this.__mySetOfOrdinals[key];
+        if (ordinal.getTimestamp() &gt; mostRecentOrdinal.getTimestamp()) {
+          mostRecentOrdinal = ordinal;
+        }
+      }
+      */
+      
+      // APPROACH B: 
+      //   This works, provided __mySetOfOrdinals is always initialized in
+      //   chronological order.
+      var mostRecentOrdinal = this.__mySetOfOrdinals[this.__mySetOfOrdinals.length - 1];
+
+      ordinalNumber = mostRecentOrdinal.getOrdinalNumber();
+      break;
+    case World.RETRIEVAL_FILTER_SINGLE_USER:
+      // PENDING: This still needs to be implemented.
+      Util.assert(false);
+      break;
+    case World.RETRIEVAL_FILTER_DEMOCRATIC:
+      // PENDING: This still needs to be implemented.
+      Util.assert(false);
+      break;
+    case World.RETRIEVAL_FILTER_UNABRIDGED:
+      // PENDING: This still needs to be implemented.
+      Util.assert(false);
+      break;
+    default:
+      // We should never get here.  If we get here, it's an error.
+      Util.assert(false);
+      break;
+  }
+  return ordinalNumber;
+};
+
+
+/**
+ * Returns true if this contentRecord has been deleted. 
+ *
+ * @scope    public instance method
+ * @return   A boolean.
+ */
+ContentRecord.prototype.hasBeenDeleted = function () {
+  if (!this.__mySetOfVotes || this.__mySetOfVotes.length === 0) {
+    return false;
+  }
+  
+  var hasBeenDeleted = false;
+  var key;
+  var vote;
+  var filter = this.__myWorld.getRetrievalFilter();
+  
+  switch (filter) {
+    case World.RETRIEVAL_FILTER_LAST_EDIT_WINS:
+      // APPROACH A: 
+      //   I tried this first, but it fails in the unit tests.
+      //   It fails because two objects will have identical timestamps if they
+      //   were created in the same millisecond.  One solution would be to
+      //   create a Timestamp class that offers sub-millisecond timestamp
+      //   resolution.  For example, see scrap_yard/Timestamp.js.  However,
+      //   for now the simplest thing to do is just move on to APPROACH B:
+      /*
+      var mostRecentVote = this.__mySetOfVotes[0];
+      for (key in this.__mySetOfVotes) {
+        vote = this.__mySetOfVotes[key];
+        if (vote.getTimestamp() &gt; mostRecentVote.getTimestamp()) {
+          mostRecentVote = vote;
+        }
+      }
+      */
+      
+      // APPROACH B: 
+      //   This works, provided __mySetOfVotes is always initialized in
+      //   chronological order.
+      var mostRecentVote = this.__mySetOfVotes[this.__mySetOfVotes.length - 1];
+      
+      hasBeenDeleted = !mostRecentVote.getRetainFlag();
+      break;
+    case World.RETRIEVAL_FILTER_SINGLE_USER:
+      // PENDING: This still needs to be implemented.
+      Util.assert(false);
+      break;
+    case World.RETRIEVAL_FILTER_DEMOCRATIC:
+      // PENDING: This still needs to be implemented.
+      Util.assert(false);
+      break;
+    case World.RETRIEVAL_FILTER_UNABRIDGED:
+      hasBeenDeleted = false;
+      break;
+    default:
+      // We should never get here.  If we get here, it's an error.
+      Util.assert(false);
+      break;
+  }
+  return hasBeenDeleted;
+};
+
+
+/**
+ * Moves this contentRecord to a new position in a list, by creating a new
+ * ordinal for this contentRecord with an ordinal number that is set such
+ * that this contentRecord appears between two other entries.
+ *
+ * @scope    public instance method
+ * @param    inContentRecordFirst    The contentRecord that should come before this one. 
+ * @param    inContentRecordThird    The contentRecord that should come after this one. 
+ */
+ContentRecord.prototype.reorderBetween = function (inContentRecordFirst, inContentRecordThird) {
+  var firstOrdinalNumber = null;
+  var secondOrdinalNumber = null;
+  var thirdOrdinalNumber = null;
+  var arbitraryNumberToMoveUsUpOrDownSlightly = 0.01;
+  
+  if (inContentRecordFirst) {
+    firstOrdinalNumber = inContentRecordFirst.getOrdinalNumber();
+  }
+  if (inContentRecordThird) {
+    thirdOrdinalNumber = inContentRecordThird.getOrdinalNumber();
+  }
+  
+  if (firstOrdinalNumber &amp;&amp; thirdOrdinalNumber) {
+    secondOrdinalNumber = (firstOrdinalNumber + thirdOrdinalNumber) / 2;
+  }
+  if (firstOrdinalNumber &amp;&amp; !thirdOrdinalNumber) {
+    secondOrdinalNumber = (firstOrdinalNumber - arbitraryNumberToMoveUsUpOrDownSlightly);
+  }
+  if (!firstOrdinalNumber &amp;&amp; thirdOrdinalNumber) {
+    secondOrdinalNumber = (firstOrdinalNumber + arbitraryNumberToMoveUsUpOrDownSlightly);
+  }
+
+  this.getWorld()._newOrdinal(this, secondOrdinalNumber);
+};
+
+
+/**
+ * Registers a vote to delete this contentRecord. 
+ *
+ * @scope    public instance method
+ */
+ContentRecord.prototype.voteToDelete = function () {
+  this.getWorld()._newVote(this, false);
+};
+
+
+/**
+ * Registers a vote to retain this contentRecord. 
+ *
+ * @scope    public instance method
+ */
+ContentRecord.prototype.voteToRetain = function () {
+  this.getWorld()._newVote(this, true);
+};
+
+
+// -------------------------------------------------------------------
+// Class methods
+// -------------------------------------------------------------------
+
+/**
+ * Registers a vote to retain this contentRecord. 
+ *
+ * @scope    public class method
+ */
+ContentRecord.compareOrdinals = function (inContentRecordOne, inContentRecordTwo) {
+  var ordinalNumberOne = inContentRecordOne.getOrdinalNumber();
+  var ordinalNumberTwo = inContentRecordTwo.getOrdinalNumber();
+  return (ordinalNumberTwo - ordinalNumberOne);
+};
+
+
+// -------------------------------------------------------------------
+// End of file
+// -------------------------------------------------------------------

Modified: trunk/source/model/DeltaVirtualServer.js
===================================================================
--- trunk/source/model/DeltaVirtualServer.js	2005-06-16 17:49:03 UTC (rev 147)
+++ trunk/source/model/DeltaVirtualServer.js	2005-06-16 20:01:15 UTC (rev 148)
@@ -225,8 +225,8 @@
   var key;
   var itemUuid;
   var item;
-  var identifiedRecordUuid;
-  var identifiedRecord;
+  var contentRecordUuid;
+  var contentRecord;
   
   for (key in inListOfRecords) {
     var dehydratedRecord = inListOfRecords[key];
@@ -258,16 +258,16 @@
       }
       if (dehydratedVote) {
         var retainFlag = dehydratedVote[DeltaVirtualServer.JSON_MEMBER_RETAIN_FLAG];
-        identifiedRecordUuid = dehydratedVote[DeltaVirtualServer.JSON_MEMBER_RECORD];
-        identifiedRecord = this._getIdentifiedRecordFromUuid(identifiedRecordUuid);
-        var vote = new Vote(identifiedRecord, userstamp, retainFlag, timestamp);
+        contentRecordUuid = dehydratedVote[DeltaVirtualServer.JSON_MEMBER_RECORD];
+        contentRecord = this._getContentRecordFromUuid(contentRecordUuid);
+        var vote = new Vote(contentRecord, userstamp, retainFlag, timestamp);
         this.__myChronologicalListOfRecords.push(vote);
       }
       if (dehydratedOrdinal) {
         var ordinalNumber = dehydratedVote[DeltaVirtualServer.JSON_MEMBER_ORDINAL_NUMBER];
-        identifiedRecordUuid = dehydratedVote[DeltaVirtualServer.JSON_MEMBER_RECORD];
-        identifiedRecord = this._getIdentifiedRecordFromUuid(identifiedRecordUuid);
-        var ordinal = new Ordinal(identifiedRecord, userstamp, ordinalNumber, timestamp);
+        contentRecordUuid = dehydratedVote[DeltaVirtualServer.JSON_MEMBER_RECORD];
+        contentRecord = this._getContentRecordFromUuid(contentRecordUuid);
+        var ordinal = new Ordinal(contentRecord, userstamp, ordinalNumber, timestamp);
         this.__myChronologicalListOfRecords.push(ordinal);
       }
       if (dehydratedEntry) {
@@ -434,13 +434,13 @@
   var indent = inIndent || &quot;&quot;;
   var key;
   var listOfStrings = [];
-  var firstIdentifiedRecord = true;
+  var firstContentRecord = true;
   var itemDisplayNameSubstring;
 
   for (key in inListOfRecords) {
     var record = inListOfRecords[key];
-    if (firstIdentifiedRecord) {
-      firstIdentifiedRecord = false;
+    if (firstContentRecord) {
+      firstContentRecord = false;
     } else {
       listOfStrings.push(',\n');
     }
@@ -455,13 +455,13 @@
     if (record instanceof Vote) {
       var vote = record;
       listOfStrings.push(indent + '{ &quot;' + DeltaVirtualServer.JSON_MEMBER_VOTE_CLASS + '&quot;: ' + '{' + '\n');
-      listOfStrings.push(indent + '    &quot;' + DeltaVirtualServer.JSON_MEMBER_RECORD + '&quot;: &quot;' + vote.getIdentifiedRecord()._getUuid() + '&quot;,\n');
+      listOfStrings.push(indent + '    &quot;' + DeltaVirtualServer.JSON_MEMBER_RECORD + '&quot;: &quot;' + vote.getContentRecord()._getUuid() + '&quot;,\n');
       listOfStrings.push(indent + '    &quot;' + DeltaVirtualServer.JSON_MEMBER_RETAIN_FLAG + '&quot;: &quot;' + vote.getRetainFlag() + '&quot;');
     }
     if (record instanceof Ordinal) {
       var ordinal = record;
       listOfStrings.push(indent + '{ &quot;' + DeltaVirtualServer.JSON_MEMBER_ORDINAL_CLASS + '&quot;: ' + '{' + '\n');
-      listOfStrings.push(indent + '    &quot;' + DeltaVirtualServer.JSON_MEMBER_RECORD + '&quot;: &quot;' + ordinal.getIdentifiedRecord()._getUuid() + '&quot;,\n');
+      listOfStrings.push(indent + '    &quot;' + DeltaVirtualServer.JSON_MEMBER_RECORD + '&quot;: &quot;' + ordinal.getContentRecord()._getUuid() + '&quot;,\n');
       listOfStrings.push(indent + '    &quot;' + DeltaVirtualServer.JSON_MEMBER_ORDINAL_NUMBER + '&quot;: &quot;' + ordinal.getOrdinalNumber() + '&quot;');
     }
     if (record instanceof Entry) {
@@ -542,11 +542,11 @@
   }
   
   listOfStrings.push('  &quot;' + DeltaVirtualServer.JSON_MEMBER_USERS + '&quot;: ' + '[\n');
-  var firstIdentifiedRecord = true;
+  var firstContentRecord = true;
   for (key in this.__myListOfUsers) {
     var user = this.__myListOfUsers[key];
-    if (firstIdentifiedRecord) {
-      firstIdentifiedRecord = false;
+    if (firstContentRecord) {
+      firstContentRecord = false;
     } else {
       listOfStrings.push(',\n');
     }

Modified: trunk/source/model/Entry.js
===================================================================
--- trunk/source/model/Entry.js	2005-06-16 17:49:03 UTC (rev 147)
+++ trunk/source/model/Entry.js	2005-06-16 20:01:15 UTC (rev 148)
@@ -34,7 +34,7 @@
 //   Util.js
 //   Item.js
 //   World.js
-//   IdentifiedRecord.js
+//   ContentRecord.js
 // -------------------------------------------------------------------
 
 /**
@@ -51,9 +51,9 @@
  * @param    inWorld    The world that this entry is a part of. 
  * @param    inUuid    The UUID for this entry. 
  */
-Entry.prototype = new IdentifiedRecord();  // makes Entry be a subclass of IdentifiedRecord
+Entry.prototype = new ContentRecord();  // makes Entry be a subclass of ContentRecord
 function Entry(inWorld, inUuid) {
-  this._IdentifiedRecord(inWorld, inUuid);
+  this._ContentRecord(inWorld, inUuid);
  
   this.__myPreviousEntry = null;
   this.__myListOfSubsequentEntries = [];
@@ -82,7 +82,7 @@
 * @param    inType    Optional.  The data type to interpret the value as. 
  */
 Entry.prototype._initialize = function (inItemOrEntry, inAttribute, inValue, inType) {
-  this._initializeIdentifiedRecord();
+  this._initializeContentRecord();
 
   if (inItemOrEntry instanceof Entry) {
     this.__myPreviousEntry = inItemOrEntry;
@@ -138,7 +138,7 @@
  * @param    inUserstamp    The user who created this entry. 
  */
 Entry.prototype._rehydrate = function (inItemOrEntry, inAttribute, inValue, inTimestamp, inUserstamp, inType) {
-  this._rehydrateIdentifiedRecord(inTimestamp, inUserstamp);
+  this._rehydrateContentRecord(inTimestamp, inUserstamp);
 
   if (inItemOrEntry instanceof Entry) {
     this.__myPreviousEntry = inItemOrEntry;

Deleted: trunk/source/model/IdentifiedRecord.js
===================================================================
--- trunk/source/model/IdentifiedRecord.js	2005-06-16 17:49:03 UTC (rev 147)
+++ trunk/source/model/IdentifiedRecord.js	2005-06-16 20:01:15 UTC (rev 148)
@@ -1,450 +0,0 @@
-/*****************************************************************************
- IdentifiedRecord.js
- 
-******************************************************************************
- Written in 2005 by Brian Douglas Skinner &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openrecord-svn">brian.skinner at gumption.org</A>&gt;
-  
- Copyright rights relinquished under the Creative Commons  
- Public Domain Dedication:
-    <A HREF="http://creativecommons.org/licenses/publicdomain/">http://creativecommons.org/licenses/publicdomain/</A>
-  
- You can copy freely from this file.  This work may be freely reproduced, 
- distributed, transmitted, used, modified, built upon, or otherwise exploited
- by anyone for any purpose.
-  
- This work is provided on an &quot;AS IS&quot; basis, without warranties or conditions 
- of any kind, either express or implied, including, without limitation, any 
- warranties or conditions of title, non-infringement, merchantability, or 
- fitness for a particular purpose. You are solely responsible for determining 
- the appropriateness of using or distributing the work and assume all risks 
- associated with use of this work, including but not limited to the risks and 
- costs of errors, compliance with applicable laws, damage to or loss of data 
- or equipment, and unavailability or interruption of operations.
-
- In no event shall the authors or contributors have any liability for any 
- direct, indirect, incidental, special, exemplary, or consequential damages,
- however caused and on any theory of liability, whether in contract, strict 
- liability, or tort (including negligence), arising in any way out of or in 
- connection with the use or distribution of the work.
-*****************************************************************************/
-
-
-// -------------------------------------------------------------------
-// Dependencies:
-//   Vote.js
-//   Ordinal.js
-//   Util.js
-//   World.js
-// -------------------------------------------------------------------
-
-/**
- * The IdentifiedRecord class serves as an abstract superclass for the class Item
- * and the class Entry.
- *
- * @scope    public instance constructor
- * @syntax   DO NOT CALL THIS CONSTRUCTOR
- */
-function IdentifiedRecord() {
-}
-
-
-// -------------------------------------------------------------------
-// Protected methods
-// -------------------------------------------------------------------
-
-/**
- * Called from the constructor function of each subclass of IdentifiedRecord.
- *
- * @scope    protected instance method
- * @param    inWorld    The world that this IdentifiedRecord is a part of. 
- * @param    inUuid    The UUID for this IdentifiedRecord. 
- */
-IdentifiedRecord.prototype._IdentifiedRecord = function (inWorld, inUuid) {
-  // Util.assert(!inUuid || Util.isNumeric(inUuid));
-  
-  this.__myWorld = inWorld;
-  this.__myUuid = inUuid;
-  
-  this.__myCreationTimestamp = null;
-  this.__myCreationUserstamp = null;
-
-  // Don't create these properties until we know we need them.
-  // this.__mySetOfVotes = null;
-  // this.__mySetOfOrdinals = null;
-};
-
-
-/**
- * Initializes a new identifiedRecord that has just been created by a user action.
- *
- * WARNING: This method should be called ONLY from subclasses.
- *
- * @scope    protected instance method
- */
-IdentifiedRecord.prototype._initializeIdentifiedRecord = function () {
-};
-
-
-/**
- * Sets the properties of a newly rehydrated identifiedRecord object.
- *
- * WARNING: This method should be called ONLY from subclasses.
- *
- * @scope    protected instance method
- * @param    inTimestamp    A Date object with the creation timestamp for this item. 
- * @param    inUserstamp    The user who created this item. 
- */
-IdentifiedRecord.prototype._rehydrateIdentifiedRecord = function (inTimestamp, inUserstamp) {
-  this.__myCreationTimestamp = inTimestamp;
-  this.__myCreationUserstamp = inUserstamp;
-};
-
-
-/**
- * Returns the UUID of the item. 
- *
- * WARNING: This method should be called ONLY from a 
- * VirtualServer implementation.
- *
- * If you're writing code in the view layer, call
- * item.getUniqueKeyString() instead of item._getUuid();
- *
- * @scope    protected instance method
- * @return   The UUID of the item.
- */
-IdentifiedRecord.prototype._getUuid = function () {
-  return this.__myUuid;
-};
-
-
-/**
- * Records a user's vote to retain or delete this IdentifiedRecord.
- *
- * @scope    protected instance method
- * @param    inVote    A vote to retain or delete this IdentifiedRecord. 
- */
-IdentifiedRecord.prototype._addVote = function (inVote) {
-  if (!this.__mySetOfVotes) {
-    this.__mySetOfVotes = [];
-  }
-  this.__mySetOfVotes.push(inVote);
-};
-
-
-/**
- * Records the ordinal number that a user sets for this IdentifiedRecord.
- *
- * @scope    protected instance method
- * @param    inOrdinal    A vote to retain or delete this IdentifiedRecord. 
- */
-IdentifiedRecord.prototype._addOrdinal = function (inOrdinal) {
-  if (!this.__mySetOfOrdinals) {
-    this.__mySetOfOrdinals = [];
-  }
-  this.__mySetOfOrdinals.push(inOrdinal);
-};
-
-
-// -------------------------------------------------------------------
-// Simple accessor methods
-// -------------------------------------------------------------------
-
-/**
- * Returns the world that this item was created in.
- *
- * @scope    public instance method
- * @return   A world object.
- */
-IdentifiedRecord.prototype.getWorld = function () {
-  return this.__myWorld;
-};
-
-
-/**
- * Returns a Date object with the creation timestamp for this item.
- *
- * @scope    public instance method
- * @return   A Date object.
- */
-IdentifiedRecord.prototype.getTimestamp = function() {
-  if (this.__myCreationTimestamp) {
-    // This case is now here only for the (temporary) benefit of _rehydrateIdentifiedRecord.
-    return this.__myCreationTimestamp;
-  }
-  var hexTimeLow = this.__myUuid.split('-')[0];
-  var hexTimeMid = this.__myUuid.split('-')[1];
-  var hexTimeHigh = this.__myUuid.split('-')[2];
-  var timeLow = parseInt(hexTimeLow, Util.HEX_RADIX);
-  var timeMid = parseInt(hexTimeMid, Util.HEX_RADIX);
-  var timeHigh = parseInt(hexTimeHigh, Util.HEX_RADIX);
-  var hundredNanosecondIntervalsSince1582 = timeHigh &amp; 0x0FFF;
-  hundredNanosecondIntervalsSince1582 &lt;&lt;= 16;
-  hundredNanosecondIntervalsSince1582 += timeMid;
-  // What we really want to do next is shift left 32 bits, but the result will be too big
-  // to fit in an int, so we'll multiply by 2^32, and the result will be a floating point approximation.
-  hundredNanosecondIntervalsSince1582 *= 0x100000000;
-  hundredNanosecondIntervalsSince1582 += timeLow;
-  var millisecondsSince1582 = hundredNanosecondIntervalsSince1582 / 10000;
-
-  // Again, this will be a floating point approximation.
-  // We can make things exact later if we need to.
-  var secondsPerHour = 60 * 60;
-  var hoursBetween1582and1970 = Util.GREGORIAN_CHANGE_OFFSET_IN_HOURS;
-  var secondsBetween1582and1970 = hoursBetween1582and1970 * secondsPerHour;
-  var millisecondsBetween1582and1970 = secondsBetween1582and1970 * 1000;
-
-  var millisecondsSince1970 = millisecondsSince1582 - millisecondsBetween1582and1970;
-  return millisecondsSince1970;
-};
-
-
-/**
- * Returns the item representing the user who created this item.
- *
- * @scope    public instance method
- * @return   A user item.
- */
-IdentifiedRecord.prototype.getUserstamp = function() {
-  if (this.__myCreationUserstamp) {
-    // This case is now here only for the (temporary) benefit of _rehydrateIdentifiedRecord.
-    return this.__myCreationUserstamp;
-  }
-  var allUsers = this.__myWorld.getUsers();
-  var myPseudonode = this.__myUuid.split('-')[4];
-  for (key in allUsers) {
-    var usersPseudonode = allUsers[key]._getUuid().split('-')[4];
-    if (usersPseudonode == myPseudonode) {
-      return allUsers[key];
-    }
-  }
-  throw new Error(&quot;User not found.  Database may be corrupted.&quot;);
-};
-
-
-/**
- * Returns a string which can be used as a unique key in a hash table. 
- *
- * @scope    public instance method
- * @return   A string which can serve as a unique key.
- */
-IdentifiedRecord.prototype.getUniqueKeyString = function () {
-  return this.__myUuid;
-};
-
-
-/**
- * Returns the ordinal number that this identifiedRecord was given at creation. 
- *
- * @scope    public instance method
- * @return   A number.
- */
-IdentifiedRecord.prototype.getOrdinalNumberAtCreation = function () {
-  // return (0 - this.__myCreationTimestamp.valueOf());
-  return (0 - this.__myUuid);
-};
-
-
-// -------------------------------------------------------------------
-// Accessor methods
-// -------------------------------------------------------------------
-
-/**
- * Returns the ordinal number for this identifiedRecord. 
- *
- * @scope    public instance method
- * @return   A number.
- */
-IdentifiedRecord.prototype.getOrdinalNumber = function () {
-  if (!this.__mySetOfOrdinals || this.__mySetOfOrdinals.length === 0) {
-    return this.getOrdinalNumberAtCreation();
-  }
-
-  var ordinalNumber = this.getOrdinalNumberAtCreation();
-  var key;
-  var ordinal;
-  var filter = this.__myWorld.getRetrievalFilter();
-  
-  switch (filter) {
-    case World.RETRIEVAL_FILTER_LAST_EDIT_WINS:
-      // APPROACH A: 
-      //   I tried this first, but it fails in the unit tests.
-      //   It fails because two objects will have identical timestamps if they
-      //   were created in the same millisecond.  One solution would be to
-      //   create a Timestamp class that offers sub-millisecond timestamp
-      //   resolution.  For example, see scrap_yard/Timestamp.js.  However,
-      //   for now the simplest thing to do is just move on to APPROACH B:
-      /*
-      var mostRecentOrdinal = this.__mySetOfOrdinals[0];
-      for (key in this.__mySetOfOrdinals) {
-        ordinal = this.__mySetOfOrdinals[key];
-        if (ordinal.getTimestamp() &gt; mostRecentOrdinal.getTimestamp()) {
-          mostRecentOrdinal = ordinal;
-        }
-      }
-      */
-      
-      // APPROACH B: 
-      //   This works, provided __mySetOfOrdinals is always initialized in
-      //   chronological order.
-      var mostRecentOrdinal = this.__mySetOfOrdinals[this.__mySetOfOrdinals.length - 1];
-
-      ordinalNumber = mostRecentOrdinal.getOrdinalNumber();
-      break;
-    case World.RETRIEVAL_FILTER_SINGLE_USER:
-      // PENDING: This still needs to be implemented.
-      Util.assert(false);
-      break;
-    case World.RETRIEVAL_FILTER_DEMOCRATIC:
-      // PENDING: This still needs to be implemented.
-      Util.assert(false);
-      break;
-    case World.RETRIEVAL_FILTER_UNABRIDGED:
-      // PENDING: This still needs to be implemented.
-      Util.assert(false);
-      break;
-    default:
-      // We should never get here.  If we get here, it's an error.
-      Util.assert(false);
-      break;
-  }
-  return ordinalNumber;
-};
-
-
-/**
- * Returns true if this identifiedRecord has been deleted. 
- *
- * @scope    public instance method
- * @return   A boolean.
- */
-IdentifiedRecord.prototype.hasBeenDeleted = function () {
-  if (!this.__mySetOfVotes || this.__mySetOfVotes.length === 0) {
-    return false;
-  }
-  
-  var hasBeenDeleted = false;
-  var key;
-  var vote;
-  var filter = this.__myWorld.getRetrievalFilter();
-  
-  switch (filter) {
-    case World.RETRIEVAL_FILTER_LAST_EDIT_WINS:
-      // APPROACH A: 
-      //   I tried this first, but it fails in the unit tests.
-      //   It fails because two objects will have identical timestamps if they
-      //   were created in the same millisecond.  One solution would be to
-      //   create a Timestamp class that offers sub-millisecond timestamp
-      //   resolution.  For example, see scrap_yard/Timestamp.js.  However,
-      //   for now the simplest thing to do is just move on to APPROACH B:
-      /*
-      var mostRecentVote = this.__mySetOfVotes[0];
-      for (key in this.__mySetOfVotes) {
-        vote = this.__mySetOfVotes[key];
-        if (vote.getTimestamp() &gt; mostRecentVote.getTimestamp()) {
-          mostRecentVote = vote;
-        }
-      }
-      */
-      
-      // APPROACH B: 
-      //   This works, provided __mySetOfVotes is always initialized in
-      //   chronological order.
-      var mostRecentVote = this.__mySetOfVotes[this.__mySetOfVotes.length - 1];
-      
-      hasBeenDeleted = !mostRecentVote.getRetainFlag();
-      break;
-    case World.RETRIEVAL_FILTER_SINGLE_USER:
-      // PENDING: This still needs to be implemented.
-      Util.assert(false);
-      break;
-    case World.RETRIEVAL_FILTER_DEMOCRATIC:
-      // PENDING: This still needs to be implemented.
-      Util.assert(false);
-      break;
-    case World.RETRIEVAL_FILTER_UNABRIDGED:
-      hasBeenDeleted = false;
-      break;
-    default:
-      // We should never get here.  If we get here, it's an error.
-      Util.assert(false);
-      break;
-  }
-  return hasBeenDeleted;
-};
-
-
-/**
- * Moves this identifiedRecord to a new position in a list, by creating a new
- * ordinal for this identifiedRecord with an ordinal number that is set such
- * that this identifiedRecord appears between two other entries.
- *
- * @scope    public instance method
- * @param    inIdentifiedRecordFirst    The identifiedRecord that should come before this one. 
- * @param    inIdentifiedRecordThird    The identifiedRecord that should come after this one. 
- */
-IdentifiedRecord.prototype.reorderBetween = function (inIdentifiedRecordFirst, inIdentifiedRecordThird) {
-  var firstOrdinalNumber = null;
-  var secondOrdinalNumber = null;
-  var thirdOrdinalNumber = null;
-  var arbitraryNumberToMoveUsUpOrDownSlightly = 0.01;
-  
-  if (inIdentifiedRecordFirst) {
-    firstOrdinalNumber = inIdentifiedRecordFirst.getOrdinalNumber();
-  }
-  if (inIdentifiedRecordThird) {
-    thirdOrdinalNumber = inIdentifiedRecordThird.getOrdinalNumber();
-  }
-  
-  if (firstOrdinalNumber &amp;&amp; thirdOrdinalNumber) {
-    secondOrdinalNumber = (firstOrdinalNumber + thirdOrdinalNumber) / 2;
-  }
-  if (firstOrdinalNumber &amp;&amp; !thirdOrdinalNumber) {
-    secondOrdinalNumber = (firstOrdinalNumber - arbitraryNumberToMoveUsUpOrDownSlightly);
-  }
-  if (!firstOrdinalNumber &amp;&amp; thirdOrdinalNumber) {
-    secondOrdinalNumber = (firstOrdinalNumber + arbitraryNumberToMoveUsUpOrDownSlightly);
-  }
-
-  this.getWorld()._newOrdinal(this, secondOrdinalNumber);
-};
-
-
-/**
- * Registers a vote to delete this identifiedRecord. 
- *
- * @scope    public instance method
- */
-IdentifiedRecord.prototype.voteToDelete = function () {
-  this.getWorld()._newVote(this, false);
-};
-
-
-/**
- * Registers a vote to retain this identifiedRecord. 
- *
- * @scope    public instance method
- */
-IdentifiedRecord.prototype.voteToRetain = function () {
-  this.getWorld()._newVote(this, true);
-};
-
-
-// -------------------------------------------------------------------
-// Class methods
-// -------------------------------------------------------------------
-
-/**
- * Registers a vote to retain this identifiedRecord. 
- *
- * @scope    public class method
- */
-IdentifiedRecord.compareOrdinals = function (inIdentifiedRecordOne, inIdentifiedRecordTwo) {
-  var ordinalNumberOne = inIdentifiedRecordOne.getOrdinalNumber();
-  var ordinalNumberTwo = inIdentifiedRecordTwo.getOrdinalNumber();
-  return (ordinalNumberTwo - ordinalNumberOne);
-};
-
-
-// -------------------------------------------------------------------
-// End of file
-// -------------------------------------------------------------------

Modified: trunk/source/model/Item.js
===================================================================
--- trunk/source/model/Item.js	2005-06-16 17:49:03 UTC (rev 147)
+++ trunk/source/model/Item.js	2005-06-16 20:01:15 UTC (rev 148)
@@ -34,7 +34,7 @@
 //   Util.js
 //   World.js
 //   Entry.js
-//   IdentifiedRecord.js
+//   ContentRecord.js
 // -------------------------------------------------------------------
 
 
@@ -52,9 +52,9 @@
  * @param    inWorld    The world that this item is a part of. 
  * @param    inUuid    The UUID for this item. 
  */
-Item.prototype = new IdentifiedRecord();  // makes Item be a subclass of IdentifiedRecord
+Item.prototype = new ContentRecord();  // makes Item be a subclass of ContentRecord
 function Item(inWorld, inUuid) {
-  this._IdentifiedRecord(inWorld, inUuid);
+  this._ContentRecord(inWorld, inUuid);
   
   this.__myHashTableOfEntryListsKeyedByAttributeUuid = {};
   this.__myProvisionalFlag = false;
@@ -76,7 +76,7 @@
  * @param    inProvisionalFlag    True if the item is provisional; false if the item is normal. 
  */
 Item.prototype._initialize = function (inObserver, inProvisionalFlag) {
-  this._initializeIdentifiedRecord();
+  this._initializeContentRecord();
 
   if (inProvisionalFlag) {
     this.__myProvisionalFlag = true;
@@ -102,7 +102,7 @@
  */
 Item.prototype._rehydrate = function (inTimestamp, inUserstamp) {
   this.__myProvisionalFlag = false;
-  this._rehydrateIdentifiedRecord(inTimestamp, inUserstamp);
+  this._rehydrateContentRecord(inTimestamp, inUserstamp);
 };
 
 
@@ -261,7 +261,7 @@
       Util.assert(false);
       break;
   }
-  filteredListOfEntries.sort(IdentifiedRecord.compareOrdinals);
+  filteredListOfEntries.sort(ContentRecord.compareOrdinals);
   return filteredListOfEntries;
 };
 

Modified: trunk/source/model/LintTest.js
===================================================================
--- trunk/source/model/LintTest.js	2005-06-16 17:49:03 UTC (rev 147)
+++ trunk/source/model/LintTest.js	2005-06-16 20:01:15 UTC (rev 148)
@@ -36,7 +36,7 @@
   var listOfSourceCodeFiles = [
     &quot;Ordinal.js&quot;,
     &quot;Vote.js&quot;,
-    &quot;IdentifiedRecord.js&quot;,
+    &quot;ContentRecord.js&quot;,
     &quot;Item.js&quot;,
     &quot;Entry.js&quot;,
     &quot;Transaction.js&quot;,

Modified: trunk/source/model/ModelTest.html
===================================================================
--- trunk/source/model/ModelTest.html	2005-06-16 17:49:03 UTC (rev 147)
+++ trunk/source/model/ModelTest.html	2005-06-16 20:01:15 UTC (rev 148)
@@ -18,7 +18,7 @@
     &lt;script type=&quot;text/javascript&quot; src=&quot;../Util.js&quot;&gt;&lt;/script&gt;
     &lt;script type=&quot;text/javascript&quot; src=&quot;Ordinal.js&quot;&gt;&lt;/script&gt;
     &lt;script type=&quot;text/javascript&quot; src=&quot;Vote.js&quot;&gt;&lt;/script&gt;
-    &lt;script type=&quot;text/javascript&quot; src=&quot;IdentifiedRecord.js&quot;&gt;&lt;/script&gt;
+    &lt;script type=&quot;text/javascript&quot; src=&quot;ContentRecord.js&quot;&gt;&lt;/script&gt;
     &lt;script type=&quot;text/javascript&quot; src=&quot;Item.js&quot;&gt;&lt;/script&gt;
     &lt;script type=&quot;text/javascript&quot; src=&quot;Entry.js&quot;&gt;&lt;/script&gt;
     &lt;script type=&quot;text/javascript&quot; src=&quot;Transaction.js&quot;&gt;&lt;/script&gt;

Modified: trunk/source/model/Ordinal.js
===================================================================
--- trunk/source/model/Ordinal.js	2005-06-16 17:49:03 UTC (rev 147)
+++ trunk/source/model/Ordinal.js	2005-06-16 20:01:15 UTC (rev 148)
@@ -32,7 +32,7 @@
 // -------------------------------------------------------------------
 // Dependencies:
 //   User.js
-//   IdentifiedRecord.js
+//   ContentRecord.js
 // -------------------------------------------------------------------
 
 /**
@@ -40,13 +40,13 @@
  * a user set an ordinal number for an item or a entry of an item.
  *
  * @scope    public instance constructor
- * @param    inIdentifiedRecord    The item or entry that this vote is attached to. 
+ * @param    inContentRecord    The item or entry that this vote is attached to. 
  * @param    inUser    The user who voted. 
  * @param    inOrdinalNumber    The ordinal number itself. 
  * @param    inTimestamp    Optional. The time the vote was made. 
  */
-function Ordinal(inIdentifiedRecord, inUser, inOrdinalNumber, inTimestamp) {
-  this.__myIdentifiedRecord = inIdentifiedRecord;
+function Ordinal(inContentRecord, inUser, inOrdinalNumber, inTimestamp) {
+  this.__myContentRecord = inContentRecord;
   this.__myUserstamp = inUser;
   this.__myOrdinalNumber = inOrdinalNumber;
   if (inTimestamp) {
@@ -54,11 +54,11 @@
   } else {
     this.__myTimestamp = new Date();
   }
-  this.__myIdentifiedRecord._addOrdinal(this);
+  this.__myContentRecord._addOrdinal(this);
 }
 
-Ordinal.prototype.getIdentifiedRecord = function () {
-  return this.__myIdentifiedRecord;
+Ordinal.prototype.getContentRecord = function () {
+  return this.__myContentRecord;
 };
 
 Ordinal.prototype.getTimestamp = function () {

Modified: trunk/source/model/StubVirtualServer.js
===================================================================
--- trunk/source/model/StubVirtualServer.js	2005-06-16 17:49:03 UTC (rev 147)
+++ trunk/source/model/StubVirtualServer.js	2005-06-16 20:01:15 UTC (rev 148)
@@ -34,7 +34,7 @@
 //   Util.js
 //   World.js
 //   Item.js
-//   IdentifiedRecord.js
+//   ContentRecord.js
 //   Ordinal.js
 //   Entry.js
 //   Vote.js
@@ -258,14 +258,14 @@
  * Returns a newly created ordinal.
  *
  * @scope    public instance method
- * @param    inIdentifiedRecord    The identifiedRecord that this is an ordinal for. 
+ * @param    inContentRecord    The contentRecord that this is an ordinal for. 
  * @param    inOrdinalNumber    The ordinal number itself. 
  * @return   A newly created ordinal.
  * @throws   Throws an Error if no user is logged in.
  */
-StubVirtualServer.prototype.newOrdinal = function (inIdentifiedRecord, inOrdinalNumber) {
+StubVirtualServer.prototype.newOrdinal = function (inContentRecord, inOrdinalNumber) {
   this._throwErrorIfNoUserIsLoggedIn();
-  var ordinal = new Ordinal(inIdentifiedRecord, this.__myWorld.getCurrentUser(), inOrdinalNumber);
+  var ordinal = new Ordinal(inContentRecord, this.__myWorld.getCurrentUser(), inOrdinalNumber);
   this._currentTransaction.addRecord(ordinal);
   // this.__myChronologicalListOfNewlyCreatedRecords.push(ordinal);
   return ordinal;
@@ -276,14 +276,14 @@
  * Returns a newly created vote.
  *
  * @scope    public instance method
- * @param    inIdentifiedRecord    The identifiedRecord to attach this vote to. 
+ * @param    inContentRecord    The contentRecord to attach this vote to. 
  * @param    inRetainFlag    True if this is a vote to retain. False if this is a vote to delete. 
  * @return   A newly created vote.
  * @throws   Throws an Error if no user is logged in.
  */
-StubVirtualServer.prototype.newVote = function (inIdentifiedRecord, inRetainFlag) {
+StubVirtualServer.prototype.newVote = function (inContentRecord, inRetainFlag) {
   this._throwErrorIfNoUserIsLoggedIn();
-  var vote = new Vote(inIdentifiedRecord, this.__myWorld.getCurrentUser(), inRetainFlag);
+  var vote = new Vote(inContentRecord, this.__myWorld.getCurrentUser(), inRetainFlag);
   this._currentTransaction.addRecord(vote);
   // this.__myChronologicalListOfNewlyCreatedRecords.push(vote);
   return vote;
@@ -545,7 +545,7 @@
     }
   }
   
-  listOfQueryResultItems.sort(IdentifiedRecord.compareOrdinals);
+  listOfQueryResultItems.sort(ContentRecord.compareOrdinals);
   return listOfQueryResultItems; 
 };
 
@@ -607,7 +607,7 @@
       listOfItems.push(item);
     }
   }
-  listOfItems.sort(IdentifiedRecord.compareOrdinals);
+  listOfItems.sort(ContentRecord.compareOrdinals);
   return listOfItems; 
 };
 
@@ -637,7 +637,7 @@
  * @param    inUuid    The UUID of the item or entry to be returned. 
  * @return   The item or entry identified by the given UUID.
  */
-StubVirtualServer.prototype._getIdentifiedRecordFromUuid = function (inUuid) {
+StubVirtualServer.prototype._getContentRecordFromUuid = function (inUuid) {
   var item = this.getItemFromUuid(inUuid);
   if (item) {
     return item;

Modified: trunk/source/model/Vote.js
===================================================================
--- trunk/source/model/Vote.js	2005-06-16 17:49:03 UTC (rev 147)
+++ trunk/source/model/Vote.js	2005-06-16 20:01:15 UTC (rev 148)
@@ -32,7 +32,7 @@
 // -------------------------------------------------------------------
 // Dependencies:
 //   User.js
-//   IdentifiedRecord.js
+//   ContentRecord.js
 // -------------------------------------------------------------------
 
 /**
@@ -40,13 +40,13 @@
  * an item or a entry of an item.
  *
  * @scope    public instance constructor
- * @param    inIdentifiedRecord    The item or entry that this vote is attached to. 
+ * @param    inContentRecord    The item or entry that this vote is attached to. 
  * @param    inUser    The user who voted. 
  * @param    inRetainFlag    True if this is a vote to retain. False if this is a vote to delete. 
  * @param    inTimestamp    Optional. The time the vote was made. 
  */
-function Vote(inIdentifiedRecord, inUser, inRetainFlag, inTimestamp) {
-  this.__myIdentifiedRecord = inIdentifiedRecord;
+function Vote(inContentRecord, inUser, inRetainFlag, inTimestamp) {
+  this.__myContentRecord = inContentRecord;
   this.__myUserstamp = inUser;
   this.__myRetainFlag = inRetainFlag;
   if (inTimestamp) {
@@ -54,11 +54,11 @@
   } else {
     this.__myTimestamp = new Date();
   }
-  this.__myIdentifiedRecord._addVote(this);
+  this.__myContentRecord._addVote(this);
 }
 
-Vote.prototype.getIdentifiedRecord = function () {
-  return this.__myIdentifiedRecord;
+Vote.prototype.getContentRecord = function () {
+  return this.__myContentRecord;
 };
 
 Vote.prototype.getTimestamp = function () {

Modified: trunk/source/model/World.js
===================================================================
--- trunk/source/model/World.js	2005-06-16 17:49:03 UTC (rev 147)
+++ trunk/source/model/World.js	2005-06-16 20:01:15 UTC (rev 148)
@@ -194,7 +194,7 @@
       item = record;
     }
     if ((record instanceof Vote) || (record instanceof Ordinal)) {
-      itemOrEntry = record.getIdentifiedRecord();
+      itemOrEntry = record.getContentRecord();
       if (itemOrEntry instanceof Item) {
         item = itemOrEntry;
       }
@@ -342,7 +342,7 @@
       break;
   }
 
-  filteredList.sort(IdentifiedRecord.compareOrdinals);
+  filteredList.sort(ContentRecord.compareOrdinals);
   return filteredList;
 };
 
@@ -707,13 +707,13 @@
  * Returns a newly created ordinal.
  *
  * @scope    protected instance method
- * @param    identifiedRecord    The identifiedRecord that this is an ordinal for. 
+ * @param    contentRecord    The contentRecord that this is an ordinal for. 
  * @param    ordinalNumber    The ordinal number itself. 
  * @return   A newly created ordinal.
  */
-World.prototype._newOrdinal = function(identifiedRecord, ordinalNumber) {
+World.prototype._newOrdinal = function(contentRecord, ordinalNumber) {
   this.beginTransaction();
-  var ordinal = this._virtualServer.newOrdinal(identifiedRecord, ordinalNumber);
+  var ordinal = this._virtualServer.newOrdinal(contentRecord, ordinalNumber);
   this.endTransaction();
   return ordinal;
 };
@@ -723,13 +723,13 @@
  * Returns a newly created vote.
  *
  * @scope    protected instance method
- * @param    identifiedRecord    The identifiedRecord to attach this vote to. 
+ * @param    contentRecord    The contentRecord to attach this vote to. 
  * @param    retainFlag    True if this is a vote to retain. False if this is a vote to delete. 
  * @return   A newly created vote.
  */
-World.prototype._newVote = function(identifiedRecord, retainFlag) {
+World.prototype._newVote = function(contentRecord, retainFlag) {
   this.beginTransaction();
-  var vote = this._virtualServer.newVote(identifiedRecord, retainFlag);
+  var vote = this._virtualServer.newVote(contentRecord, retainFlag);
   this.endTransaction();
   return vote;
 };


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000133.html">[openrecord-svn] r147 - trunk/source
</A></li>
	<LI>Next message: <A HREF="000135.html">[openrecord-svn] r149 - in trunk/source: . model
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#134">[ date ]</a>
              <a href="thread.html#134">[ thread ]</a>
              <a href="subject.html#134">[ subject ]</a>
              <a href="author.html#134">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/openrecord-svn">More information about the openrecord-svn
mailing list</a><br>
</body></html>
