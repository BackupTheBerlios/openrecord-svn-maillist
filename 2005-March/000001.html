<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openrecord-svn] r2 - in trunk: . documentation source
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/openrecord-svn/2005-March/index.html" >
   <LINK REL="made" HREF="mailto:openrecord-svn%40lists.berlios.de?Subject=Re%3A%20%5Bopenrecord-svn%5D%20r2%20-%20in%20trunk%3A%20.%20documentation%20source&In-Reply-To=%3C200503242322.j2ONMmjV012362%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000000.html">
   <LINK REL="Next"  HREF="000002.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openrecord-svn] r2 - in trunk: . documentation source</H1>
    <B>Brian Douglas Skinner at BerliOS</B> 
    <A HREF="mailto:openrecord-svn%40lists.berlios.de?Subject=Re%3A%20%5Bopenrecord-svn%5D%20r2%20-%20in%20trunk%3A%20.%20documentation%20source&In-Reply-To=%3C200503242322.j2ONMmjV012362%40sheep.berlios.de%3E"
       TITLE="[openrecord-svn] r2 - in trunk: . documentation source">skinner at sheep.berlios.de
       </A><BR>
    <I>Fri Mar 25 00:22:48 CET 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="000000.html">[openrecord-svn] r1 - /
</A></li>
        <LI>Next message: <A HREF="000002.html">[openrecord-svn] r3 - trunk/source
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1">[ date ]</a>
              <a href="thread.html#1">[ thread ]</a>
              <a href="subject.html#1">[ subject ]</a>
              <a href="author.html#1">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: skinner
Date: 2005-03-25 00:22:45 +0100 (Fri, 25 Mar 2005)
New Revision: 2

Added:
   trunk/documentation/
   trunk/documentation/architecture.txt
   trunk/source/
   trunk/source/bar_chart_layout.js
   trunk/source/base_style.css
   trunk/source/complete_view.js
   trunk/source/datastore.js
   trunk/source/detail_layout.js
   trunk/source/item.js
   trunk/source/item_view.js
   trunk/source/outline_layout.js
   trunk/source/page_view.js
   trunk/source/rectangle.js
   trunk/source/save_changes.php
   trunk/source/section_view.js
   trunk/source/stevedore.js
   trunk/source/table_layout.js
   trunk/source/test_page.html
   trunk/source/test_page.js
   trunk/source/util.js
Log:
initial import

Added: trunk/documentation/architecture.txt
===================================================================
--- trunk/documentation/architecture.txt	2005-03-24 23:11:51 UTC (rev 1)
+++ trunk/documentation/architecture.txt	2005-03-24 23:22:45 UTC (rev 2)
@@ -0,0 +1,38 @@
+
++-----------------------------------------------------------------------+
+| CLIENT-SIDE: entirely JavaScript, CSS, and XHTML                      |
+|                                                                       |
+|              +--------+  +---------+  +--------+       +-----------+  |
+| layout       | Table  |  | Outline |  | Detail |       | 3rd-party |  |
+| plugins      | Layout |  | Layout  |  | Layout |  ...  | Layout    |  |
+|              +--------+  +---------+  +--------+       +-----------+  |
+|              +-----------------------------------------------------+  |
+| presentation |  SectionView                                        |  |
+| layer        |  PageView                                           |  |
+|              |  ItemView                                           |  |
+|              |  CompleteView                                       |  |
+|              +-----------------------------------------------------+  |
+|                  |           |                                        |
+|                  | Query API |                                        |
+|                  VVVVVVVVVVVVV                                        |
+|              +-----------------------------------------------------+  |
+| model layer  |  Stevedore                                          |  |
+|              |  Item                                               |  |
+|              |  Query                                              |  |
+|              +-------+   +-----------------------------------------+  |
+|                      |   |                                            |
++----------------------|   |--------------------------------------------+
+                       |   |
+                   XMLHttpRequest
+                       |   |
+                    XML or JSON
+                    data packets
+                       |   |
++--------------+-------+   +--------------------------+
+| SERVER-SIDE: | WEB SERVER:                          |
+|              |   PHP code, or Java code             |
+|              +--------------------------------------+
+|              | DATA SERVER:                         |
+|              |   XML files, or MySQL, or BerkeleyDB |
++--------------+--------------------------------------+
+               

Added: trunk/source/bar_chart_layout.js
===================================================================
--- trunk/source/bar_chart_layout.js	2005-03-24 23:11:51 UTC (rev 1)
+++ trunk/source/bar_chart_layout.js	2005-03-24 23:22:45 UTC (rev 2)
@@ -0,0 +1,177 @@
+/*****************************************************************************
+ bar_chart_layout.js
+ 
+******************************************************************************
+ Written in 2005 by Brian Douglas Skinner &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openrecord-svn">brian.skinner at gumption.org</A>&gt;
+  
+ Copyright rights relinquished under the Creative Commons  
+ Public Domain Dedication:
+    <A HREF="http://creativecommons.org/licenses/publicdomain/">http://creativecommons.org/licenses/publicdomain/</A>
+  
+ You can copy freely from this file.  This work may be freely reproduced, 
+ distributed, transmitted, used, modified, built upon, or otherwise exploited
+ by anyone for any purpose.
+  
+ This work is provided on an &quot;AS IS&quot; basis, without warranties or conditions 
+ of any kind, either express or implied, including, without limitation, any 
+ warranties or conditions of title, non-infringement, merchantability, or 
+ fitness for a particular purpose. You are solely responsible for determining 
+ the appropriateness of using or distributing the work and assume all risks 
+ associated with use of this work, including but not limited to the risks and 
+ costs of errors, compliance with applicable laws, damage to or loss of data 
+ or equipment, and unavailability or interruption of operations.
+
+ In no event shall the authors or contributors have any liability for any 
+ direct, indirect, incidental, special, exemplary, or consequential damages,
+ however caused and on any theory of liability, whether in contract, strict 
+ liability, or tort (including negligence), arising in any way out of or in 
+ connection with the use or distribution of the work.
+*****************************************************************************/
+
+
+// -------------------------------------------------------------------
+// Dependencies:
+//   repository.js
+//   section_view.js
+//   page_view.js
+//   util.js
+// -------------------------------------------------------------------
+
+
+// -------------------------------------------------------------------
+// Register this layout type in the SectionView registry
+// -------------------------------------------------------------------
+SectionView.ourHashTableOfLayoutClassesKeyedByLayoutName[SectionView.LAYOUT_BAR_CHART] = BarChartLayout;
+
+// -------------------------------------------------------------------
+// new BarChartLayout()
+//   public instance constructor
+// -------------------------------------------------------------------
+function BarChartLayout(inSectionView) {
+  Util.assert(inSectionView instanceof SectionView);
+  this.mySectionView = inSectionView;
+  this._myDivElement = null;
+}
+
+
+// -------------------------------------------------------------------
+// barChartLayout.getLayoutName()
+//   public instance method
+// -------------------------------------------------------------------
+BarChartLayout.prototype.getLayoutName = function () {
+  return SectionView.LAYOUT_BAR_CHART;
+};
+
+  
+// -------------------------------------------------------------------
+// barChartLayout.setDivElement()
+//   public instance method
+// -------------------------------------------------------------------
+BarChartLayout.prototype.setDivElement = function (inDivElement) {
+  Util.assert(inDivElement instanceof HTMLDivElement);
+  this._myDivElement = inDivElement;
+  this.display();
+};
+
+
+// -------------------------------------------------------------------
+// barChartLayout.display()
+//   public instance method
+// -------------------------------------------------------------------
+BarChartLayout.prototype.display = function () {
+  var listOfStrings = [];
+
+  var contentItem = null;
+  var attributeUuid = null;
+  var hashTableOfNumericValueIncidenceKeyedByAttributeUuid = {};
+  
+  // for each attribute, count the number of items where that attribute has a numeric value
+  var listOfContentItems = this.mySectionView.getListOfContentItems();
+  for (var iKey in listOfContentItems) {
+    contentItem = listOfContentItems[iKey];
+    var listOfAttributesForItem = contentItem.getListOfAttributeUuids();
+    for (var attributeKey in listOfAttributesForItem) {
+      attributeUuid = listOfAttributesForItem[attributeKey];
+      var valueList = contentItem.getValueListFromAttribute(attributeUuid);
+      if (valueList) {
+        var value = valueList[0];
+        if (Util.isNumber(value)) {
+          var count = hashTableOfNumericValueIncidenceKeyedByAttributeUuid[attributeUuid];
+          if (!count) {
+            count = 0;
+          }
+          count += 1;
+          hashTableOfNumericValueIncidenceKeyedByAttributeUuid[attributeUuid] = count;
+        }
+      }
+    }
+  }
+  
+  // find the attribute for which most of the items have a numeric value 
+  var maxIncidence = 0;
+  var selectedAttribute = null;
+  for (attributeUuid in hashTableOfNumericValueIncidenceKeyedByAttributeUuid) {
+    var incidence = hashTableOfNumericValueIncidenceKeyedByAttributeUuid[attributeUuid];
+    if (incidence &gt; maxIncidence) {
+      selectedAttribute = this.mySectionView.getStevedore().getItemFromUuid(attributeUuid);
+      maxIncidence = incidence;
+    }
+  }
+
+  // find the maximum value for the selected attribute
+  if (selectedAttribute) {
+    var maxValue = 0;
+    for (var jkey in listOfContentItems) {
+      contentItem = listOfContentItems[jkey];
+      var nextValueList = contentItem.getValueListFromAttribute(selectedAttribute);
+      var nextValue = nextValueList[0];
+      if (Util.isNumber(nextValue)) {
+        maxValue = Math.max(maxValue, nextValue);
+      }     
+    }
+  }
+
+  // add the table header row(s)
+  listOfStrings.push(&quot;&lt;table class=\&quot;&quot; + SectionView.ELEMENT_CLASS_SIMPLE_TABLE + &quot;\&quot;&gt;&quot;);
+  listOfStrings.push(&quot;&lt;tr&gt;&quot;);
+  var attributeCalledName = this.mySectionView.getStevedore().getItemFromUuid(Stevedore.UUID_FOR_ATTRIBUTE_NAME);
+  listOfStrings.push(&quot;&lt;th&gt;&quot; + attributeCalledName.getDisplayName() + &quot;&lt;/th&gt;&quot;);
+  if (selectedAttribute) {
+    listOfStrings.push(&quot;&lt;th&gt;&quot; + selectedAttribute.getDisplayName() + &quot;&lt;/th&gt;&quot;);
+  } else {
+    listOfStrings.push(&quot;&lt;th&gt;&quot; + &quot;Sorry, there are no attributes with numeric values to chart&quot; + &quot;&lt;/th&gt;&quot;);
+  }
+  listOfStrings.push(&quot;&lt;/tr&gt;&quot;);
+    
+  // add all the table body rows
+  for (var kKey in listOfContentItems) {
+    contentItem = listOfContentItems[kKey];
+    listOfStrings.push(&quot;&lt;tr&gt;&quot;);
+    listOfStrings.push(&quot;&lt;td class=\&quot;&quot; + SectionView.ELEMENT_CLASS_PLAIN + &quot;\&quot;&gt;&quot; + contentItem.getDisplayName(&quot;{no name}&quot;) + &quot;&lt;/td&gt;&quot;);
+    var numericValue = 0;
+    if (selectedAttribute) {
+      var listOfValues = contentItem.getValueListFromAttribute(selectedAttribute);
+      var firstValue = listOfValues[0];
+      if (Util.isNumber(firstValue)) {
+        numericValue = firstValue;
+      }
+    }
+    // listOfStrings.push(&quot;&lt;td class=\&quot;&quot; + SectionView.ELEMENT_CLASS_PLAIN + &quot;\&quot;&gt;&quot; + displayValue + &quot;&lt;/td&gt;&quot;);
+    var width = 0;
+    if (maxValue &gt; 0) {
+      width = (numericValue / maxValue) * 100; // 100 Percent
+    }
+    listOfStrings.push(&quot;&lt;td class=\&quot;bar_chart_frame\&quot;&gt;&lt;input disabled type=\&quot;text\&quot; class=\&quot;bar_chart_bar\&quot; value=\&quot;&quot; + numericValue + &quot;\&quot; size=\&quot;1\&quot; style=\&quot;width: &quot; + width + &quot;%;\&quot;&gt;&lt;/input&gt;&lt;/td&gt;&quot;);
+    listOfStrings.push(&quot;&lt;/tr&gt;&quot;);
+  }  
+  listOfStrings.push(&quot;&lt;/table&gt;&quot;);
+    
+  // return all the new content   
+  var finalString = listOfStrings.join(&quot;&quot;);
+  this._myDivElement.innerHTML = finalString;
+};
+
+
+// -------------------------------------------------------------------
+// End of file
+// -------------------------------------------------------------------

Added: trunk/source/base_style.css
===================================================================
--- trunk/source/base_style.css	2005-03-24 23:11:51 UTC (rev 1)
+++ trunk/source/base_style.css	2005-03-24 23:22:45 UTC (rev 2)
@@ -0,0 +1,536 @@
+/*****************************************************************************
+ base_style.css
+ 
+******************************************************************************
+ Written in 2005 by Brian Douglas Skinner &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openrecord-svn">brian.skinner at gumption.org</A>&gt;
+  
+ Copyright rights relinquished under the Creative Commons  
+ Public Domain Dedication:
+    <A HREF="http://creativecommons.org/licenses/publicdomain/">http://creativecommons.org/licenses/publicdomain/</A>
+  
+ You can copy freely from this file.  This work may be freely reproduced, 
+ distributed, transmitted, used, modified, built upon, or otherwise exploited
+ by anyone for any purpose.
+  
+ This work is provided on an &quot;AS IS&quot; basis, without warranties or conditions 
+ of any kind, either express or implied, including, without limitation, any 
+ warranties or conditions of title, non-infringement, merchantability, or 
+ fitness for a particular purpose. You are solely responsible for determining 
+ the appropriateness of using or distributing the work and assume all risks 
+ associated with use of this work, including but not limited to the risks and 
+ costs of errors, compliance with applicable laws, damage to or loss of data 
+ or equipment, and unavailability or interruption of operations.
+
+ In no event shall the authors or contributors have any liability for any 
+ direct, indirect, incidental, special, exemplary, or consequential damages,
+ however caused and on any theory of liability, whether in contract, strict 
+ liability, or tort (including negligence), arising in any way out of or in 
+ connection with the use or distribution of the work.
+*****************************************************************************/
+
+
+/*********************************************************************
+ Font sizes and line sizes
+ 
+ When I first wrote this stylesheet, I tested only in Firefox, not IE.
+ My early versions relied heavily on some CSS values like &quot;thin&quot;, 
+ which IE doesn't seem to support.  To make the IE output to match
+ the Firefox output, I reluctantly changed many of the values here.
+ At some point, once IE supports more of CSS, it would be good to 
+ change these values back.  You can safely just do global replacements
+ in this file.  Here's the list of replacements:
+   1pt    --&gt;  thin
+   1.5em  --&gt;  x-large
+   0.8em  --&gt;  small
+   0.6em  --&gt;  x-small
+*********************************************************************/
+  
+/*********************************************************************
+ Colors
+ 
+ Here are lists of the colors I use.
+ 
+ Background colors:
+   white            --&gt;  rgb(100%,100%,100%);
+   gray background  --&gt;  rgb(90%,90%,90%);
+   green background --&gt;  rgb(80%,100%,80%);
+   red background   --&gt;  rgb(100%,80%,80%);
+   bright yellow    --&gt;  rgb(100%,100%,0%);
+   black            --&gt;  rgb(0%, 0%, 0%);
+
+ Line colors
+   table line gray  --&gt;  rgb(70%,70%,70%);
+   dark blue        --&gt;  rgb(0%, 0%, 50%);
+ 
+ Font colors:
+   black            --&gt;  rgb(0%, 0%, 0%);
+   logo gray        --&gt;  rgb(60%,60%,60%);  
+   dark blue        --&gt;  rgb(0%, 0%, 50%);
+   red              --&gt;  rgb(100%, 0%, 0%);
+   teletype green   --&gt;  rgb(0%, 100%, 0%);
+ 
+ Link colors:
+   blue             --&gt;  #0000cc;
+   maroon           --&gt;  #551a8b;
+   dark gray        --&gt;  rgb(30%,30%,30%);  
+
+*********************************************************************/
+
+
+/****************************************/
+/* Universal styles                     */
+
+html, body {
+  background: rgb(100%,100%,100%);
+  color: rgb(0%,0%,0%);
+  font-family: Arial, Verdana, sans-serif;
+}
+
+div.editmode {
+  background: rgb(100%,100%,100%);
+}
+
+h1 {
+  color: rgb(0%, 0%, 50%);
+  font-size: 1.5em;
+  margin-top: 1.4em;
+}
+
+h2 {
+  color: rgb(0%, 0%, 50%);
+  font-size: large;
+}
+
+h3 {
+  color: rgb(0%, 0%, 0%);
+  font-size: medium;
+  font-weight: bold;
+}
+
+a {
+  text-decoration: none;
+  border-bottom-style: dotted;
+  border-bottom-width: thin;
+}
+
+a:link {
+  color: #0000cc;
+}
+
+a:visited {
+  color: #551a8b;
+}
+
+a:active {
+  color: rgb(100%, 0%, 0%);
+}
+
+a:hover {
+  text-decoration: none;
+  border-bottom-style: solid;
+  border-bottom-width: 1pt;
+  background: rgb(100%,100%,0%);
+}
+
+a.anchor {
+  text-decoration: none;
+  border-bottom-style: none;
+}
+
+a[rel~=&quot;external&quot;]:after {
+  content: &quot; &gt;&quot;;
+  font-weight: bold;
+}
+
+a[rel~=&quot;external&quot;] {
+  text-decoration: none;
+  border-bottom-style: dotted;
+  border-bottom-width: thin;
+}
+
+a[rel~=&quot;external&quot;]:hover {
+  text-decoration: none;
+  border-bottom-style: solid;
+  border-bottom-width: 1pt;
+  background: rgb(100%,100%,0%);
+}
+
+a.more {
+  font-size: 0.6em;
+}
+
+.helpbox {
+  margin: 1.4em 6%;
+  padding: 1em;
+  border: solid 1pt rgb(0%, 0%, 50%); 
+}
+
+.helpbox h2 {
+  font-size: medium;
+  font-weight: bold;
+  padding: 0px;
+  margin: 0px;
+}
+
+span.bad {
+  color: rgb(100%, 0%, 0%);
+}
+
+
+/****************************************/
+/* Header and logo styles               */
+
+.header {
+  clear: both;
+  border-left: solid 1pt rgb(0%, 0%, 50%);
+  border-bottom: solid 1pt rgb(0%, 0%, 50%);
+  padding: 0.3em;
+  width: 100%;
+}
+
+.logo a {
+  font-weight: bold;
+  text-decoration: none;
+  border-bottom-style: none;
+}
+
+.logo a:hover {
+  border-bottom-style: solid;
+}
+
+.logostart {
+  color: rgb(60%,60%,60%);  
+}
+
+.logomiddle {
+  color: rgb(0%, 0%, 50%); 
+}
+
+.logoend {
+  color: rgb(60%,60%,60%);  
+}
+
+.logo {
+  float: left;
+}
+
+
+/****************************************/
+/* Edit button styles                   */
+
+#main_control_span {
+  float: right;
+}
+
+.page_edit_button {
+  /* float: right; */
+}
+
+.section_layout_menu {
+}
+
+
+/****************************************/
+/* Navigation bar styles                */
+
+div.navbar {
+  float: left;
+  width: 100pt;
+  margin: 0;
+  padding: 0;
+  font-size: 0.8em;
+  font-weight: bold;
+}
+
+.menu {
+  padding-left: 0;
+  padding-top: 8pt;
+  padding-bottom: 20pt;
+  margin-left: 0;
+  list-style-type: none;
+  width: 80pt;
+}
+
+.menu_item {
+  list-style: none;
+  margin: 0;
+}
+
+.menu_item a {
+  display: block;
+  width: 100%;
+  padding: 5pt 0pt 5pt 5pt;
+  text-decoration: none; 
+  border-left: solid 5pt rgb(100%, 100%, 100%);
+  border-top: solid 1pt rgb(0%, 0%, 50%);
+  border-right: solid 1pt rgb(0%, 0%, 50%);
+  border-bottom-style: none;
+  color: rgb(0%, 0%, 50%); 
+}
+
+.menu_item a:link {
+  color: rgb(0%, 0%, 50%); 
+  background-color: rgb(100%,100%,100%);
+}
+
+.menu_item a:visited {
+  color: rgb(0%, 0%, 50%); 
+  background-color: rgb(90%,90%,90%);
+  border-left: solid 5pt rgb(90%, 90%, 90%);
+}
+
+.menu_item a:hover {
+  background-color: rgb(100%,100%,0%);
+  width: 100%;
+  border-left: solid 5pt rgb(0%, 0%, 50%);
+  border-bottom-style: none;
+}
+
+.sub_menu {
+  margin-left: 15pt;
+  padding: 0;
+  list-style-type: none;
+}
+
+.sub_menu_item {
+  list-style: none;
+  margin: 0;
+}
+
+.sub_menu_item a {
+  display: block;
+  width: 65pt;  /* menu.width - sub_menu.margin-left = 80pt - 15pt = 65pt */
+  padding: 5pt 0pt 5pt 5pt;
+  text-decoration: none; 
+  border-top: solid 1pt rgb(0%, 0%, 50%);
+  border-right: solid 1pt rgb(0%, 0%, 50%);
+  border-bottom-style: none;
+}
+
+
+/****************************************/
+/* Content area styles                  */
+
+div.content_area {
+  margin: 0pt 0pt 0pt 115pt;
+  padding: 0pt;
+}
+
+
+/****************************************/
+/* Debug area styles                    */
+
+.debug textarea {
+  background-color: rgb(0%, 0%, 0%);
+  color: rgb(0%, 100%, 0%); 
+  visibility: hidden;
+  display: none;
+}
+
+
+/****************************************/
+/* Footer and copyright styles          */
+.footer {
+  clear: both;
+  border-left: solid 1pt rgb(0%, 0%, 50%);
+  border-top: solid 1pt rgb(0%, 0%, 50%);
+  padding: 0.3em;
+  width: 100%;
+  font-size: 0.6em;
+  margin-top: 3em;
+}
+
+.copyright {
+  float: left;
+}
+
+.fileformat {
+  float: right;
+}
+
+
+/****************************************/
+/* FAQ styles                           */
+
+.faq dt {
+  font-weight: bold;
+  color: rgb(0%,0%,50%);
+  margin-top: 1.4em;
+}
+
+.faq dd {
+  color: rgb(0%,0%,0%);
+}
+
+
+/****************************************/
+/* Table styles                         */
+
+.simple_table {
+  background: rgb(70%,70%,70%);
+  border: 1pt solid rgb(70%,70%,70%);
+  border-collapse: collapse; 
+}
+
+.simple_table th {
+  padding: 0.3em;
+  color: rgb(0%,0%,50%);
+  background: rgb(90%,90%,90%);
+  font-size: 0.8em;
+  border: 1pt solid rgb(70%,70%,70%);
+}
+
+.simple_table tr {
+  background: rgb(100%,100%,100%);
+}
+
+.viewmode .simple_table tr:hover {
+  background: rgb(100%,100%,0%);
+}
+
+.simple_table td {
+  padding: 0.1em 0.3em; 
+  font-size: 0.8em;
+  border: 1pt solid rgb(70%,70%,70%);
+}
+
+td.plain {
+  text-align: left;
+}
+
+td.yup {
+  background: rgb(80%,100%,80%);
+}
+
+td.nope {
+  background: rgb(100%,80%,80%);
+}
+
+td.year {
+  font-weight: bold;  
+  padding-left: 1em;
+  padding-right: 1em;
+}
+
+td.money {
+  text-align: right;
+}
+
+td.title {
+  font-weight: bold;  
+  background: rgb(90%,90%,90%);
+}
+
+td.label {
+  font-weight: bold;  
+  text-align: right;
+  vertical-align: top;
+}
+
+td.negative {
+  color: rgb(90%,0%,0%);
+}
+
+td.total {
+  font-weight: bold;  
+  background: rgb(90%,90%,90%);
+}
+
+input.text_field_in_table_cell {
+  border-width: 0px;
+  width: 100%;
+  background: rgb(100%,100%,0%);
+}
+
+input.text_field_in_table_cell:hover {
+  border-width: 0px;
+  width: 100%;
+  background: rgb(100%,100%,0%);
+}
+
+.editmode .simple_table td:hover {
+  background: rgb(100%,100%,70%);
+}
+
+td.newitem {
+  /* background: rgb(100%,100%,50%); */
+  border-top: medium solid rgb(70%,70%,70%);
+}
+
+.editmode .simple_table td.selected {
+  /* padding: 0px 0px; */
+  background: rgb(100%,100%,0%);
+}
+
+
+/****************************************/
+/* Outline styles                       */
+
+li.category {
+   color: rgb(0%, 0%, 50%);
+   line-height: 1em;
+   padding-top: 12pt;
+   font-weight: normal;
+   font-size: medium;
+}
+
+li.primary {
+   font-weight: bold;
+   font-size: medium;
+   line-height: 1.1em;
+   padding-top: 8pt;
+}
+
+li.detail {
+   color: rgb(0%,0%,0%);
+   line-height: 1.2em;
+   padding-top: 4pt;
+   font-weight: normal;
+   font-size: small;
+}
+
+
+/****************************************/
+/* Bar chart styles                     */
+
+.simple_table td.bar_chart_frame {
+  width: 20em;
+  padding: 0px;
+  margin: 0px;
+  text-align: left;
+}
+
+.bar_chart_bar {
+  height: 100%;
+  margin: 0px;
+  padding: 0px;
+  background: rgb(0%, 0%, 50%);
+  border: none;
+  text-align: right;
+  vertical-align: middle;
+  color: white;
+}
+
+
+/****************************************/
+/* PENDING -- time to delete these?     */
+
+p.byline {
+  font-size: 0.8em;
+  text-align: right;
+  line-height: 0.4em;
+}
+
+p.byline a {
+  color: rgb(0%,0%,0%);
+}
+
+div.section {
+  border-top: solid thin rgb(0%, 0%, 50%);
+  margin-top: 3em;
+  padding-left: 0px;
+}
+
+/****************************************/
+/* END                                  */
+/****************************************/

Added: trunk/source/complete_view.js
===================================================================
--- trunk/source/complete_view.js	2005-03-24 23:11:51 UTC (rev 1)
+++ trunk/source/complete_view.js	2005-03-24 23:22:45 UTC (rev 2)
@@ -0,0 +1,423 @@
+/*****************************************************************************
+ complete_view.js
+ 
+******************************************************************************
+ Written in 2005 by Brian Douglas Skinner &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openrecord-svn">brian.skinner at gumption.org</A>&gt;
+  
+ Copyright rights relinquished under the Creative Commons  
+ Public Domain Dedication:
+    <A HREF="http://creativecommons.org/licenses/publicdomain/">http://creativecommons.org/licenses/publicdomain/</A>
+  
+ You can copy freely from this file.  This work may be freely reproduced, 
+ distributed, transmitted, used, modified, built upon, or otherwise exploited
+ by anyone for any purpose.
+  
+ This work is provided on an &quot;AS IS&quot; basis, without warranties or conditions 
+ of any kind, either express or implied, including, without limitation, any 
+ warranties or conditions of title, non-infringement, merchantability, or 
+ fitness for a particular purpose. You are solely responsible for determining 
+ the appropriateness of using or distributing the work and assume all risks 
+ associated with use of this work, including but not limited to the risks and 
+ costs of errors, compliance with applicable laws, damage to or loss of data 
+ or equipment, and unavailability or interruption of operations.
+
+ In no event shall the authors or contributors have any liability for any 
+ direct, indirect, incidental, special, exemplary, or consequential damages,
+ however caused and on any theory of liability, whether in contract, strict 
+ liability, or tort (including negligence), arising in any way out of or in 
+ connection with the use or distribution of the work.
+*****************************************************************************/
+
+
+// -------------------------------------------------------------------
+// Dependencies:
+//   page_view.js
+//   repository.js
+//   util.js
+// -------------------------------------------------------------------
+
+
+// -------------------------------------------------------------------
+// CompleteView public class constants
+// -------------------------------------------------------------------
+CompleteView.ELEMENT_CLASS_PAGE_EDIT_BUTTON = &quot;page_edit_button&quot;;
+
+CompleteView.ELEMENT_ID_EDIT_BUTTON = &quot;edit_button&quot;;
+CompleteView.ELEMENT_ID_DEBUG_TEXTAREA = &quot;debug_textarea&quot;;
+
+CompleteView.URL_PAGE_PREFIX = &quot;page&quot;;
+CompleteView.URL_ITEM_PREFIX = &quot;item&quot;;
+CompleteView.URL_HASH_PAGE_PREFIX = &quot;#&quot; + CompleteView.URL_PAGE_PREFIX;
+CompleteView.URL_HASH_ITEM_PREFIX = &quot;#&quot; + CompleteView.URL_ITEM_PREFIX;
+
+
+// -------------------------------------------------------------------
+// CompleteView class properties
+// -------------------------------------------------------------------
+CompleteView.ourSingleInstance = null;
+
+
+/**
+ * The BlueSky app uses a single instance of CompleteView, which serves as the
+ * outer-most view in the browser, and contains the current PageView as well
+ * as some standard chrome (like the Edit button).
+ *
+ * @scope    public instance constructor
+ * @syntax   var completeView = new CompleteView()
+ */
+function CompleteView(inStevedore, inNavbarDivElement, inContentViewDivElement, inDebugDivElement, inMainControlSpanElement, inStatusBlurbSpanElement) {
+  CompleteView.ourSingleInstance = this;
+   
+  Util.assert(inStevedore instanceof Stevedore);
+  Util.assert(inNavbarDivElement instanceof HTMLDivElement);
+  Util.assert(inContentViewDivElement instanceof HTMLDivElement);
+  Util.assert(inDebugDivElement instanceof HTMLDivElement);
+  Util.assert(inMainControlSpanElement instanceof HTMLSpanElement);
+  Util.assert(inStatusBlurbSpanElement instanceof HTMLSpanElement);
+
+  // instance properties
+  this._myStevedore = inStevedore;
+  this.myNavbarDivElement = inNavbarDivElement;
+  this._myContentViewDivElement = inContentViewDivElement;
+  this.myDebugDivElement = inDebugDivElement;
+  this.myMainControlSpanElement = inMainControlSpanElement;
+  this.myStatusBlurbSpanElement = inStatusBlurbSpanElement;
+  
+  this.myEditButtonId = CompleteView.ELEMENT_ID_EDIT_BUTTON;
+  this.myEditMode = false;
+  this.myNumberOfCallsToDebug = 0;
+  this.myDebugTextarea = null;
+  
+  this._myHashTableOfItemViewsKeyedByUuid = {};
+  this._myHashTableOfPageViewsKeyedByUuid = {};
+  this._myCurrentContentView = null;
+  
+  this.myHashTableOfPagesKeyedByUuid = {};
+  var categoryPage = this._myStevedore.getItemFromUuid(Stevedore.UUID_FOR_CATEGORY_PAGE);
+  var listOfPages = this._myStevedore.getListOfItemsInCategory(categoryPage);
+  for (var key in listOfPages) {
+    var page = listOfPages[key];
+    this.myHashTableOfPagesKeyedByUuid[page.getUuid()] = page; 
+  }
+
+  Util.setErrorReportCallback(CompleteView.displayTextInDebugTextarea);
+  this.setCurrentContentViewFromUrl();
+}
+
+
+/**
+ * Returns the Stevedore instance that this CompleteView is using.
+ *
+ * @scope    public instance method
+ * @return   A Stevedore object. 
+ */
+CompleteView.prototype.getStevedore = function () {
+  return this._myStevedore;
+};
+
+
+/**
+ * Returns true if we are in Edit Mode.
+ *
+ * @scope    public instance method
+ * @return   A boolean value. True if we are in Edit Mode.
+ */
+CompleteView.prototype.isInEditMode = function () {
+  return this.myEditMode;
+};
+
+  
+/**
+ * Gets the browser URL from window.location, finds or creates a corresponding
+ * PageView or ItemView, and sets the current content view to the newly selected
+ * PageView or ItemView.
+ *
+ * @scope    public instance method
+ */
+CompleteView.prototype.setCurrentContentViewFromUrl = function () {
+  var contentViewToSwitchTo = null;
+  
+  if (window.location) {
+    if (window.location.hash) {
+      var originalHash = window.location.hash;
+      var uuidText = null;
+      var uuidNumber = null;
+      var pageFromUuid = null;
+      var itemFromUuid = null;
+      var divElement = null;
+      var isUrlForPage = (originalHash.indexOf(CompleteView.URL_HASH_PAGE_PREFIX) != -1);
+      var isUrlForItem = (originalHash.indexOf(CompleteView.URL_HASH_ITEM_PREFIX) != -1);
+      // alert(originalHash + &quot;\n isUrlForPage: &quot; + isUrlForPage + &quot;\n isUrlForItem: &quot; + isUrlForItem);
+      if (isUrlForItem) {
+        uuidText = originalHash.replace(CompleteView.URL_HASH_ITEM_PREFIX, &quot;&quot;);
+        uuidNumber = parseInt(uuidText);
+        contentViewToSwitchTo = this._myHashTableOfItemViewsKeyedByUuid[uuidNumber];
+        if (!contentViewToSwitchTo) {
+          itemFromUuid = this._myStevedore.getItemFromUuid(uuidNumber);
+          if (itemFromUuid) {
+            divElement = window.document.createElement(&quot;div&quot;); 
+            this._myContentViewDivElement.appendChild(divElement);
+            contentViewToSwitchTo = new ItemView(itemFromUuid, divElement, this);
+            this._myHashTableOfItemViewsKeyedByUuid[uuidNumber] = contentViewToSwitchTo;
+          }
+        }
+        // this._myCurrentContentView = contentView;
+      } else {
+        if (isUrlForPage) {
+          uuidText = originalHash.replace(CompleteView.URL_HASH_PAGE_PREFIX, &quot;&quot;);
+          uuidNumber = parseInt(uuidText);
+          contentViewToSwitchTo = this._myHashTableOfPageViewsKeyedByUuid[uuidNumber];
+          if (!contentViewToSwitchTo) {
+            pageFromUuid = this.myHashTableOfPagesKeyedByUuid[uuidNumber];
+            if (pageFromUuid) {
+              divElement = window.document.createElement(&quot;div&quot;); 
+              this._myContentViewDivElement.appendChild(divElement);
+              contentViewToSwitchTo = new PageView(pageFromUuid, divElement, this);
+              this._myHashTableOfPageViewsKeyedByUuid[uuidNumber] = contentViewToSwitchTo;
+            }
+          }
+        } 
+      }
+    } 
+  }
+  
+  if (!contentViewToSwitchTo) {
+    var page = this._myStevedore.getHomePage();
+    contentViewToSwitchTo = this._myHashTableOfPageViewsKeyedByUuid[page.getUuid()];
+    if (!contentViewToSwitchTo) {
+      divElement = window.document.createElement(&quot;div&quot;); 
+      this._myContentViewDivElement.appendChild(divElement);
+      contentViewToSwitchTo = new PageView(page, divElement, this);
+      this._myHashTableOfPageViewsKeyedByUuid[page.getUuid()] = contentViewToSwitchTo;
+    }
+  }
+  if (this._myCurrentContentView) {
+    this._myCurrentContentView.hide();
+  }
+  this._myCurrentContentView = contentViewToSwitchTo;
+
+  this.display();
+};
+
+  
+/**
+ * Re-creates all the HTML for the CompleteView, including the chrome and 
+ * the current PageView, and hands the HTML to the browser to be re-drawn.
+ *
+ * @scope    public instance method
+ */
+CompleteView.prototype.display = function () {
+  Util.assert(this._myCurrentContentView instanceof Object);
+
+  document.title = this._myCurrentContentView.getPageTitle() + &quot; - openagenda.org&quot;;
+  this.displayControlSpan();
+  this.displayNavbar();
+  this.displayDebugArea();
+  this._myCurrentContentView.display();
+  window.focus();
+};
+
+
+/**
+ * Re-creates the HTML for the chrome area containing the controls,
+ * and hands the HTML to the browser to be re-drawn.
+ *
+ * @scope    public instance method
+ */
+CompleteView.prototype.displayControlSpan = function () {
+  Util.assert(this.myMainControlSpanElement instanceof HTMLSpanElement);
+
+  var listOfStrings = [];
+  
+  var buttonValue = (this.myEditMode) ? &quot;View&quot; : &quot;Edit&quot;;
+  listOfStrings.push(&quot;&lt;input type=\&quot;button\&quot; class=\&quot;&quot; + CompleteView.ELEMENT_CLASS_PAGE_EDIT_BUTTON + &quot;\&quot; id=\&quot;&quot; + this.myEditButtonId + &quot;\&quot; name=\&quot;layout\&quot; value=\&quot;&quot; + buttonValue + &quot;\&quot;&gt;&lt;/input&gt;&quot;);
+
+  // write out the new control span content 
+  var finalString = listOfStrings.join(&quot;&quot;);
+  this.myMainControlSpanElement.innerHTML = finalString;
+
+  // add event handlers for the newly created control span UI elements
+  var editButton = document.getElementById(this.myEditButtonId);
+  editButton.onclick = CompleteView.clickOnEditButton;
+ 
+  // attach back-pointers to the newly created control span UI elements
+  editButton.mycompleteview = this;
+};
+
+
+/**
+ * Re-creates the HTML for the Navbar, and hands the HTML to the browser 
+ * to be re-drawn.
+ *
+ * @scope    public instance method
+ */
+CompleteView.prototype.displayNavbar = function () {
+  Util.assert(this.myNavbarDivElement instanceof HTMLDivElement);
+
+  var listOfStrings = [];
+
+  listOfStrings.push(&quot;&lt;ul class=\&quot;menu\&quot;&gt;&quot;);
+  
+  for (var uuid in this.myHashTableOfPagesKeyedByUuid) {
+    var page = this.myHashTableOfPagesKeyedByUuid[uuid];
+    var menuText = page.getShortName();
+    var menuUrl = CompleteView.URL_HASH_PAGE_PREFIX + page.getUuid();
+    listOfStrings.push(&quot;&lt;li class=\&quot;menu_item\&quot;&gt;&lt;a href=\&quot;&quot; + menuUrl + &quot;\&quot; onclick=\&quot;CompleteView.clickOnLocalLink(event)\&quot;&gt;&quot; + menuText + &quot;&lt;/a&gt;&lt;/li&gt;&quot;);
+  }
+
+  listOfStrings.push(&quot;&lt;/ul&gt;&quot;);
+  // listOfStrings.push(&quot;&lt;p&gt;&lt;a href=\&quot;<A HREF="http://www.opensource.org/\">http://www.opensource.org/\</A>&quot;&gt;&lt;img src=\&quot;osi-certified-60x50.png\&quot; width=\&quot;60\&quot; height=\&quot;50\&quot; alt=\&quot;OSI logo\&quot;&gt;&lt;/img&gt;&lt;/a&gt;&lt;/p&gt;&quot;);
+  
+  // write out the new control span content 
+  var finalString = listOfStrings.join(&quot;&quot;);
+  this.myNavbarDivElement.innerHTML = finalString;
+};
+
+
+/**
+ * Re-creates the HTML for the Debug area, and hands the HTML to the browser 
+ * to be re-drawn.
+ *
+ * @scope    public instance method
+ */
+CompleteView.prototype.displayDebugArea = function () {
+  Util.assert(this.myDebugDivElement instanceof HTMLDivElement);
+
+  var listOfStrings = [];
+  listOfStrings.push(&quot;&lt;textarea readonly id=\&quot;&quot; + CompleteView.ELEMENT_ID_DEBUG_TEXTAREA + &quot;\&quot; rows=\&quot;20\&quot; cols=\&quot;100\&quot; wrap=\&quot;virtual\&quot;&gt;&lt;/textarea&gt;&quot;);
+  var finalString = listOfStrings.join(&quot;&quot;);
+  this.myDebugDivElement.innerHTML = finalString;
+  this.myDebugTextarea = document.getElementById(CompleteView.ELEMENT_ID_DEBUG_TEXTAREA);
+}
+
+
+// -------------------------------------------------------------------
+// Debug Error Display Methods
+// -------------------------------------------------------------------
+
+
+/**
+ * Displays a text string in the status blurb span.
+ *
+ * @scope    public class method
+ */
+CompleteView.displayStatusBlurb = function (inText) {
+  CompleteView.ourSingleInstance.displayStatusBlurb(inText);
+};
+
+
+/**
+ * Displays a text string in the status blurb span.
+ *
+ * @scope    public instance method
+ */
+CompleteView.prototype.displayStatusBlurb = function (inText) {
+  this.myStatusBlurbSpanElement.innerHTML = inText;
+};
+
+
+/**
+ * Displays a text string in the debug textarea.
+ *
+ * @scope    public class method
+ */
+CompleteView.displayTextInDebugTextarea = function (inText) {
+  CompleteView.ourSingleInstance.displayTextInDebugTextarea(inText);
+};
+
+
+/**
+ * Displays a text string in the debug textarea.
+ *
+ * @scope    public instance method
+ */
+CompleteView.prototype.displayTextInDebugTextarea = function (inText) {
+  this.myNumberOfCallsToDebug++;
+  if (this.myNumberOfCallsToDebug &gt; 20) {
+    return;
+  }
+  this.myDebugTextarea.value += inText + &quot;\n\n============================\n\n&quot;;
+  this.myDebugTextarea.style.visibility = &quot;visible&quot;;
+  this.myDebugTextarea.style.display = &quot;block&quot;;
+  this.myDebugTextarea.scrollIntoView();
+};
+
+
+/**
+ * Given a JavaScript object, gets all the values of all the object's properties,
+ * and displays them in the debug textarea.
+ *
+ * @scope    public instance method
+ */
+CompleteView.prototype.displayObjectInDebugTextarea = function (inObject) {
+  var outputText = &quot;&quot;;
+  for (var property in inObject) {
+    outputText += property + &quot; == &quot; + inObject[property] + &quot;\n&quot;;
+  }
+  this.displayTextInDebugTextarea(outputText);
+}
+
+
+// -------------------------------------------------------------------
+// Event Handler Methods
+// -------------------------------------------------------------------
+
+/**
+ * Called when the user clicks on a menu item in the navbar, or on any other 
+ * auto-generated link that points to other Blue-sky content.
+ * 
+ * Called from an HTML &quot;li&quot; element or an HTML &quot;a&quot; element on a generated page.
+ * There is no need to call this method directly.
+ *
+ * @scope    public class method
+ */
+CompleteView.clickOnLocalLink = function (inEventObject) {
+  var eventObject = inEventObject;
+  if (!eventObject) { eventObject = window.event; }
+  
+  var startTiming = new Date();
+  var htmlAnchorElement = Util.getTargetFromEvent(eventObject);
+  
+  window.location = htmlAnchorElement.href;
+  CompleteView.ourSingleInstance.setCurrentContentViewFromUrl();
+  
+  var stopTiming = new Date();
+  var delayInMilliseconds = stopTiming.getTime() - startTiming.getTime();
+  CompleteView.ourSingleInstance.displayStatusBlurb(&quot;Page load: &quot; + delayInMilliseconds + &quot; milliseconds&quot;);
+};
+
+  
+/**
+ * Called when the user clicks on the big &quot;Edit&quot; button.
+ * 
+ * Called from an HTML &quot;input type='button'&quot; element on the generated page.  
+ * There is no need to call this method directly.
+ *
+ * @scope    public class method
+ */
+CompleteView.clickOnEditButton = function (inEventObject) {
+  var eventObject = inEventObject;
+  if (!eventObject) { eventObject = window.event; }
+  var editButton = Util.getTargetFromEvent(eventObject);
+  // FIX_ME: We could replace the lines above with &quot;var editButton = this;&quot;
+  // That would work fine in Firefox, but maybe it wouldn't work in other browsers?  
+
+  var completeView = editButton.mycompleteview;
+  var stevedore = completeView.getStevedore();
+  if (completeView.myEditMode) {
+    stevedore.endTransaction();
+  } else {
+    stevedore.beginTransaction();
+  }
+  completeView.myEditMode = !completeView.myEditMode;
+  completeView.display();
+  // completeView.displayTextInDebugTextarea(completeView.myEditMode);
+  if (!completeView.myEditMode &amp;&amp; window.location &amp;&amp; (window.location.protocol == &quot;file:&quot;)) {
+    CompleteView.displayTextInDebugTextarea(stevedore._getJsonStringRepresentingAllItems());
+  }
+};
+
+
+// -------------------------------------------------------------------
+// End of file
+// -------------------------------------------------------------------

Added: trunk/source/datastore.js
===================================================================
--- trunk/source/datastore.js	2005-03-24 23:11:51 UTC (rev 1)
+++ trunk/source/datastore.js	2005-03-24 23:22:45 UTC (rev 2)
@@ -0,0 +1,420 @@
+// Repository dump, in JSON format
+Stevedore._ourRepositoryInJsonFormat = {
+  &quot;format&quot;: &quot;2005_MARCH_ITEM_CENTRIC_LIST&quot;, 
+  &quot;timestamp&quot;: &quot;Wed Mar 16 2005 20:24:57 GMT-0800 (Pacific Standard Time)&quot;, 
+  &quot;data&quot;: [
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 101 },
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Short Name&quot; }, ],
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 143 }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 102 },
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Name&quot; }, ],
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 143 }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 103 },
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Summary&quot; }, ],
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 143 }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 104 },
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Body&quot; }, ],
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 143 }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 105 },
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Category&quot; }, ],
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 143 }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 106 },
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Userstamp&quot; }, ],
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 143 }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 107 },
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Timestamp&quot; }, ],
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 143 }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 108 },
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Section&quot; }, ],
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 143 }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 109 },
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Query&quot; }, ],
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 143 }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 110 },
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Matching Category&quot; }, ],
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 143 }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 111 },
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Matching Item&quot; }, ],
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 143 }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 112 },
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Layout Name&quot; }, ],
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 143 }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 143 },
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Attribute&quot; }, ],
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 144 }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 144 },
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Category&quot; }, ],
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 144 }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 145 },
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Page&quot; }, ],
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 144 }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 146 },
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Section&quot; }, ],
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 144 }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 147 },
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Query&quot; }, ],
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 144 }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 2000 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 145 }, ],
+    /* Short Name */   &quot;101&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;1. Welcome!&quot; }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Welcome to the Blue-sky demo!&quot; }, ],
+    /* Summary    */   &quot;103&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;This web site is a demo of the Blue-sky prototype. Blue-sky is a collaborative content management system. Blue-sky is a lot like a wiki, but with twist. Most wikis are designed to let you view and edit pages of text, like a web-based word processor. Blue-sky is designed to let you view and edit items in a database, rather than pages of text. So if a wiki is a web-based collaborative word-processor, then Blue-sky is a web-based collaborative database, like Lotus Agenda. To see more of this demo site, go to the menu bar at the left side of the window and click on the menu item for page 2, 'Books'.&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 3000 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 145 }, ],
+    /* Short Name */   &quot;101&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;2. Books&quot; }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Book Lists&quot; }, ],
+    /* Summary    */   &quot;103&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;In the lists on this page, each book is an item in the blue-sky repository. If you edit the page, you can change how each list of books is displayed.&quot; }, ],
+    /* Section    */   &quot;108&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 3010 }, { &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 3020 }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 3010 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 146 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;All Books&quot; }, ],
+    /* Layout     */   &quot;112&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Table&quot; }, ],
+    /* Query      */   &quot;109&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 3011 }, ],
+    /* Summary    */   &quot;103&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;This section shows a list of all the books in the repository.&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 3020 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 146 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;One Book&quot; }, ],
+    /* Layout     */   &quot;112&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Detail&quot; }, ],
+    /* Query      */   &quot;109&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 3021 }, ],
+    /* Summary    */   &quot;103&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;This section shows a just a single selected book. The section is populated using a query that asks for just a single book item.&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 3011 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 147 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Query for all books&quot; }, ],
+    /* Criteria   */   &quot;110&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 3104 }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 3021 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 147 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Query for one book&quot; }, ],
+    /* Criteria   */   &quot;111&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 3205 }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 3104 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 144 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Book&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 3205 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 3104 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;HTTP: The Definitive Guide&quot; }, ],
+    /* Author     */   &quot;3101&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;David Gourley and Brian Totty&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 3101 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 143 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Author&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 3102 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 143 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Publisher&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 3103 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 143 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;ISBN&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 3201 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 3104 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;The Transparent Society&quot; }, ],
+    /* Author     */   &quot;3101&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;David Brin&quot; }, ],
+    /* Publisher  */   &quot;3102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Perseus Publishing&quot; }, ],
+    /* ISBN       */   &quot;3103&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;0738201448&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 3202 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 3104 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;The Hobbit&quot; }, ],
+    /* Author     */   &quot;3101&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;J.R.R. Tolkien&quot; }, ],
+    /* Publisher  */   &quot;3102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;HarperCollins&quot; }, { &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Houghton Mifflin&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 3203 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 3104 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;The Wisdom of Crowds&quot; }, ],
+    /* Author     */   &quot;3101&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;James Surowiecki&quot; }, ],
+    /* ISBN       */   &quot;3103&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;0385503865&quot; }, ],
+    /* Publisher  */   &quot;3102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Doubleday&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 3204 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 3104 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Shrinking Violets and Caspar Milquetoasts&quot; }, ],
+    /* Author     */   &quot;3101&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Patricia A. McDaniel&quot; }, ],
+    /* ISBN       */   &quot;3103&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;0814756778&quot; }, ],
+    /* Publisher  */   &quot;3102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;NYU Press&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 4000 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 145 }, ],
+    /* Short Name */   &quot;101&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;3. Bug List&quot; }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Bugs and Features to Implement&quot; }, ],
+    /* Summary    */   &quot;103&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;This page is where I keep track of the programming work I need to do on the blue-sky software project. I'm keeping track of bugs that need to be fixed, as well as some of the new features that I want to implement before too long.&quot; }, ],
+    /* Section    */   &quot;108&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4010 }, { &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4020 }, { &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4030 }, { &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4040 }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 4010 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 146 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;All Features&quot; }, ],
+    /* Layout     */   &quot;112&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Outline&quot; }, ],
+    /* Query      */   &quot;109&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4011 }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 4020 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 146 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;All Bugs&quot; }, ],
+    /* Layout     */   &quot;112&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Outline&quot; }, ],
+    /* Query      */   &quot;109&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4021 }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 4030 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 146 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;All 'Closed' Bugs and Features&quot; }, ],
+    /* Layout     */   &quot;112&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Outline&quot; }, ],
+    /* Query      */   &quot;109&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4031 }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 4040 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 146 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;All 'Closed' Bugs&quot; }, ],
+    /* Layout     */   &quot;112&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Outline&quot; }, ],
+    /* Query      */   &quot;109&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4041 }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 4011 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 147 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Query for all features&quot; }, ],
+    /* Criteria   */   &quot;110&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4102 }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 4021 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 147 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Query for all bugs&quot; }, ],
+    /* Criteria   */   &quot;110&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4101 }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 4031 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 147 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Query for all closed items&quot; }, ],
+    /* Criteria   */   &quot;110&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4103 }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 4041 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 147 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Query for all closed bugs&quot; }, ],
+    /* Criteria   */   &quot;110&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4101 }, { &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4103 }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 4102 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 144 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Feature&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 4101 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 144 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Bug&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 4103 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 144 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Closed Tasks&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 4201 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4101 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;The browser's back button doesn't work after you click from page to page in the navbar.&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 4202 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4101 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;When editing an item in a table view, everything you enter is treated as a string literal. If you enter 'Book' in the column for 'Category', that does not make your item into a Book.&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 4203 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4101 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;After editing an item in a table view, the section queries should be re-evalutated to see if membership has changed.&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 4204 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4101 }, { &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4103 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;If an item has an attribute value with some HTML in it, like '&lt;cite&gt;', we incorrectly render it like '&amp; lt;cite&amp; gt;' instead of '&lt;cite&gt;'&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 4205 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4101 }, { &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4103 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Store only 'clean' text in the repository. Do cleaning on data entry, not on data display. Clean means no stuff like &lt; and &gt; and double-quotes&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 4302 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4102 }, { &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4103 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Have an 'All Items' page&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 4302 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4102 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Make it possible for a text string to contain a reference to an item&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 4304 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4102 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Make it possible to assign items to categories -- allow for entering reference-values, not just string-values&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 4305 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4102 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Allow for entering number-values, not just string-values&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 4306 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4102 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Have table mode show multi-valued attributes&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 4307 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4102 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;When you assign a value to an item, mark it with a timestamp&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 4308 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4102 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Clean up all the code that assumes single-valued attributes -- search for '[0]'&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 4309 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4102 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Be able to create new pages&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 4310 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4102 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Be able to add a new section to a page&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 4311 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4102 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Observable queries: all items, limited to a requested subset based on kind and category (e.g. 'All fiction books')&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 4312 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4102 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Observable queries: limit results to just a requested subset of the attributes (e.g. just the names of the books)&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 4313 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4102 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Be able to edit the query of a section&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 4314 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4102 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Make it possible to add new attributes to a table view&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 4315 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4102 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Figure out how to declare dependencies more rigorously, and then have automatic unit tests that verify the dependencies.&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 4316 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4102 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;URLs with anchor-dot-notation: <A HREF="http://www.foo.org/item.html#573.654.765">http://www.foo.org/item.html#573.654.765</A>&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 4317 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4102 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Support for reference-values as well as string-values&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 4318 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4102 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Write unit tests using jsunit&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 4319 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4102 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Try to write a unit test that calls jslint&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 4320 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4102 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;In 'Outline' layout, have controls to optionally show more detail&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 4321 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4102 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Add 'Table' layout controls for row sorting, column re-arranging, column hiding, etc.&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 4322 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4102 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;In 'Outline' layout, be able to group by category&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 4323 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4102 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;In 'Table' layout, be able to group by category&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 4324 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4102 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Be able to edit in outline mode&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 4325 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4102 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Set up a subversion server and have the blue-sky code publicly available&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 5000 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 145 }, ],
+    /* Short Name */   &quot;101&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;4. Charities&quot; }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Charities&quot; }, ],
+    /* Section    */   &quot;108&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 5010 }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 5010 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 146 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;All Charities&quot; }, ],
+    /* Layout     */   &quot;112&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Bar Chart&quot; }, ],
+    /* Query      */   &quot;109&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 5011 }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 5011 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 147 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Query for all charities&quot; }, ],
+    /* Criteria   */   &quot;110&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 5101 }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 5101 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 144 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Charity&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 5102 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 143 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;2003 Expenses (in $US million)&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 5201 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 5101 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;The Global Fund for Women&quot; }, ],
+    /* 2003 Expen */   &quot;5102&quot;: [{ &quot;type&quot;: &quot;NumberValue&quot;, &quot;value&quot;: 8.2 }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 5202 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 5101 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Pathfinder International&quot; }, ],
+    /* 2003 Expen */   &quot;5102&quot;: [{ &quot;type&quot;: &quot;NumberValue&quot;, &quot;value&quot;: 44.9 }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 5203 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 5101 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;The Global Fund to Fight AIDS, TB, and Malaria&quot; }, ],
+    /* 2003 Expen */   &quot;5102&quot;: [{ &quot;type&quot;: &quot;NumberValue&quot;, &quot;value&quot;: 64.7 }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 5204 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 3104 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;The Gumption Memo&quot; }, ],
+    /* Author     */   &quot;3101&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Brian Skinner&quot; }, ],
+    /* Publisher  */   &quot;3102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Kinkos&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 5205 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 3104 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Deceit and Denial&quot; }, ],
+    /* Author     */   &quot;3101&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Gerald Markowitz and David Rosner&quot; }, ],
+    /* Publisher  */   &quot;3102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;University of California&quot; }, ],
+    /* ISBN       */   &quot;3103&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;0520240634&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 5207 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4102 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Have a 'Find' UI that does keystroke-by-keystroke filtering&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 5208 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4102 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Be able to 'delete' items (or mark them as 'dead' or 'defunct' or something)&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 5209 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 4102 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Make view.display() *not* re-create all the HTML every time&quot; }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 6000 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 145 }, ],
+    /* Short Name */   &quot;101&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;5. All Items&quot; }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;All Items&quot; }, ],
+    /* Section    */   &quot;108&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 6010 }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 6010 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 146 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;All Items&quot; }, ],
+    /* Layout     */   &quot;112&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Table&quot; }, ],
+    /* Query      */   &quot;109&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 6011 }, ],
+  },
+  { &quot;100&quot;: { &quot;type&quot;: &quot;Uuid&quot;, &quot;value&quot;: 6011 },
+    /* Category   */   &quot;105&quot;: [{ &quot;type&quot;: &quot;ForeignUuid&quot;, &quot;value&quot;: 147 }, ],
+    /* Name       */   &quot;102&quot;: [{ &quot;type&quot;: &quot;StringValue&quot;, &quot;value&quot;: &quot;Query for all items&quot; }, ],
+  },
+]};
+

Added: trunk/source/detail_layout.js
===================================================================
--- trunk/source/detail_layout.js	2005-03-24 23:11:51 UTC (rev 1)
+++ trunk/source/detail_layout.js	2005-03-24 23:22:45 UTC (rev 2)
@@ -0,0 +1,142 @@
+/*****************************************************************************
+ detail_layout.js
+ 
+******************************************************************************
+ Written in 2005 by Brian Douglas Skinner &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openrecord-svn">brian.skinner at gumption.org</A>&gt;
+  
+ Copyright rights relinquished under the Creative Commons  
+ Public Domain Dedication:
+    <A HREF="http://creativecommons.org/licenses/publicdomain/">http://creativecommons.org/licenses/publicdomain/</A>
+  
+ You can copy freely from this file.  This work may be freely reproduced, 
+ distributed, transmitted, used, modified, built upon, or otherwise exploited
+ by anyone for any purpose.
+  
+ This work is provided on an &quot;AS IS&quot; basis, without warranties or conditions 
+ of any kind, either express or implied, including, without limitation, any 
+ warranties or conditions of title, non-infringement, merchantability, or 
+ fitness for a particular purpose. You are solely responsible for determining 
+ the appropriateness of using or distributing the work and assume all risks 
+ associated with use of this work, including but not limited to the risks and 
+ costs of errors, compliance with applicable laws, damage to or loss of data 
+ or equipment, and unavailability or interruption of operations.
+
+ In no event shall the authors or contributors have any liability for any 
+ direct, indirect, incidental, special, exemplary, or consequential damages,
+ however caused and on any theory of liability, whether in contract, strict 
+ liability, or tort (including negligence), arising in any way out of or in 
+ connection with the use or distribution of the work.
+*****************************************************************************/
+
+
+// -------------------------------------------------------------------
+// Dependencies:
+//   repository.js
+//   section_view.js
+//   util.js
+// -------------------------------------------------------------------
+
+
+// -------------------------------------------------------------------
+// Register this layout type in the SectionView registry
+// -------------------------------------------------------------------
+SectionView.ourHashTableOfLayoutClassesKeyedByLayoutName[SectionView.LAYOUT_DETAIL] = DetailLayout;
+
+
+// -------------------------------------------------------------------
+// new DetailLayout()
+//   public instance constructor
+// -------------------------------------------------------------------
+function DetailLayout(inSuperView) {
+  Util.assert((inSuperView instanceof SectionView) || (inSuperView instanceof ItemView));
+  
+  this.mySuperView = inSuperView;
+  this.myDivElement = null;
+}
+
+
+// -------------------------------------------------------------------
+// detailLayout.getLayoutName()
+//   public instance method
+// -------------------------------------------------------------------
+DetailLayout.prototype.getLayoutName = function () {
+  return SectionView.LAYOUT_DETAIL;
+};
+
+  
+// -------------------------------------------------------------------
+// detailLayout.setDivElement()
+//   public instance method
+// -------------------------------------------------------------------
+DetailLayout.prototype.setDivElement = function (inDivElement) {
+  Util.assert(inDivElement instanceof HTMLDivElement);
+  
+  this.myDivElement = inDivElement;
+  this.display();
+};
+
+
+// -------------------------------------------------------------------
+// detailLayout.display()
+//   public method
+// -------------------------------------------------------------------
+DetailLayout.prototype.display = function () {
+  var listOfStrings = [];
+
+  // for each content item, add its HTML representation to the output
+  var listOfContentItems = this.mySuperView.getListOfContentItems();
+  for (var contentItemKey in listOfContentItems) {
+    var contentItem = listOfContentItems[contentItemKey];
+    listOfStrings.push(this.getXhtmlTableForItem(contentItem));
+    listOfStrings.push(&quot;&lt;p&gt;&nbsp;&lt;/p&gt;&quot;);
+  }
+
+  // take all the HTML and put it together
+  var finalString = listOfStrings.join(&quot;&quot;);
+  this.myDivElement.innerHTML = finalString;
+};
+
+
+// -------------------------------------------------------------------
+// detailLayout.getXhtmlTableForItem()
+//   public instance method
+// -------------------------------------------------------------------
+DetailLayout.prototype.getXhtmlTableForItem = function (inItem) {
+  Util.assert(inItem instanceof Item);
+  
+  var listOfStrings = [];
+  var stevedore = this.mySuperView.getStevedore();
+  var attributeCalledName = stevedore.getItemFromUuid(Stevedore.UUID_FOR_ATTRIBUTE_NAME);
+  
+  listOfStrings.push(&quot;&lt;table class=\&quot;&quot; + SectionView.ELEMENT_CLASS_SIMPLE_TABLE + &quot;\&quot;&gt;&quot;);
+  listOfStrings.push(&quot;&lt;tr&gt;&quot;);
+  listOfStrings.push(&quot;&lt;td class=\&quot;&quot; + SectionView.ELEMENT_CLASS_LABEL + &quot; &quot; + SectionView.ELEMENT_CLASS_TITLE + &quot;\&quot;&gt;&quot; + attributeCalledName.getDisplayName() + &quot;&lt;/td&gt;&quot;);
+  listOfStrings.push(&quot;&lt;td class=\&quot;&quot; + SectionView.ELEMENT_CLASS_TITLE + &quot;\&quot;&gt;&quot; + inItem.getDisplayName() + &quot;&lt;/td&gt;&quot;);
+  listOfStrings.push(&quot;&lt;/tr&gt;&quot;);
+  var listOfAttributeUuids = inItem.getListOfAttributeUuids();
+  for (var key in listOfAttributeUuids) { 
+    var attributeUuid = listOfAttributeUuids[key];
+    if (attributeUuid != attributeCalledName.getUuid()) {
+      listOfStrings.push(&quot;&lt;tr&gt;&quot;);
+      var attribute = stevedore.getItemFromUuid(attributeUuid);
+      listOfStrings.push(&quot;&lt;td class=\&quot;&quot; + SectionView.ELEMENT_CLASS_LABEL + &quot;\&quot;&gt;&quot; + attribute.getDisplayName() + &quot;&lt;/td&gt;&quot;);
+      var valueList = inItem.getValueListFromAttribute(attributeUuid); 
+      listOfStrings.push(&quot;&lt;td class=\&quot;&quot; + SectionView.ELEMENT_CLASS_PLAIN + &quot;\&quot;&gt;&quot;);
+      for (var j = 0; j &lt; valueList.length; ++j) {
+        listOfStrings.push(SectionView.getStringForValue(valueList[j]) + &quot;&lt;br/&gt;&quot;);
+      }
+      listOfStrings.push(&quot;&lt;/td&gt;&quot;);
+      listOfStrings.push(&quot;&lt;/tr&gt;&quot;);
+    }
+  }
+  listOfStrings.push(&quot;&lt;/table&gt;&quot;);
+
+  // return all the new content
+  var finalString = listOfStrings.join(&quot;&quot;);
+  return finalString;
+};
+
+
+// -------------------------------------------------------------------
+// End of file
+// -------------------------------------------------------------------

Added: trunk/source/item.js
===================================================================
--- trunk/source/item.js	2005-03-24 23:11:51 UTC (rev 1)
+++ trunk/source/item.js	2005-03-24 23:22:45 UTC (rev 2)
@@ -0,0 +1,369 @@
+/*****************************************************************************
+ item.js
+ 
+******************************************************************************
+ Written in 2005 by Brian Douglas Skinner &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openrecord-svn">brian.skinner at gumption.org</A>&gt;
+  
+ Copyright rights relinquished under the Creative Commons  
+ Public Domain Dedication:
+    <A HREF="http://creativecommons.org/licenses/publicdomain/">http://creativecommons.org/licenses/publicdomain/</A>
+  
+ You can copy freely from this file.  This work may be freely reproduced, 
+ distributed, transmitted, used, modified, built upon, or otherwise exploited
+ by anyone for any purpose.
+  
+ This work is provided on an &quot;AS IS&quot; basis, without warranties or conditions 
+ of any kind, either express or implied, including, without limitation, any 
+ warranties or conditions of title, non-infringement, merchantability, or 
+ fitness for a particular purpose. You are solely responsible for determining 
+ the appropriateness of using or distributing the work and assume all risks 
+ associated with use of this work, including but not limited to the risks and 
+ costs of errors, compliance with applicable laws, damage to or loss of data 
+ or equipment, and unavailability or interruption of operations.
+
+ In no event shall the authors or contributors have any liability for any 
+ direct, indirect, incidental, special, exemplary, or consequential damages,
+ however caused and on any theory of liability, whether in contract, strict 
+ liability, or tort (including negligence), arising in any way out of or in 
+ connection with the use or distribution of the work.
+*****************************************************************************/
+
+ 
+// -------------------------------------------------------------------
+// Dependencies:
+//   util.js
+//   stevedore.js
+// -------------------------------------------------------------------
+
+
+/**
+ * Instances of the Item class know how to store and retrieve their
+ * attribute values.
+ *
+ * @scope    public instance constructor
+ */
+function Item(inStevedore, inUuid) {
+  Util.assert(!inUuid || Util.isNumeric(inUuid));
+  
+  this._myStevedore = inStevedore;
+  this._myUuid = inUuid;
+  this._myListOfObservers = [];
+  this._myHashTableOfAssignmentsKeyedByAttributeUuid = {};
+}
+
+
+/**
+ * Returns the display name of the item.
+ *
+ * @scope    public instance method
+ * @return   A string with a display name for the item.
+ */
+Item.prototype.toString = function () {
+  var returnString = &quot;[Item #&quot; + this.getUuid() + &quot; &quot;;
+  var listOfCategories = this.getValueListFromAttribute(Stevedore.UUID_FOR_ATTRIBUTE_CATEGORY);
+  for (var key in listOfCategories) {
+    var category = listOfCategories[key];
+    Util.assert(category instanceof Item);
+    returnString += &quot;(&quot; + category.getDisplayName() + &quot;)&quot;;
+  }
+  returnString += &quot; \&quot;&quot; + this.getDisplayName() + &quot;\&quot;&quot; + &quot;]&quot;;
+  return returnString; 
+};
+
+
+// -------------------------------------------------------------------
+// Attribute Accessor Methods
+// -------------------------------------------------------------------
+
+/**
+ * Returns the display name of the item.
+ *
+ * @scope    public instance method
+ * @return   A string with a display name for the item.
+ */
+Item.prototype.getDisplayName = function (inDefaultString) {
+  return this._getStringUsingNameAttributes(Stevedore.UUID_FOR_ATTRIBUTE_NAME, null, inDefaultString);
+};
+  
+  
+/**
+ * Returns a short display name for the item.
+ *
+ * @scope    public instance method
+ * @return   A string with a short display name for the item.
+ */
+Item.prototype.getShortName = function (inDefaultString) {
+  return this._getStringUsingNameAttributes(Stevedore.UUID_FOR_ATTRIBUTE_SHORT_NAME, Stevedore.UUID_FOR_ATTRIBUTE_NAME, inDefaultString);
+};
+
+
+/**
+ * Given an attribute, this method returns the list of values that 
+ * have been assigned to that attribute for this item.
+ *
+ * For example, to find out what color Kermit is: 
+ * &lt;pre&gt;
+ *    var valueList = kermit.getValueListFromAttribute(color);
+ *    for (var i = 0; i &lt; valueList.length; ++i) {
+ *      alert(&quot;Kermit is &quot; + valueList[i]);
+ *    }
+ * &lt;/pre&gt;
+ *
+ * @scope    public instance method
+ * @param    inAttribute    The object to be removed from the set of observers. 
+ */
+Item.prototype.getValueListFromAttribute = function (inAttribute) {
+  Util.assert(Util.isHashTable(this._myHashTableOfAssignmentsKeyedByAttributeUuid));
+  
+  var attributeUuid = this._myStevedore.getAttributeUuidFromAttributeOrUuid(inAttribute);
+  // FIX_ME: 
+  //   If this item isn't yet fully loaded into the cache, then we might need 
+  //   to ask our stevedore to get the attribute values for us.
+  var valueList = this._myHashTableOfAssignmentsKeyedByAttributeUuid[attributeUuid];
+  return (valueList || null);
+};
+
+
+/**
+ * Assigns a value to an attribute in this item.
+ *
+ * Given an attribute and a value, assigns that value to the
+ * attribute of the item. For example, to make a Kermit green:
+ * &lt;pre&gt;
+ *    kermit.assign(color, &quot;green&quot;);
+ * &lt;/pre&gt;
+ * Attributes can always have more than one assigned value, so
+ * you can make Kermit be both blue and green by doing:
+ * &lt;pre&gt;
+ *    kermit.assign(color, &quot;green&quot;);
+ *    kermit.assign(color, &quot;blue&quot;);
+ * &lt;/pre&gt;
+ *
+ * @scope    public instance method
+ * @param    inAttribute    The attribute to assign the value to, or the UUID of the attribute. 
+ * @param    inValue    The value to be assigned. 
+ */
+Item.prototype.assign = function (inAttribute, inValue) {
+  var cleanValue = inValue;
+  // alert(&quot;assign(&quot; + inAttribute + &quot;, &quot; + inValue + &quot;)&quot;);
+  if (Util.isString(inValue)) {
+    var cleanValue = Util.getCleanString(inValue);
+  }
+  var valueWasSet = this._initializeAttributeValue(inAttribute, cleanValue);
+  if (valueWasSet) {
+    this._myStevedore.markDirty(this);
+  }
+  // FIX_ME: 
+  //   We also need to create a change object, and we need to tell 
+  //   this._myStevedore about the change.
+  this._notifyObservers();
+};
+
+
+/**
+ * Given an attribute, removes that attribute from the item's list
+ * of attributes that have values assigned.
+ *
+ * @scope    public instance method
+ * @param    inAttribute    The attribute to clear, or the UUID of the attribute. 
+ * @return   Returns true if there was an existing attribute value to clear.
+ */
+Item.prototype.clear = function (inAttribute) {
+  Util.assert(Util.isHashTable(this._myHashTableOfAssignmentsKeyedByAttributeUuid));
+
+  var valueWasDeleted = false;
+  var attributeUuid = this._myStevedore.getAttributeUuidFromAttributeOrUuid(inAttribute);
+  var currentValueList = this._myHashTableOfAssignmentsKeyedByAttributeUuid[attributeUuid];
+  if (currentValueList &amp;&amp; (currentValueList.length &gt; 0)) {
+    this._myHashTableOfAssignmentsKeyedByAttributeUuid[attributeUuid] = null;
+    valueWasDeleted = true;
+    this._myStevedore.markDirty(this);
+  }
+  
+  // FIX_ME: 
+  //   We also need to create a change object, and we need to tell 
+  //   this._myStevedore about the change.
+  this._notifyObservers();
+  
+  return valueWasDeleted;
+};
+
+
+// -------------------------------------------------------------------
+// Non-Attribute Accessor Methods
+// -------------------------------------------------------------------
+
+/**
+ * Returns the UUID of the item.
+ *
+ * @scope    public instance method
+ * @return   The UUID of the item.
+ */
+Item.prototype.getUuid = function () {
+  return this._myUuid;
+};
+
+
+/**
+ * Returns a list of the UUIDs for all the attributes that this item
+ * has values assigned to.
+ *
+ * @scope    public instance method
+ * @return   A list of UUIDs of attribute items.
+ */
+Item.prototype.getListOfAttributeUuids = function () {
+  var listOfAttributeUuids = [];
+  for (var attributeUuid in this._myHashTableOfAssignmentsKeyedByAttributeUuid) {
+    listOfAttributeUuids.push(attributeUuid);
+  }
+  return listOfAttributeUuids;
+};
+
+
+/**
+ * Given a category, returns &quot;true&quot; if the item has been assigned to 
+ * that category.
+ *
+ * Also returns true if the item has been assigned to some category which is in
+ * turn assigned to the given category, and so on, up the chain of category 
+ * assignments.
+ *
+ * @scope    public instance method
+ * @return   A boolean.  True if the item has been assigned to the category.
+ */
+Item.prototype.isInCategory = function (inCategory) {
+  Util.assert(inCategory instanceof Item);
+
+  var valueList = this.getValueListFromAttribute(Stevedore.UUID_FOR_ATTRIBUTE_CATEGORY);
+  var key;
+  var value;
+  
+  // look at all the categories this item is assigned to, and see if one of them is &quot;inCategory&quot;
+  for (key in valueList) {
+    value = valueList[key];
+    if (value == inCategory) {
+      return true;
+    }
+  }
+  
+  // look at all the categories this item is assigned to, and see if one of them
+  // is in turn in the categoery &quot;inCategory&quot;
+  for (key in valueList) {
+    value = valueList[key];
+    // FIX_ME: 
+    //   This will go into an infinite loop if there is ever a cycle in the category 
+    //   assignments, like: A is in category B, and B is in C, and C is in A.
+    //   We need to use a non-recursive search of the graph.
+    // FIX_ME:
+    //   Do we also need to register as an observer of something, so that if we later
+    //   become a member of that category in question, then we can notify whoever
+    //   is observing us?
+    if ((value != this) &amp;&amp; (value.isInCategory(inCategory))) {
+      return true;
+    }
+  }
+  return false;
+};
+ 
+
+// -------------------------------------------------------------------
+// Observer/Observable Methods
+// -------------------------------------------------------------------
+
+/**
+ * Given an object, registers the object as an observer of this item, so that
+ * the object will be notified when the item changes.
+ *
+ * @scope    public instance method
+ * @param    inObserver    An object to be registered as an observer of the item. 
+ */
+Item.prototype.addObserver = function (inObserver) {
+  Util.addObjectToSet(inObserver, this._myListOfObservers);
+};
+
+
+/**
+ * Given an object, removes that object from the set of observers of this item, so 
+ * that the object will no longer be notified when the item changes.
+ *
+ * @scope    public instance method
+ * @param    inObserver    The object to be removed from the set of observers. 
+ */
+Item.prototype.removeObserver = function (inObserver) {
+  Util.removeObjectFromSet(inObserver, this._myListOfObservers);
+};
+
+
+// -------------------------------------------------------------------
+// Private Methods
+// -------------------------------------------------------------------
+
+/**
+ * Set the value of an attribute when the item is first being loaded
+ * by the Stevedore.
+ *
+ * @scope    private instance method
+ * @param    inAttribute    The attribute to assign the value to, or the UUID of the attribute. 
+ * @param    inValue    The value to be assigned. 
+ * @return   Returns true if the value was assigned.
+ */
+Item.prototype._initializeAttributeValue = function (inAttribute, inValue) {
+  Util.assert(Util.isHashTable(this._myHashTableOfAssignmentsKeyedByAttributeUuid));
+
+  var attributeUuid = this._myStevedore.getAttributeUuidFromAttributeOrUuid(inAttribute);
+  if (!this._myHashTableOfAssignmentsKeyedByAttributeUuid[attributeUuid]) {
+    this._myHashTableOfAssignmentsKeyedByAttributeUuid[attributeUuid] = [];
+  }
+  // var 
+  var valueList = this._myHashTableOfAssignmentsKeyedByAttributeUuid[attributeUuid];
+  var valueWasAddedFlag = Util.addObjectToSet(inValue, valueList);
+  return valueWasAddedFlag;
+};
+
+
+/**
+ * Returns some display name for the item, drawing on both the &quot;name&quot; and
+ * &quot;short name&quot; attributes.
+ *
+ * @scope    private instance method
+ * @return   A string with a display name for the item.
+ */
+Item.prototype._getStringUsingNameAttributes = function (inPrimaryAttributeUuid, inSecondaryAttributeUuid, inDefaultString) {
+  var returnString = null;
+  var nameList = this.getValueListFromAttribute(inPrimaryAttributeUuid);
+  if (nameList) {
+    returnString = nameList[0];
+  }
+  if (!returnString &amp;&amp; inSecondaryAttributeUuid) {
+    nameList = this.getValueListFromAttribute(inSecondaryAttributeUuid);
+    if (nameList) {
+      returnString = nameList[0];
+    }
+  }
+  if (!returnString) {
+    returnString = inDefaultString;
+  }
+  if (!returnString) {
+    returnString = &quot;&quot;;
+  }
+  return returnString;
+};
+  
+
+/**
+ * Sends messages to all the registered observers to let them know that
+ * this item has changed.
+ *
+ * @scope    private instance method
+ */
+Item.prototype._notifyObservers = function () {
+  for (var key in this._myListOfObservers) {
+    var observer = this._myListOfObservers[key];
+    observer.observedItemHasChanged(this);
+  }
+};
+
+
+// -------------------------------------------------------------------
+// End of file
+// -------------------------------------------------------------------

Added: trunk/source/item_view.js
===================================================================
--- trunk/source/item_view.js	2005-03-24 23:11:51 UTC (rev 1)
+++ trunk/source/item_view.js	2005-03-24 23:22:45 UTC (rev 2)
@@ -0,0 +1,164 @@
+/*****************************************************************************
+ item_view.js
+ 
+******************************************************************************
+ Written in 2005 by Brian Douglas Skinner &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openrecord-svn">brian.skinner at gumption.org</A>&gt;
+  
+ Copyright rights relinquished under the Creative Commons  
+ Public Domain Dedication:
+    <A HREF="http://creativecommons.org/licenses/publicdomain/">http://creativecommons.org/licenses/publicdomain/</A>
+  
+ You can copy freely from this file.  This work may be freely reproduced, 
+ distributed, transmitted, used, modified, built upon, or otherwise exploited
+ by anyone for any purpose.
+  
+ This work is provided on an &quot;AS IS&quot; basis, without warranties or conditions 
+ of any kind, either express or implied, including, without limitation, any 
+ warranties or conditions of title, non-infringement, merchantability, or 
+ fitness for a particular purpose. You are solely responsible for determining 
+ the appropriateness of using or distributing the work and assume all risks 
+ associated with use of this work, including but not limited to the risks and 
+ costs of errors, compliance with applicable laws, damage to or loss of data 
+ or equipment, and unavailability or interruption of operations.
+
+ In no event shall the authors or contributors have any liability for any 
+ direct, indirect, incidental, special, exemplary, or consequential damages,
+ however caused and on any theory of liability, whether in contract, strict 
+ liability, or tort (including negligence), arising in any way out of or in 
+ connection with the use or distribution of the work.
+*****************************************************************************/
+
+
+// -------------------------------------------------------------------
+// Dependencies:
+//   repository.js
+//   util.js
+//   complete_view.js
+//   detail_layout.js
+// -------------------------------------------------------------------
+
+
+// -------------------------------------------------------------------
+// ItemView public class constants
+// -------------------------------------------------------------------
+ItemView.ELEMENT_ID_DETAIL_DIV_PREFIX = &quot;detail_layout_div_for_item_&quot;;
+
+
+// -------------------------------------------------------------------
+// ItemView class properties
+// -------------------------------------------------------------------
+// none
+
+
+/**
+ * The CompleteView uses an instance of a ItemView to display an Item in the
+ * browser window.
+ *
+ * @scope    public instance constructor
+ * @param    inItem    The item to be displayed by this view. 
+ * @param    inDivElement    The HTMLDivElement to display the HTML in. 
+ * @param    inCompleteView    The CompleteView that this ItemView is nested in. 
+ */
+function ItemView(inItem, inDivElement, inCompleteView) {
+  Util.assert(inItem instanceof Item);
+  Util.assert(inDivElement instanceof HTMLDivElement);
+  Util.assert(inCompleteView instanceof CompleteView);
+
+  // instance properties
+  this.myItem = inItem;
+  this.myDivElement = inDivElement;
+  this.myCompleteView = inCompleteView;
+  this.myLayout = new DetailLayout(this);
+}
+
+
+/**
+ * Returns the stevedore object that's supplying our data items.
+ *
+ * @scope    public instance method
+ * @return   The stevedore object.
+ */
+ItemView.prototype.getStevedore = function () {
+  return this.myCompleteView.getStevedore();
+};
+
+
+/**
+ * Returns a list with a single content item in it.
+ *
+ * @scope    public instance method
+ * @return   A list with one item in it.
+ */
+ItemView.prototype.getListOfContentItems = function () {
+  var listOfContentItems = [];
+  listOfContentItems.push(this.myItem);
+  return listOfContentItems;
+};
+
+
+/**
+ * Returns true if we are in Edit Mode.
+ *
+ * @scope    public instance method
+ * @return   A boolean value. True if we are in Edit Mode.
+ */
+ItemView.prototype.isInEditMode = function () {
+  return this.myCompleteView.isInEditMode();
+};
+
+  
+/**
+ * Returns a string that gives the name of the page.
+ *
+ * @scope    public instance method
+ * @return   A string that gives the name of the page.
+ */
+ItemView.prototype.getPageTitle = function () {
+  return this.myItem.getShortName();
+};
+
+
+/**
+ * Hides the ItemView by setting the div element's display style to &quot;none&quot;.
+ *
+ * @scope    public instance method
+ */
+ItemView.prototype.hide = function () {
+  Util.assert(this.myDivElement instanceof HTMLDivElement);
+  this.myDivElement.style.display = &quot;none&quot;;
+};
+
+
+/**
+ * Re-creates all the HTML for the ItemView, and hands the HTML to the 
+ * browser to be re-drawn.
+ *
+ * @scope    public instance method
+ */
+ItemView.prototype.display = function () {
+  Util.assert(this.myItem instanceof Item);
+  Util.assert(this.myDivElement instanceof HTMLDivElement);
+  
+  var listOfStrings = [];
+
+  // add an &lt;h1&gt; heading with the name of the page
+  listOfStrings.push(&quot;&lt;h1 id=\&quot;&quot; + CompleteView.URL_ITEM_PREFIX + this.myItem.getUuid() + &quot;\&quot;&gt;&quot; + this.myItem.getDisplayName() + &quot;&lt;/h1&gt;&quot;);
+
+  // add a &lt;div&gt; element for the detail layout
+  var detailDivId = ItemView.ELEMENT_ID_DETAIL_DIV_PREFIX + this.myItem.getUuid();
+  listOfStrings.push(&quot;&lt;div id=\&quot;&quot; + detailDivId + &quot;\&quot;&gt;&lt;/div&gt;&quot;);
+
+  // write out all the new content 
+  var finalString = listOfStrings.join(&quot;&quot;);
+  this.myDivElement.innerHTML = finalString;
+  this.myDivElement.style.display = &quot;block&quot;;
+
+  // let the detailLayout add its own content
+  var detailLayoutDivElement = document.getElementById(detailDivId);
+  this.myLayout.setDivElement(detailLayoutDivElement);
+};
+
+
+// -------------------------------------------------------------------
+// End of file
+// -------------------------------------------------------------------

Added: trunk/source/outline_layout.js
===================================================================
--- trunk/source/outline_layout.js	2005-03-24 23:11:51 UTC (rev 1)
+++ trunk/source/outline_layout.js	2005-03-24 23:22:45 UTC (rev 2)
@@ -0,0 +1,106 @@
+/*****************************************************************************
+ outline_layout.js
+ 
+******************************************************************************
+ Written in 2005 by Brian Douglas Skinner &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openrecord-svn">brian.skinner at gumption.org</A>&gt;
+  
+ Copyright rights relinquished under the Creative Commons  
+ Public Domain Dedication:
+    <A HREF="http://creativecommons.org/licenses/publicdomain/">http://creativecommons.org/licenses/publicdomain/</A>
+  
+ You can copy freely from this file.  This work may be freely reproduced, 
+ distributed, transmitted, used, modified, built upon, or otherwise exploited
+ by anyone for any purpose.
+  
+ This work is provided on an &quot;AS IS&quot; basis, without warranties or conditions 
+ of any kind, either express or implied, including, without limitation, any 
+ warranties or conditions of title, non-infringement, merchantability, or 
+ fitness for a particular purpose. You are solely responsible for determining 
+ the appropriateness of using or distributing the work and assume all risks 
+ associated with use of this work, including but not limited to the risks and 
+ costs of errors, compliance with applicable laws, damage to or loss of data 
+ or equipment, and unavailability or interruption of operations.
+
+ In no event shall the authors or contributors have any liability for any 
+ direct, indirect, incidental, special, exemplary, or consequential damages,
+ however caused and on any theory of liability, whether in contract, strict 
+ liability, or tort (including negligence), arising in any way out of or in 
+ connection with the use or distribution of the work.
+*****************************************************************************/
+
+
+// -------------------------------------------------------------------
+// Dependencies:
+//   repository.js
+//   section_view.js
+// -------------------------------------------------------------------
+
+
+// -------------------------------------------------------------------
+// Register this layout type in the SectionView registry
+// -------------------------------------------------------------------
+SectionView.ourHashTableOfLayoutClassesKeyedByLayoutName[SectionView.LAYOUT_OUTLINE] = OutlineLayout;
+
+
+// -------------------------------------------------------------------
+// new OutlineLayout()
+//   public instance constructor
+// -------------------------------------------------------------------
+function OutlineLayout(inSectionView) {
+  Util.assert(inSectionView instanceof SectionView);
+
+  this.mySectionView = inSectionView;
+  this.myDivElement = null;
+}
+
+
+// -------------------------------------------------------------------
+// outlineLayout.getLayoutName()
+//   public instance method
+// -------------------------------------------------------------------
+OutlineLayout.prototype.getLayoutName = function () {
+  return SectionView.LAYOUT_OUTLINE;
+};
+
+  
+// -------------------------------------------------------------------
+// outlineLayout.setDivElement()
+//   public instance method
+// -------------------------------------------------------------------
+OutlineLayout.prototype.setDivElement = function (inDivElement) {
+  Util.assert(inDivElement instanceof HTMLDivElement);
+
+  this.myDivElement = inDivElement;
+  this.display();
+};
+
+
+// -------------------------------------------------------------------
+// outlineLayout.display()
+//   public method
+// -------------------------------------------------------------------
+OutlineLayout.prototype.display = function () {
+  var listOfStrings = [];
+
+  var listOfContentItems = this.mySectionView.getListOfContentItems();
+  listOfStrings.push(&quot;&lt;ul&gt;&quot;);
+  // for each content item, add its HTML representation to the output
+  for (var contentItemKey in listOfContentItems) {
+    var contentItem = listOfContentItems[contentItemKey];
+    listOfStrings.push(&quot;&lt;li&gt;&quot;);
+    listOfStrings.push(contentItem.getDisplayName(&quot;{no name}&quot;));
+    // FIX_ME: Why do I have to provide an onclick handler to get these links to work?
+    listOfStrings.push(&quot; &quot; + &quot;&lt;a class=\&quot;&quot; + SectionView.ELEMENT_CLASS_MORE_LINK + &quot;\&quot; href=\&quot;&quot; + CompleteView.URL_HASH_ITEM_PREFIX + contentItem.getUuid() + &quot;\&quot; onclick=\&quot;CompleteView.clickOnLocalLink(event)\&quot;&gt;(more &#8658;)&lt;/a&gt;&quot; + &quot;&quot;);
+    listOfStrings.push(&quot;&lt;/li&gt;&quot;);
+  }
+  listOfStrings.push(&quot;&lt;/ul&gt;&quot;);
+
+  // take all the HTML and put it together
+  var finalString = listOfStrings.join(&quot;&quot;);
+  this.myDivElement.innerHTML = finalString;
+};
+
+
+// -------------------------------------------------------------------
+// End of file
+// -------------------------------------------------------------------

Added: trunk/source/page_view.js
===================================================================
--- trunk/source/page_view.js	2005-03-24 23:11:51 UTC (rev 1)
+++ trunk/source/page_view.js	2005-03-24 23:22:45 UTC (rev 2)
@@ -0,0 +1,167 @@
+/*****************************************************************************
+ page_view.js
+ 
+******************************************************************************
+ Written in 2005 by Brian Douglas Skinner &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openrecord-svn">brian.skinner at gumption.org</A>&gt;
+  
+ Copyright rights relinquished under the Creative Commons  
+ Public Domain Dedication:
+    <A HREF="http://creativecommons.org/licenses/publicdomain/">http://creativecommons.org/licenses/publicdomain/</A>
+  
+ You can copy freely from this file.  This work may be freely reproduced, 
+ distributed, transmitted, used, modified, built upon, or otherwise exploited
+ by anyone for any purpose.
+  
+ This work is provided on an &quot;AS IS&quot; basis, without warranties or conditions 
+ of any kind, either express or implied, including, without limitation, any 
+ warranties or conditions of title, non-infringement, merchantability, or 
+ fitness for a particular purpose. You are solely responsible for determining 
+ the appropriateness of using or distributing the work and assume all risks 
+ associated with use of this work, including but not limited to the risks and 
+ costs of errors, compliance with applicable laws, damage to or loss of data 
+ or equipment, and unavailability or interruption of operations.
+
+ In no event shall the authors or contributors have any liability for any 
+ direct, indirect, incidental, special, exemplary, or consequential damages,
+ however caused and on any theory of liability, whether in contract, strict 
+ liability, or tort (including negligence), arising in any way out of or in 
+ connection with the use or distribution of the work.
+*****************************************************************************/
+
+
+// -------------------------------------------------------------------
+// Dependencies:
+//   repository.js
+//   util.js
+//   section_view.js
+// -------------------------------------------------------------------
+
+
+// -------------------------------------------------------------------
+// PageView public class constants
+// -------------------------------------------------------------------
+PageView.ELEMENT_ID_SECTION_DIV_PREFIX = &quot;section_view_&quot;;
+PageView.ELEMENT_ID_SECTION_DIV_MIDFIX = &quot;_in_page_&quot;;
+
+PageView.ELEMENT_CLASS_EDIT_MODE = &quot;editmode&quot;;
+PageView.ELEMENT_CLASS_VIEW_MODE = &quot;viewmode&quot;;
+
+
+// -------------------------------------------------------------------
+// PageView class properties
+// -------------------------------------------------------------------
+// none
+
+
+/**
+ * The CompleteView uses an instance of a PageView to display a Page in the
+ * browser window.
+ *
+ * @scope    public instance constructor
+ * @param    inPage    The page item to be displayed by this view. 
+ * @param    inDivElement    The HTMLDivElement to display the HTML in. 
+ * @param    inCompleteView    The CompleteView that this PageView is nested in. 
+ */
+function PageView(inPage, inDivElement, inCompleteView) {
+  Util.assert(inPage instanceof Item);
+  Util.assert(inDivElement instanceof HTMLDivElement);
+  Util.assert(inCompleteView instanceof CompleteView);
+
+  // instance properties
+  this.myPage = inPage;
+  this.myDivElement = inDivElement;
+  this.myCompleteView = inCompleteView;
+  
+  this.myListOfSectionViews = [];
+  
+  var listOfSections = this.myPage.getValueListFromAttribute(Stevedore.UUID_FOR_ATTRIBUTE_SECTION);
+  var sectionNumber = 0;
+  for (var key in listOfSections) {
+    var section = listOfSections[key];
+    var sectionView = new SectionView(this, section, sectionNumber);
+    sectionNumber += 1;
+    this.myListOfSectionViews.push(sectionView);
+  }
+}
+
+
+/**
+ * Returns true if we are in Edit Mode.
+ *
+ * @scope    public instance method
+ * @return   A boolean value. True if we are in Edit Mode.
+ */
+PageView.prototype.isInEditMode = function () {
+  return this.myCompleteView.isInEditMode();
+};
+
+  
+/**
+ * Returns a string that gives the name of the page.
+ *
+ * @scope    public instance method
+ * @return   A string that gives the name of the page.
+ */
+PageView.prototype.getPageTitle = function () {
+  return this.myPage.getShortName();
+};
+
+  
+/**
+ * Hides the PageView by setting the div element's display style to &quot;none&quot;.
+ *
+ * @scope    public instance method
+ */
+PageView.prototype.hide = function () {
+  Util.assert(this.myDivElement instanceof HTMLDivElement);
+  this.myDivElement.style.display = &quot;none&quot;;
+};
+
+
+/**
+ * Re-creates all the HTML for the PageView, and hands the HTML to the 
+ * browser to be re-drawn.
+ *
+ * @scope    public instance method
+ */
+PageView.prototype.display = function () {
+  Util.assert(this.myDivElement instanceof HTMLDivElement);
+  
+  var listOfStrings = [];
+  var hashTableOfSectionViewsKeyedByDivId = {};
+  
+  // add an &lt;h1&gt; heading with the name of the page
+  listOfStrings.push(&quot;&lt;h1 id=\&quot;&quot; + CompleteView.URL_PAGE_PREFIX + this.myPage.getUuid() + &quot;\&quot;&gt;&quot; + this.myPage.getDisplayName() + &quot;&lt;/h1&gt;&quot;);
+  
+  var pageSummaryList = this.myPage.getValueListFromAttribute(Stevedore.UUID_FOR_ATTRIBUTE_SUMMARY);
+  for (var iKey in pageSummaryList) {
+    var summary = pageSummaryList[iKey];
+    listOfStrings.push(&quot;&lt;p&gt;&quot; + summary + &quot;&lt;/p&gt;&quot;);
+  }
+  
+  // add &lt;div&gt; elements for each of the sections on the page
+  for (var jKey in this.myListOfSectionViews) {
+    var sectionView = this.myListOfSectionViews[jKey];
+    var sectionViewDivId = PageView.ELEMENT_ID_SECTION_DIV_PREFIX + sectionView.mySectionNumber + PageView.ELEMENT_ID_SECTION_DIV_MIDFIX + this.myPage.getUuid();
+    hashTableOfSectionViewsKeyedByDivId[sectionViewDivId] = sectionView;
+    listOfStrings.push(&quot;&lt;div id=\&quot;&quot; + sectionViewDivId + &quot;\&quot;&gt;&lt;/div&gt;&quot;);
+  }
+
+  // write out all the new content 
+  var finalString = listOfStrings.join(&quot;&quot;);
+  this.myDivElement.className = (this.isInEditMode()) ? PageView.ELEMENT_CLASS_EDIT_MODE : PageView.ELEMENT_CLASS_VIEW_MODE;
+  this.myDivElement.innerHTML = finalString;
+  this.myDivElement.style.display = &quot;block&quot;;
+
+  // let each of the sectionViews add their own content
+  for (var divId in hashTableOfSectionViewsKeyedByDivId) {
+    var aSectionView = hashTableOfSectionViewsKeyedByDivId[divId];
+    var sectionDivElement = document.getElementById(divId);
+    aSectionView.setDivElement(sectionDivElement);
+  }
+};
+
+
+// -------------------------------------------------------------------
+// End of file
+// -------------------------------------------------------------------

Added: trunk/source/rectangle.js
===================================================================
--- trunk/source/rectangle.js	2005-03-24 23:11:51 UTC (rev 1)
+++ trunk/source/rectangle.js	2005-03-24 23:22:45 UTC (rev 2)
@@ -0,0 +1,155 @@
+// -------------------------------------------------------------------
+// Brian's 2005 JavaScript Coding Conventions
+//
+// + jslint approved
+//    + jslint returns &quot;ok&quot; when it looks at the code (with strictest settings)
+//    + do not use &quot;with&quot;
+//    + do not use &quot;new Function&quot;
+//    + do not use ++ and --
+// 
+// + naming conventions
+//    + capitalization
+//       + classes are initial caps (CamelCaps): &quot;Rectangle&quot;, &quot;FillPattern&quot;
+//       + all variable names and methods names are mixedCaps: &quot;fillPattern&quot;
+//       + acronyms appear in initial caps: &quot;myHtmlString&quot;, not &quot;myHTMLString&quot;
+//       + file names are the all lower case version of the class name, with underscores: &quot;rectangle&quot;, &quot;fill_pattern&quot;
+//       + directories should be all lower case, with underscores: &quot;basic_shapes&quot;
+//       + constants are all caps, with underscores: FILL_PATTERN_SOLID
+//    + variable scoping prefixes
+//       + class variables are prefixed with &quot;our&quot;
+//       + instance variables are prefixed with &quot;my&quot;
+//       + global variables are prefixed with &quot;window.global&quot;
+//       + locally scoped variables are not prefixed
+//       + function input parameters are prefixed with &quot;in&quot;
+//       + private variables are prefixed with &quot;_&quot;
+//    + class constants are prefixed with the type of the constant -- see LAYOUT_PORTRAIT
+//    + array variables are prefixed with &quot;ListOf&quot; or &quot;HashTableOf&quot; or &quot;ArrayOf&quot;
+//       + var myListOfBooks = []; &lt;-- a &quot;List&quot; has only values, no keys [&quot;Apple&quot;, &quot;Orange&quot;, &quot;Banana&quot;]
+//       + var myHashTableOfBooksKeyedByTitle = {}; &lt;-- a &quot;HashTable&quot; is an associative array with key-value pairs
+//       + var myArrayOfBooks = new Array(); &lt;-- an &quot;Array&quot; has values that are indexed by number array[23] = &quot;Apple&quot;
+//    + accessor methods are prefixed with &quot;get&quot; or &quot;is&quot; -- e.g. oval.getArea(), oval.isCircle()
+//       + any method that returns a value and does not change an object's state should be a &quot;get&quot; or &quot;is&quot; method
+//       + any method that does change an object's state should be a &quot;set&quot; method
+//    + problems are marked with FIX_ME
+//
+// + compatiblity with other browsers and other JavaScript libraries 
+//    + use &quot;get&quot; and &quot;set&quot; accessors -- do *not* assign Mozilla &quot;getter&quot; and &quot;setter&quot; methods
+//    + add methods in your own namespace -- do *not* extend built-in objects: String.prototype.toEsperanto = function ...
+//
+// + indenting
+//    + 2-space indenting
+//    + only spaces, no tabs
+//
+// + file header and footer conventions
+//    + file name is given
+//    + copyright and license statements are included
+//    + file dependencies are listed
+//    + sections for: class constants, class properties, constructor, instance methods
+//    + &quot;End of file&quot; ending
+//
+// + scoping
+//    + locally scoped variables are declared before being used: &quot;var foo&quot;, not &quot;foo
+//    + global variables are not used, except for class names
+//    + instance methods are defined on the prototype -- see getArea()
+//    + accessor methods never have side-effects
+//
+// + FIX_ME
+//    + private instance properties?
+//    + private instance methods?
+//    + class methods?
+// -------------------------------------------------------------------
+
+
+
+
+/*****************************************************************************
+ rectangle.js
+ 
+******************************************************************************
+ Written in 2005 by Brian Douglas Skinner &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openrecord-svn">brian.skinner at gumption.org</A>&gt;
+  
+ Copyright rights relinquished under the Creative Commons  
+ Public Domain Dedication:
+    <A HREF="http://creativecommons.org/licenses/publicdomain/">http://creativecommons.org/licenses/publicdomain/</A>
+  
+ You can copy freely from this file.  This work may be freely reproduced, 
+ distributed, transmitted, used, modified, built upon, or otherwise exploited
+ by anyone for any purpose.
+  
+ This work is provided on an &quot;AS IS&quot; basis, without warranties or conditions 
+ of any kind, either express or implied, including, without limitation, any 
+ warranties or conditions of title, non-infringement, merchantability, or 
+ fitness for a particular purpose. You are solely responsible for determining 
+ the appropriateness of using or distributing the work and assume all risks 
+ associated with use of this work, including but not limited to the risks and 
+ costs of errors, compliance with applicable laws, damage to or loss of data 
+ or equipment, and unavailability or interruption of operations.
+
+ In no event shall the authors or contributors have any liability for any 
+ direct, indirect, incidental, special, exemplary, or consequential damages,
+ however caused and on any theory of liability, whether in contract, strict 
+ liability, or tort (including negligence), arising in any way out of or in 
+ connection with the use or distribution of the work.
+*****************************************************************************/
+
+
+// -------------------------------------------------------------------
+// Dependencies:
+//   line.js
+// -------------------------------------------------------------------
+
+
+// -------------------------------------------------------------------
+// Rectangle public class constants
+// -------------------------------------------------------------------
+Rectangle.LAYOUT_PORTRAIT = &quot;Portrait&quot;;
+Rectangle.LAYOUT_LANDSCAPE = &quot;Landscape&quot;;
+
+Rectangle.FILL_SOLID = &quot;Solid&quot;;
+Rectangle.FILL_EMPTY = &quot;Empty&quot;;
+
+
+// -------------------------------------------------------------------
+// Rectangle class properties
+// -------------------------------------------------------------------
+Rectangle.ourHashTableOfColorsKeyedBySize = new Array();
+
+
+// -------------------------------------------------------------------
+// Rectangle.union()
+//   public class method
+// -------------------------------------------------------------------
+Rectangle.union = function (inRectOne, inRectTwo) {
+  Util.assert(inRectOne instanceof Rectangle);
+  Util.assert(inRectTwo instanceof Rectangle);
+
+  var newRectangle = new Rectangle();
+  newRectangle.myWidth = Math.max(inRectOne.myWidth, inRectTwo.myWidth);
+  newRectangle.myHeight = Math.max(inRectOne.myHeight, inRectTwo.myHeight);
+  return newRectangle;
+};
+
+
+// -------------------------------------------------------------------
+// new Rectangle()
+//   public instance constructor
+// -------------------------------------------------------------------
+function Rectangle() {
+  // instance properties
+  this.myWidth = null;
+  this.myHeight = null;
+}
+
+
+// -------------------------------------------------------------------
+// rectangle.getArea()
+//   public instance method
+// -------------------------------------------------------------------
+Rectangle.prototype.getArea = function () {
+  var area = this.myWidth * this.myHeight;
+  return area;
+};
+
+// -------------------------------------------------------------------
+// End of file
+// -------------------------------------------------------------------

Added: trunk/source/save_changes.php
===================================================================
--- trunk/source/save_changes.php	2005-03-24 23:11:51 UTC (rev 1)
+++ trunk/source/save_changes.php	2005-03-24 23:22:45 UTC (rev 2)
@@ -0,0 +1,24 @@
+&lt;?php
+$datastoreFilename = &quot;datastore.js&quot;;
+$contentToWrite = &quot;&quot; . $HTTP_RAW_POST_DATA . &quot;&quot;;
+/* 
+$contentToWrite = &quot;start &quot; . $_POST[&quot;foo&quot;] . &quot; middle &quot; . $_POST[&quot;foo&quot;] . &quot; end&quot;;
+*/
+if (is_writable($datastoreFilename)) {
+  echo &quot;$datastoreFilename is writable.&quot;;
+  if ($fileHandle = fopen($datastoreFilename, &quot;wb&quot;)) {
+    if (fwrite($fileHandle, $contentToWrite)) {
+      echo &quot;Wrote to file ($datastoreFilename)&quot;;
+    } else {
+      echo &quot;Unable to write to file ($datastoreFilename)&quot;;
+      exit;
+    }
+  } else {
+    echo &quot;Unable to open file: $datastoreFilename&quot;;
+    exit(&quot;Unable to open file.&quot;); 
+  }
+} else {
+  echo &quot;The file $datastoreFilename is not writable.&quot;;
+}
+?&gt;
+

Added: trunk/source/section_view.js
===================================================================
--- trunk/source/section_view.js	2005-03-24 23:11:51 UTC (rev 1)
+++ trunk/source/section_view.js	2005-03-24 23:22:45 UTC (rev 2)
@@ -0,0 +1,252 @@
+/*****************************************************************************
+ section_view.js
+ 
+******************************************************************************
+ Written in 2005 by Brian Douglas Skinner &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openrecord-svn">brian.skinner at gumption.org</A>&gt;
+  
+ Copyright rights relinquished under the Creative Commons  
+ Public Domain Dedication:
+    <A HREF="http://creativecommons.org/licenses/publicdomain/">http://creativecommons.org/licenses/publicdomain/</A>
+  
+ You can copy freely from this file.  This work may be freely reproduced, 
+ distributed, transmitted, used, modified, built upon, or otherwise exploited
+ by anyone for any purpose.
+  
+ This work is provided on an &quot;AS IS&quot; basis, without warranties or conditions 
+ of any kind, either express or implied, including, without limitation, any 
+ warranties or conditions of title, non-infringement, merchantability, or 
+ fitness for a particular purpose. You are solely responsible for determining 
+ the appropriateness of using or distributing the work and assume all risks 
+ associated with use of this work, including but not limited to the risks and 
+ costs of errors, compliance with applicable laws, damage to or loss of data 
+ or equipment, and unavailability or interruption of operations.
+
+ In no event shall the authors or contributors have any liability for any 
+ direct, indirect, incidental, special, exemplary, or consequential damages,
+ however caused and on any theory of liability, whether in contract, strict 
+ liability, or tort (including negligence), arising in any way out of or in 
+ connection with the use or distribution of the work.
+*****************************************************************************/
+
+
+// -------------------------------------------------------------------
+// Dependencies:
+//   repository.js
+//   util.js
+//   page_view.js
+//   table_layout.js
+// -------------------------------------------------------------------
+
+
+// -------------------------------------------------------------------
+// SectionView public class constants
+// -------------------------------------------------------------------
+SectionView.LAYOUT_TABLE = &quot;Table&quot;;
+SectionView.LAYOUT_OUTLINE = &quot;Outline&quot;;
+SectionView.LAYOUT_DETAIL = &quot;Detail&quot;;
+SectionView.LAYOUT_BAR_CHART = &quot;Bar Chart&quot;;
+
+SectionView.ELEMENT_CLASS_SECTION = &quot;section&quot;;
+SectionView.ELEMENT_CLASS_SECTION_LAYOUT_MENU = &quot;section_layout_menu&quot;;
+SectionView.ELEMENT_CLASS_SIMPLE_TABLE = &quot;simple_table&quot;;
+SectionView.ELEMENT_CLASS_NEW_ITEM = &quot;newitem&quot;;
+SectionView.ELEMENT_CLASS_PLAIN = &quot;plain&quot;;
+SectionView.ELEMENT_CLASS_LABEL = &quot;label&quot;;
+SectionView.ELEMENT_CLASS_TITLE = &quot;title&quot;;
+SectionView.ELEMENT_CLASS_TEXT_FIELD_IN_TABLE_CELL = &quot;text_field_in_table_cell&quot;;
+SectionView.ELEMENT_CLASS_SELECTED = &quot;selected&quot;;
+SectionView.ELEMENT_CLASS_MORE_LINK = &quot;more&quot;;
+
+SectionView.ELEMENT_ID_SELECT_MENU_SUFFIX = &quot;_select_menu&quot;;
+SectionView.ELEMENT_ID_LAYOUT_DIV_SUFFIX = &quot;_layout_div&quot;;
+SectionView.ELEMENT_ID_CELL_MIDFIX = &quot;_cell_&quot;;
+
+SectionView.ELEMENT_ATTRIBUTE_SECTION_NUMBER = &quot;section_number&quot;;
+SectionView.ELEMENT_ATTRIBUTE_CELL_NUMBER = &quot;cell_number&quot;;
+
+
+// -------------------------------------------------------------------
+// SectionView class properties
+// -------------------------------------------------------------------
+SectionView.ourHashTableOfLayoutClassesKeyedByLayoutName = {};
+
+
+// -------------------------------------------------------------------
+// SectionView.getStringForValue()
+//   public class method
+// -------------------------------------------------------------------
+SectionView.getStringForValue = function (inValue) {
+  var string = &quot;&quot;;
+  if (Util.isString(inValue)) {
+    string = inValue;
+  }
+  if (inValue instanceof Item) {
+    string = inValue.getDisplayName();
+  }
+  return string;
+};
+
+
+// -------------------------------------------------------------------
+// new SectionView()
+//   public instance constructor
+// -------------------------------------------------------------------
+function SectionView(inPageView, inSection, inSectionNumber) {
+  Util.assert(inPageView instanceof PageView);
+  Util.assert(inSection instanceof Item);
+  
+  // instance properties
+  // FIX_ME: these should all be private
+  this.myPageView = inPageView;
+  this.mySection = inSection;
+  this.mySectionNumber = inSectionNumber;
+  var query = inSection.getValueListFromAttribute(Stevedore.UUID_FOR_ATTRIBUTE_QUERY)[0];
+  this.myListOfContentItems = this.getStevedore().getListOfResultItemsForQuery(query); 
+  this.myDivElement = null;
+  var layoutName = inSection.getValueListFromAttribute(Stevedore.UUID_FOR_ATTRIBUTE_LAYOUT_NAME)[0];
+  this.myLayout = this.getLayoutFromLayoutName(layoutName);
+}
+
+
+// -------------------------------------------------------------------
+//   public instance method
+// -------------------------------------------------------------------
+SectionView.prototype.getStevedore = function () {
+  return this.myPageView.myCompleteView.getStevedore();
+};
+
+
+// -------------------------------------------------------------------
+// sectionView.getLayoutFromLayoutName()
+//   public instance method
+// -------------------------------------------------------------------
+SectionView.prototype.getLayoutFromLayoutName = function (inLayoutName) {
+  Util.assert(Util.isString(inLayoutName));
+  
+  var newLayout = null;
+  for (var layoutName in SectionView.ourHashTableOfLayoutClassesKeyedByLayoutName) {
+    var layoutClass = SectionView.ourHashTableOfLayoutClassesKeyedByLayoutName[layoutName];
+    if (inLayoutName == layoutName) {
+      newLayout = new layoutClass(this);
+    }
+  }
+  return newLayout;
+};
+
+
+// -------------------------------------------------------------------
+// sectionView.setDivElement()
+//   public instance method
+// -------------------------------------------------------------------
+SectionView.prototype.setDivElement = function (inDivElement) {
+  Util.assert(inDivElement instanceof HTMLDivElement);
+
+  this.myDivElement = inDivElement;
+  this.display();
+};
+
+
+// -------------------------------------------------------------------
+// sectionView.getListOfContentItems()
+//   public instance method
+// -------------------------------------------------------------------
+SectionView.prototype.getListOfContentItems = function () {
+  var query = this.mySection.getValueListFromAttribute(Stevedore.UUID_FOR_ATTRIBUTE_QUERY)[0];
+  this.myListOfContentItems = this.getStevedore().getListOfResultItemsForQuery(query); 
+  return this.myListOfContentItems;
+};
+
+
+// -------------------------------------------------------------------
+// sectionView.display()
+//   public instance method
+// -------------------------------------------------------------------
+SectionView.prototype.display = function () {
+  if (!this.myDivElement) {
+    return;
+  }
+  var query = this.mySection.getValueListFromAttribute(Stevedore.UUID_FOR_ATTRIBUTE_QUERY)[0];
+  this.myListOfContentItems = this.getStevedore().getListOfResultItemsForQuery(query); 
+  if (!this.myListOfContentItems) {
+    return;
+  }
+
+  var listOfStrings = [];
+
+  // create the opening &lt;div&gt; for the section
+  listOfStrings.push(&quot;&lt;div class=\&quot;&quot; + SectionView.ELEMENT_CLASS_SECTION + &quot;\&quot;&gt;&quot;);
+  listOfStrings.push(&quot;&lt;h2&gt;&quot; + this.mySection.getDisplayName() + &quot;&lt;/h2&gt;&quot;);
+
+  var sectionSummaryList = this.mySection.getValueListFromAttribute(Stevedore.UUID_FOR_ATTRIBUTE_SUMMARY);
+  for (var iKey in sectionSummaryList) {
+    var summary = sectionSummaryList[iKey];
+    listOfStrings.push(&quot;&lt;p&gt;&quot; + summary + &quot;&lt;/p&gt;&quot;);
+  }
+  
+  // create the layout editing controls, if we're in edit mode
+  var selectMenuId = this.myDivElement.id + SectionView.ELEMENT_ID_SELECT_MENU_SUFFIX;
+  if (this.myPageView.isInEditMode()) {
+    listOfStrings.push(&quot;&lt;select id=\&quot;&quot; + selectMenuId + &quot;\&quot; class=\&quot;&quot; + SectionView.ELEMENT_CLASS_SECTION_LAYOUT_MENU + &quot;\&quot; name=\&quot;&quot; + selectMenuId + &quot;\&quot; &quot; + SectionView.ELEMENT_ATTRIBUTE_SECTION_NUMBER + &quot;=\&quot;&quot; + this.mySectionNumber + &quot;\&quot;&gt;&quot;);
+    for (var layoutName in SectionView.ourHashTableOfLayoutClassesKeyedByLayoutName) {
+      listOfStrings.push(&quot;&lt;option &quot; + ((this.myLayout.getLayoutName() == layoutName) ? &quot;selected&quot; : &quot;&quot;) + &quot; value=\&quot;&quot; + layoutName + &quot;\&quot; onclick=\&quot;SectionView.clickOnLayoutSelectionMenu(event)\&quot;&gt;&quot; + layoutName + &quot;&lt;/option&gt;:&quot;);
+    }
+    listOfStrings.push(&quot;&lt;/select&gt;&quot;);
+  }
+  
+  // create a div element for the layout class to use
+  var layoutDivId = this.myDivElement.id + SectionView.ELEMENT_ID_LAYOUT_DIV_SUFFIX;
+  listOfStrings.push(&quot;&lt;div id=\&quot;&quot; + layoutDivId + &quot;\&quot;&gt;&lt;/div&gt;&quot;);
+  
+  // create the closing &lt;/div&gt; for the section
+  listOfStrings.push(&quot;&lt;/div&gt;&quot;);
+  
+  // write out all the new content 
+  var finalString = listOfStrings.join(&quot;&quot;);
+  this.myDivElement.innerHTML = finalString;
+
+  // attach back-pointers to the newly created UI elements
+  if (this.myPageView.isInEditMode()) {
+    var selectElement = document.getElementById(selectMenuId);
+    selectElement.mysectionview = this;
+  }
+  var layoutDivElement = document.getElementById(layoutDivId);
+  this.myLayout.setDivElement(layoutDivElement);
+};
+  
+
+// -------------------------------------------------------------------
+// SectionView.clickOnLayoutSelectionMenu() -- called from &lt;select&gt;&lt;option&gt;
+//   public class method
+//
+// Called when the user clicks on any of the layout option-select
+// controls.
+// -------------------------------------------------------------------
+SectionView.clickOnLayoutSelectionMenu = function (inEventObject) {
+  var eventObject = inEventObject;
+  if (!eventObject) { eventObject = window.event; }
+  var optionElement = Util.getTargetFromEvent(eventObject);
+  // FIX_ME: We could replace the lines above with &quot;var optionElement = this;&quot;
+  // That would work fine in Firefox, but maybe it wouldn't work in other browsers?  
+  
+  var selectElement = optionElement.parentNode;
+  var newChoiceName = optionElement.value;
+  
+  var sectionView = selectElement.mysectionview;
+  
+  if (sectionView.myLayout.getLayoutName() == newChoiceName) {
+    // alert(&quot;line 213&quot;);
+    return;
+  } else {
+    // alert(&quot;line 216&quot;);
+    sectionView.myLayout = sectionView.getLayoutFromLayoutName(newChoiceName);
+    sectionView.mySection.clear(Stevedore.UUID_FOR_ATTRIBUTE_LAYOUT_NAME);
+    sectionView.mySection.assign(Stevedore.UUID_FOR_ATTRIBUTE_LAYOUT_NAME, newChoiceName);
+  
+    sectionView.display();
+  }
+};
+
+
+// -------------------------------------------------------------------
+// End of file
+// -------------------------------------------------------------------

Added: trunk/source/stevedore.js
===================================================================
--- trunk/source/stevedore.js	2005-03-24 23:11:51 UTC (rev 1)
+++ trunk/source/stevedore.js	2005-03-24 23:22:45 UTC (rev 2)
@@ -0,0 +1,638 @@
+/*****************************************************************************
+ stevedore.js
+ 
+******************************************************************************
+ Written in 2005 by Brian Douglas Skinner &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openrecord-svn">brian.skinner at gumption.org</A>&gt;
+  
+ Copyright rights relinquished under the Creative Commons  
+ Public Domain Dedication:
+    <A HREF="http://creativecommons.org/licenses/publicdomain/">http://creativecommons.org/licenses/publicdomain/</A>
+  
+ You can copy freely from this file.  This work may be freely reproduced, 
+ distributed, transmitted, used, modified, built upon, or otherwise exploited
+ by anyone for any purpose.
+  
+ This work is provided on an &quot;AS IS&quot; basis, without warranties or conditions 
+ of any kind, either express or implied, including, without limitation, any 
+ warranties or conditions of title, non-infringement, merchantability, or 
+ fitness for a particular purpose. You are solely responsible for determining 
+ the appropriateness of using or distributing the work and assume all risks 
+ associated with use of this work, including but not limited to the risks and 
+ costs of errors, compliance with applicable laws, damage to or loss of data 
+ or equipment, and unavailability or interruption of operations.
+
+ In no event shall the authors or contributors have any liability for any 
+ direct, indirect, incidental, special, exemplary, or consequential damages,
+ however caused and on any theory of liability, whether in contract, strict 
+ liability, or tort (including negligence), arising in any way out of or in 
+ connection with the use or distribution of the work.
+*****************************************************************************/
+
+ 
+// -------------------------------------------------------------------
+// Dependencies:
+//   util.js
+//   item.js
+// -------------------------------------------------------------------
+
+
+// -------------------------------------------------------------------
+// Stevedore public class constants
+// -------------------------------------------------------------------
+Stevedore.UUID_FOR_ATTRIBUTE_UUID = 100;
+Stevedore.UUID_FOR_ATTRIBUTE_SHORT_NAME = 101;
+Stevedore.UUID_FOR_ATTRIBUTE_NAME = 102;
+Stevedore.UUID_FOR_ATTRIBUTE_SUMMARY = 103;
+Stevedore.UUID_FOR_ATTRIBUTE_BODY = 104;
+Stevedore.UUID_FOR_ATTRIBUTE_CATEGORY = 105;
+Stevedore.UUID_FOR_ATTRIBUTE_USERSTAMP = 106;
+Stevedore.UUID_FOR_ATTRIBUTE_TIMESTAMP = 107;
+Stevedore.UUID_FOR_ATTRIBUTE_SECTION = 108;
+Stevedore.UUID_FOR_ATTRIBUTE_QUERY = 109;
+Stevedore.UUID_FOR_ATTRIBUTE_QUERY_MATCHING_CATEGORY = 110;
+Stevedore.UUID_FOR_ATTRIBUTE_QUERY_MATCHING_ITEM = 111;
+Stevedore.UUID_FOR_ATTRIBUTE_LAYOUT_NAME = 112;
+
+Stevedore.UUID_FOR_CATEGORY_BOOK = 141;      // here as an example only
+Stevedore.UUID_FOR_CATEGORY_MOVIE = 142;     // here as an example only
+Stevedore.UUID_FOR_CATEGORY_ATTRIBUTE = 143;
+Stevedore.UUID_FOR_CATEGORY_CATEGORY = 144;
+Stevedore.UUID_FOR_CATEGORY_PAGE = 145;
+Stevedore.UUID_FOR_CATEGORY_SECTION = 146;
+Stevedore.UUID_FOR_CATEGORY_QUERY = 147;
+
+Stevedore.JSON_MEMBER_FORMAT = &quot;format&quot;;
+Stevedore.JSON_MEMBER_TIMESTAMP = &quot;timestamp&quot;;
+Stevedore.JSON_MEMBER_DATA = &quot;data&quot;;
+Stevedore.JSON_FORMAT_2005_MARCH = &quot;2005_MARCH_ITEM_CENTRIC_LIST&quot;;
+
+Stevedore.JSON_MEMBER_TYPE = &quot;type&quot;;
+Stevedore.JSON_MEMBER_VALUE = &quot;value&quot;;
+Stevedore.JSON_TYPE_STRING_VALUE = &quot;StringValue&quot;;
+Stevedore.JSON_TYPE_UUID = &quot;Uuid&quot;;
+Stevedore.JSON_TYPE_FOREIGN_UUID = &quot;ForeignUuid&quot;;
+Stevedore.JSON_TYPE_NUMBER_VALUE = &quot;NumberValue&quot;;
+
+
+/**
+ * Instances of the Stevedore class know how to store and retrieve items to 
+ * and from a data source.
+ *
+ * @scope    public instance constructor
+ */
+function Stevedore() {
+  this._myNextAvailableUuid = 1;
+  this._myHashTableOfItemsKeyedByUuid = {};
+  this._myCountOfNestedTransactions = 0;
+  this._myHomePageItem = null;
+  this._myXMLHttpRequestObject = this._newXMLHttpRequestObject();
+  this._myListOfDirtyItems = [];
+  // this._myDirtyFlag = false;
+  
+  this._loadBootstrapItems();
+}
+
+
+/**
+ * Returns a newly created item.
+ *
+ * @scope    public instance method
+ * @param    inObserver    Optional. An object to be registered as an observer of the returned item. 
+ * @return   A newly created item.
+ */
+Stevedore.prototype.newItem = function (inObserver) {
+  var uuid = this._myNextAvailableUuid;
+  this._myNextAvailableUuid += 1;
+  var item = new Item(this, uuid);
+  this._myHashTableOfItemsKeyedByUuid[uuid] = item;
+  item.addObserver(inObserver);
+  this.markDirty(item);
+  return item;
+};
+
+
+// -------------------------------------------------------------------
+// Accessor Methods
+// -------------------------------------------------------------------
+
+/**
+ * Given a UUID, returns the item identified by that UUID.
+ *
+ * @scope    public instance method
+ * @param    inUuid    The UUID of the item to be returned. 
+ * @param    inObserver    Optional. An object to be registered as an observer of the returned item. 
+ * @return   The item identified by the given UUID.
+ */
+Stevedore.prototype.getItemFromUuid = function (inUuid, inObserver) {
+  Util.assert(Util.isNumeric(inUuid));
+  
+  var item = this._myHashTableOfItemsKeyedByUuid[inUuid];
+  if (item &amp;&amp; inObserver) {
+    item.addObserver(inObserver);
+  }
+  return item;
+};
+
+
+/**
+ * Given an attribute or an attribute's UUID, return the attribute's UUID.
+ *
+ * @scope    public instance method
+ * @param    inAttributeOrUuid    An attribute, or an attribute's UUID. 
+ * @return   The UUID of the attribute.
+ */
+Stevedore.prototype.getAttributeUuidFromAttributeOrUuid = function (inAttributeOrUuid) {
+  Util.assert((inAttributeOrUuid instanceof Item) || Util.isNumeric(inAttributeOrUuid));
+
+  var uuid = null;
+  if (Util.isNumeric(inAttributeOrUuid)) {
+    uuid = inAttributeOrUuid;
+  }
+  if (inAttributeOrUuid instanceof Item) {
+    uuid = inAttributeOrUuid.getUuid();
+  }
+  return uuid;
+};
+
+
+/**
+ * Returns the page item to be used as the home page.
+ *
+ * @scope    public instance method
+ * @return   A page item.
+ */
+Stevedore.prototype.getHomePage = function () {
+  return this._myHomePageItem; 
+};
+
+
+/**
+ * Given a query item, this method returns a list of all the items that 
+ * match the query criteria.
+ *
+ * @scope    public instance method
+ * @param    inQuery    A query item. 
+ * @return   A list of items.
+ */
+Stevedore.prototype.getListOfResultItemsForQuery = function (inQuery) {
+  Util.assert(inQuery instanceof Item);
+
+  var listOfQueryResultItems = null;
+  var listOfMatchingCategories = inQuery.getValueListFromAttribute(Stevedore.UUID_FOR_ATTRIBUTE_QUERY_MATCHING_CATEGORY);
+  var listOfMatchingItems = inQuery.getValueListFromAttribute(Stevedore.UUID_FOR_ATTRIBUTE_QUERY_MATCHING_ITEM);
+  var isCategoryMatchingQuery = (listOfMatchingCategories &amp;&amp; (listOfMatchingCategories.length &gt; 0));
+  var isItemMatchingQuery = (listOfMatchingItems &amp;&amp; (listOfMatchingItems.length &gt; 0));
+
+  Util.assert(!(isCategoryMatchingQuery &amp;&amp; isItemMatchingQuery));
+
+  if (isItemMatchingQuery) {
+    listOfQueryResultItems = listOfMatchingItems;
+  }
+  
+  if (isCategoryMatchingQuery) {
+    listOfQueryResultItems = [];
+    // This is a wildly inefficient search.  But maybe it doesn't matter,
+    // because this code should all be replaced someday by server code.
+    for (var uuid in this._myHashTableOfItemsKeyedByUuid) {
+      var item = this._myHashTableOfItemsKeyedByUuid[uuid];
+      var includeItem = true;
+      for (var key in listOfMatchingCategories) {
+        var category = listOfMatchingCategories[key];
+        if (includeItem &amp;&amp; !(item.isInCategory(category))) {
+          includeItem = false;
+        }
+      }
+      if (includeItem) {
+        listOfQueryResultItems.push(item);
+      }
+    }
+  }
+  
+  if (!isItemMatchingQuery &amp;&amp; !isCategoryMatchingQuery) {
+    listOfQueryResultItems = [];
+    for (var uuid in this._myHashTableOfItemsKeyedByUuid) {
+      var item = this._myHashTableOfItemsKeyedByUuid[uuid];
+      listOfQueryResultItems.push(item);
+    }
+  }
+  
+  return listOfQueryResultItems; 
+};
+
+
+
+/**
+ * Given an item and a query item, this method modifies the attributes 
+ * of the item so that when the query is next evaluated the item will be 
+ * included in query result list.
+ *
+ * @scope    public instance method
+ * @param    inItem    An item, which will be modified so that it matches the query. 
+ * @param    inQuery    A query item. 
+ */
+Stevedore.prototype.setItemToBeIncludedInQueryResultList = function (inItem, inQuery) {
+  Util.assert(inItem instanceof Item);
+  Util.assert(inQuery instanceof Item);
+
+  var listOfMatchingCategories = inQuery.getValueListFromAttribute(Stevedore.UUID_FOR_ATTRIBUTE_QUERY_MATCHING_CATEGORY);
+  var listOfMatchingItems = inQuery.getValueListFromAttribute(Stevedore.UUID_FOR_ATTRIBUTE_QUERY_MATCHING_ITEM);
+  var isCategoryMatchingQuery = (listOfMatchingCategories &amp;&amp; (listOfMatchingCategories.length &gt; 0));
+  var isItemMatchingQuery = (listOfMatchingItems &amp;&amp; (listOfMatchingItems.length &gt; 0));
+
+  Util.assert(!(isCategoryMatchingQuery &amp;&amp; isItemMatchingQuery));
+
+  if (isItemMatchingQuery) {
+    inQuery.assign(Stevedore.UUID_FOR_ATTRIBUTE_QUERY_MATCHING_ITEM, inItem);
+  }
+  
+  if (isCategoryMatchingQuery) {
+    for (var key in listOfMatchingCategories) {
+      var category = listOfMatchingCategories[key];
+      if (!(inItem.isInCategory(category))) {
+        inItem.assign(Stevedore.UUID_FOR_ATTRIBUTE_CATEGORY, category);
+      }
+    }
+  }
+};
+
+
+/**
+ * Given a category, this method returns a list of all the items that have been 
+ * assigned to that category.
+ *
+ * @scope    public instance method
+ * @param    inCategory    A category item. 
+ * @return   A list of items.
+ */
+Stevedore.prototype.getListOfItemsInCategory = function (inCategory) {
+  Util.assert(inCategory instanceof Item);
+
+  var listOfItems = [];
+  for (var uuid in this._myHashTableOfItemsKeyedByUuid) {
+    var item = this._myHashTableOfItemsKeyedByUuid[uuid];
+    if (item.isInCategory(inCategory)) {
+      listOfItems.push(item);
+    }
+    // var kindList = item.getValueListFromAttribute(Repository.ATTRIBUTE_CALLED_KIND);
+    // if (kindList) {
+    //   if (kindList[0] == inKind) {
+    //     listOfItems.push(item);
+    //   }
+    // }
+  }
+  return listOfItems; 
+};
+
+// -------------------------------------------------------------------
+// Transaction Methods
+// -------------------------------------------------------------------
+
+/**
+ * Marks the beginning of a transaction.
+ *
+ * Each time you call beginTransaction() you open a new transaction, 
+ * which you need to close later using endTransation().  Transactions
+ * may be nested, but the beginTransaction and endTransation calls
+ * always need to come in pairs. 
+ *
+ * @scope    public instance method
+ */
+Stevedore.prototype.beginTransaction = function () {
+  this._myCountOfNestedTransactions += 1;
+  // FIX_ME:
+  //   This is just a stub method for now.  Once we start implementing
+  //   support for transactions we'll have to put some real code here.
+};
+ 
+
+/**
+ * Marks the end of a transaction.
+ *
+ * @scope    public instance method
+ */
+Stevedore.prototype.endTransaction = function () {
+  this._myCountOfNestedTransactions -= 1;
+  Util.assert(this._myCountOfNestedTransactions &gt;= 0);
+  // FIX_ME:
+  //   This is just a stub method for now.  Once we start implementing
+  //   support for transactions we'll have to put some real code here.
+  if (this._myCountOfNestedTransactions === 0) {
+    CompleteView.displayStatusBlurb(this._myListOfDirtyItems.length + &quot; changes made&quot;);
+    if (this._myListOfDirtyItems &amp;&amp; (this._myListOfDirtyItems.length &gt; 0)) {
+      this._saveChangesToServer();
+      this._myListOfDirtyItems = [];
+    }
+  }
+};
+
+
+/**
+ * Marks an item as having been edited during the transaction.
+ *
+ * @scope    public instance method
+ */
+Stevedore.prototype.markDirty = function (anItem) {
+  Util.assert(Util.isArray(this._myListOfDirtyItems));
+  this._myListOfDirtyItems.push(anItem);
+};
+
+
+// -------------------------------------------------------------------
+// Private Methods
+// -------------------------------------------------------------------
+
+/**
+ * Given a UUID, either (a) returns the existing item identified by that UUID, 
+ * or (b) creates an new item object, set its UUID, and returns that object.
+ *
+ * @scope    public instance method
+ * @param    inUuid    The UUID of the item to be returned. 
+ * @param    inObserver    Optional. An object to be registered as an observer of the returned item. 
+ * @return   The item identified by the given UUID.
+ */
+Stevedore.prototype._getItemFromUuidOrBootstrapItem = function (inUuid, inObserver) {
+  var item = this.getItemFromUuid(inUuid, inObserver);
+  if (!item) {
+    item = new Item(this, inUuid);
+    this._myHashTableOfItemsKeyedByUuid[inUuid] = item;
+    this._myNextAvailableUuid = Math.max(this._myNextAvailableUuid, (inUuid + 1));   
+    item.addObserver(inObserver);
+  }
+  return item;
+};
+
+
+/**
+ * Loads the basic items that needed in order to anything else, like
+ * the items for &quot;name&quot;, &quot;attribute&quot;, and &quot;category&quot;.
+ *
+ * @scope    private instance method
+ */
+Stevedore.prototype._loadBootstrapItems = function () {
+  var uuid;
+  var name;
+  var item;
+  
+  // associate display names with the UUIDs of all the attributes
+  var hashTableOfAttributeNamesKeyedByUuid = {};
+  hashTableOfAttributeNamesKeyedByUuid[Stevedore.UUID_FOR_ATTRIBUTE_SHORT_NAME] = &quot;Short Name&quot;;
+  hashTableOfAttributeNamesKeyedByUuid[Stevedore.UUID_FOR_ATTRIBUTE_NAME] = &quot;Name&quot;;
+  hashTableOfAttributeNamesKeyedByUuid[Stevedore.UUID_FOR_ATTRIBUTE_SUMMARY] = &quot;Summary&quot;;
+  hashTableOfAttributeNamesKeyedByUuid[Stevedore.UUID_FOR_ATTRIBUTE_BODY] = &quot;Body&quot;;
+  hashTableOfAttributeNamesKeyedByUuid[Stevedore.UUID_FOR_ATTRIBUTE_CATEGORY] = &quot;Category&quot;;
+  hashTableOfAttributeNamesKeyedByUuid[Stevedore.UUID_FOR_ATTRIBUTE_USERSTAMP] = &quot;Userstamp&quot;;
+  hashTableOfAttributeNamesKeyedByUuid[Stevedore.UUID_FOR_ATTRIBUTE_TIMESTAMP] = &quot;Timestamp&quot;;
+  hashTableOfAttributeNamesKeyedByUuid[Stevedore.UUID_FOR_ATTRIBUTE_SECTION] = &quot;Section&quot;;
+  hashTableOfAttributeNamesKeyedByUuid[Stevedore.UUID_FOR_ATTRIBUTE_QUERY] = &quot;Query&quot;;
+  hashTableOfAttributeNamesKeyedByUuid[Stevedore.UUID_FOR_ATTRIBUTE_QUERY_MATCHING_CATEGORY] = &quot;Matching Category&quot;;
+  hashTableOfAttributeNamesKeyedByUuid[Stevedore.UUID_FOR_ATTRIBUTE_QUERY_MATCHING_ITEM] = &quot;Matching Item&quot;;
+  hashTableOfAttributeNamesKeyedByUuid[Stevedore.UUID_FOR_ATTRIBUTE_LAYOUT_NAME] = &quot;Layout Name&quot;;
+
+  // create all the Item objects for the attributes
+  for (uuid in hashTableOfAttributeNamesKeyedByUuid) {
+    this._getItemFromUuidOrBootstrapItem(uuid);
+  }
+  
+  // associate display names with the UUIDs of all the categories
+  var hashTableOfCategoryNamesKeyedByUuid = {};
+  hashTableOfCategoryNamesKeyedByUuid[Stevedore.UUID_FOR_CATEGORY_ATTRIBUTE] = &quot;Attribute&quot;;
+  hashTableOfCategoryNamesKeyedByUuid[Stevedore.UUID_FOR_CATEGORY_CATEGORY] = &quot;Category&quot;;
+  hashTableOfCategoryNamesKeyedByUuid[Stevedore.UUID_FOR_CATEGORY_PAGE] = &quot;Page&quot;;
+  hashTableOfCategoryNamesKeyedByUuid[Stevedore.UUID_FOR_CATEGORY_SECTION] = &quot;Section&quot;;
+  hashTableOfCategoryNamesKeyedByUuid[Stevedore.UUID_FOR_CATEGORY_QUERY] = &quot;Query&quot;;
+
+  // create all the Item objects for the categories
+  for (uuid in hashTableOfCategoryNamesKeyedByUuid) {
+    this._getItemFromUuidOrBootstrapItem(uuid);
+  }
+ 
+  // set the display names of all the attributes, and put them in the category called &quot;Attribute&quot;
+  var categoryAttribute = this._getItemFromUuidOrBootstrapItem(Stevedore.UUID_FOR_CATEGORY_ATTRIBUTE);
+  for (uuid in hashTableOfAttributeNamesKeyedByUuid) {
+    item = this.getItemFromUuid(uuid);
+    name = hashTableOfAttributeNamesKeyedByUuid[uuid];
+    item._initializeAttributeValue(Stevedore.UUID_FOR_ATTRIBUTE_NAME, name);
+    item._initializeAttributeValue(Stevedore.UUID_FOR_ATTRIBUTE_CATEGORY, categoryAttribute);
+  }
+  
+  // set the display names of all the categories, and put them in the category called &quot;Category&quot;
+  var categoryCategory = this._getItemFromUuidOrBootstrapItem(Stevedore.UUID_FOR_CATEGORY_CATEGORY);
+  for (uuid in hashTableOfCategoryNamesKeyedByUuid) {
+    item = this.getItemFromUuid(uuid);
+    name = hashTableOfCategoryNamesKeyedByUuid[uuid];
+    item._initializeAttributeValue(Stevedore.UUID_FOR_ATTRIBUTE_NAME, name);
+    item._initializeAttributeValue(Stevedore.UUID_FOR_ATTRIBUTE_CATEGORY, categoryCategory);
+  }
+  
+};
+
+
+/**
+ * Loads sample data.
+ *
+ * Given a set of sample data in JSON format, bootstraps 
+ * new instances of items corresponding to the sample data.
+ * 
+ * @scope    private instance method
+ * @param    inDataSet    A list of items to be loaded, in JSON format. 
+ */
+Stevedore.prototype._loadItemsFromList = function (inDataSet) {
+  Util.assert(Util.isArray(inDataSet) || Util.isObject(inDataSet));
+  
+  var uuidValue;
+  var uuid;
+  var item;
+  var listOfItems;
+  
+  if (Util.isArray(inDataSet)) {
+    // this is an old, pre-March-15-2005, file format
+    listOfItems = inDataSet;
+  } else {
+    // this is newer file format, circa March-16-2005
+    var fileFormat = inDataSet[Stevedore.JSON_MEMBER_FORMAT];
+    Util.assert(fileFormat == Stevedore.JSON_FORMAT_2005_MARCH);
+    listOfItems = inDataSet[Stevedore.JSON_MEMBER_DATA];
+    Util.assert(Util.isArray(listOfItems));
+  }
+  
+  for (var entryKey in listOfItems) {
+    var entry = listOfItems[entryKey];
+    uuidValue = entry[Stevedore.UUID_FOR_ATTRIBUTE_UUID];
+    uuid = uuidValue[Stevedore.JSON_MEMBER_VALUE];
+    item = this._getItemFromUuidOrBootstrapItem(uuid);
+    for (var propertyKey in entry) {
+      if (propertyKey != Stevedore.UUID_FOR_ATTRIBUTE_UUID) { 
+        var propertyValue = entry[propertyKey];
+        var attributeUuid = propertyKey;
+        Util.assert(Util.isArray(propertyValue));
+        for (var valueKey in propertyValue) {
+          var valueObject = propertyValue[valueKey];
+          var valueType = valueObject[Stevedore.JSON_MEMBER_TYPE];
+          var valueValue = valueObject[Stevedore.JSON_MEMBER_VALUE];
+          var finalValue = null;
+          switch (valueType) {
+            case Stevedore.JSON_TYPE_FOREIGN_UUID:
+              finalValue = this._getItemFromUuidOrBootstrapItem(valueValue);
+              break;
+            case Stevedore.JSON_TYPE_STRING_VALUE:
+              finalValue = valueValue;
+              break;
+            case Stevedore.JSON_TYPE_NUMBER_VALUE:
+              finalValue = valueValue;
+              break;
+          }
+          item._initializeAttributeValue(attributeUuid, finalValue);
+        }
+      }
+    }
+  }
+  
+  // FIX_ME:
+  // If we don't have a designated &quot;home page&quot; for this data set, then just
+  // look through all the items and set the home page to be the first page 
+  // item we come across.  This, of course, is a hack.
+  if (!this._myHomePageItem) {
+    var categoryPage = this.getItemFromUuid(Stevedore.UUID_FOR_CATEGORY_PAGE);
+    for (uuid in this._myHashTableOfItemsKeyedByUuid) {
+      item = this.getItemFromUuid(uuid);
+      if (item.isInCategory(categoryPage)) {
+        this._myHomePageItem = this._myHomePageItem || item;
+      }
+    }
+  }
+};
+
+
+/**
+ * Returns a huge string, containing a JavaScript &quot;object literal&quot;
+ * representation of the entire cache.
+ *
+ * @scope    private instance method
+ * @return   A string in JavaScript &quot;object literal&quot; format, representing all the items in the cache. 
+ */
+Stevedore.prototype._getJsonStringRepresentingAllItems = function () {
+  var timestamp = new Date();
+  var timestampString = timestamp.toString();
+  var listOfStrings = [];
+  
+  listOfStrings.push('// Repository dump, in JSON format' + '\n');
+  listOfStrings.push('Stevedore._ourRepositoryInJsonFormat = {' + '\n');
+  listOfStrings.push('  &quot;' + Stevedore.JSON_MEMBER_FORMAT + '&quot;: &quot;' + Stevedore.JSON_FORMAT_2005_MARCH + '&quot;, ' + '\n');
+  listOfStrings.push('  &quot;' + Stevedore.JSON_MEMBER_TIMESTAMP + '&quot;: &quot;' + timestampString + '&quot;, ' + '\n');
+  listOfStrings.push('  &quot;' + Stevedore.JSON_MEMBER_DATA + '&quot;: ' + '[' + '\n');
+  for (var uuid in this._myHashTableOfItemsKeyedByUuid) {
+    var uuidInJsonForm = '{ &quot;' + Stevedore.JSON_MEMBER_TYPE + '&quot;: &quot;' + Stevedore.JSON_TYPE_UUID + '&quot;, &quot;' + Stevedore.JSON_MEMBER_VALUE + '&quot;: ' + uuid + ' }';
+    listOfStrings.push('  { &quot;' + Stevedore.UUID_FOR_ATTRIBUTE_UUID + '&quot;: ' + uuidInJsonForm + ',' + '\n');
+    var item = this.getItemFromUuid(uuid);
+    var listOfAttributeUuids = item.getListOfAttributeUuids();
+    for (var attributeKey in listOfAttributeUuids) {
+      var attributeUuid = listOfAttributeUuids[attributeKey];
+      var attribute = this.getItemFromUuid(attributeUuid);
+      Util.assert(attribute instanceof Item);
+      var attributeName = attribute.getDisplayName();
+      var attributeNameSubstring = (attributeName + '          ').substring(0, 10);
+      listOfStrings.push('    /* ' + attributeNameSubstring + ' */   ');
+      listOfStrings.push('&quot;' + attributeUuid + '&quot;: [');
+      var listOfAttributeValues = item.getValueListFromAttribute(attribute);
+      for (var valueKey in listOfAttributeValues) {
+        var value = listOfAttributeValues[valueKey];
+        var pickleString = &quot;&quot;;
+        var typeString = null;
+        var valueString = null;
+        if (Util.isNumber(value)) {
+          typeString = Stevedore.JSON_TYPE_NUMBER_VALUE;
+          valueString = value;
+        }
+        if (Util.isString(value)) {
+          typeString = Stevedore.JSON_TYPE_STRING_VALUE;
+          valueString = '&quot;' + value + '&quot;';
+        }
+        if (value instanceof Item) {
+          typeString = Stevedore.JSON_TYPE_FOREIGN_UUID;
+          valueString = value.getUuid();
+        }
+        pickleString = '{ &quot;' + Stevedore.JSON_MEMBER_TYPE + '&quot;: &quot;' + typeString + '&quot;, &quot;' + Stevedore.JSON_MEMBER_VALUE + '&quot;: ' + valueString + ' }';
+        listOfStrings.push(pickleString + ', ');
+      }
+      listOfStrings.push('],\n');
+    }
+    listOfStrings.push(&quot;  },&quot; + &quot;\n&quot;);
+  }
+  listOfStrings.push(&quot;]};&quot; + &quot;\n&quot;);
+  var finalString = listOfStrings.join(&quot;&quot;);
+  return finalString;
+};
+
+
+/**
+ * Returns a newly created XMLHttpRequest object.
+ *
+ * @scope    private instance method
+ * @return   A newly created XMLHttpRequest object. 
+ */
+Stevedore.prototype._newXMLHttpRequestObject = function () {
+  var newXMLHttpRequestObject = null;
+  if (window.XMLHttpRequest) {
+    newXMLHttpRequestObject = new XMLHttpRequest();
+  } else {
+    if (window.ActiveXObject) {
+      newXMLHttpRequestObject = new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);
+    }
+  }
+  if (newXMLHttpRequestObject) {
+    newXMLHttpRequestObject.onreadystatechange = function() {
+      alert(&quot;onreadystatechange:\n&quot; +
+        &quot;readyState: &quot; + this._myXMLHttpRequestObject.readyState + &quot;\n&quot; +
+        &quot;status: &quot; + this._myXMLHttpRequestObject.status + &quot;\n&quot; +
+        &quot;statusText: &quot; + this._myXMLHttpRequestObject.statusText + &quot;\n&quot; +
+        &quot;responseText: &quot; + this._myXMLHttpRequestObject.responseText + &quot;\n&quot;);
+    };
+  }
+  return newXMLHttpRequestObject;
+};
+
+
+/**
+ * Sends all the changed items to the server, so that the server can save the
+ * changes.
+ *
+ * @scope    private instance method
+ */
+Stevedore.prototype._saveChangesToServer = function () {
+  var saveChanges = false;
+  if (window.location) {
+    if (window.location.protocol == &quot;http:&quot;) {
+      saveChanges = true;
+    }
+    if (window.location.protocol == &quot;file:&quot;) {
+      alert(&quot;I can't save changes to server, because this page was loaded from a \&quot;<A HREF="file:///\">file:///\</A>&quot; location, not a real \&quot;<A HREF="http://\">http://\</A>&quot; location.  Sorry.&quot;); 
+    }
+  }
+  
+  if (saveChanges) {
+    var url = &quot;save_changes.php&quot;;
+    this._myXMLHttpRequestObject.open(&quot;POST&quot;, url, true);
+    this._myXMLHttpRequestObject.setRequestHeader(&quot;Content-Type&quot;, &quot;text/xml&quot;);
+    this._myXMLHttpRequestObject.send(this._getJsonStringRepresentingAllItems());
+  }
+  
+};
+
+
+/**
+ * This is the event handler method that we register with the XMLHttpRequest
+ * object's onreadystatechange property.
+ *
+ * @scope    private class method
+ */
+Stevedore._handleStateChangeForXMLHttpRequestObject = function () {
+  alert(&quot;_handleStateChangeForXMLHttpRequestObject()\n&quot;); // +
+  //  &quot;readyState: &quot; + this._myXMLHttpRequestObject.readyState + &quot;\n&quot; +
+  //  &quot;status: &quot; + this._myXMLHttpRequestObject.status + &quot;\n&quot; +
+  //  &quot;statusText: &quot; + this._myXMLHttpRequestObject.statusText + &quot;\n&quot; +
+  //  &quot;responseText: &quot; + this._myXMLHttpRequestObject.responseText + &quot;\n&quot;);
+};
+
+// -------------------------------------------------------------------
+// End of file
+// -------------------------------------------------------------------

Added: trunk/source/table_layout.js
===================================================================
--- trunk/source/table_layout.js	2005-03-24 23:11:51 UTC (rev 1)
+++ trunk/source/table_layout.js	2005-03-24 23:22:45 UTC (rev 2)
@@ -0,0 +1,473 @@
+/*****************************************************************************
+ table_layout.js
+ 
+******************************************************************************
+ Written in 2005 by Brian Douglas Skinner &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openrecord-svn">brian.skinner at gumption.org</A>&gt;
+  
+ Copyright rights relinquished under the Creative Commons  
+ Public Domain Dedication:
+    <A HREF="http://creativecommons.org/licenses/publicdomain/">http://creativecommons.org/licenses/publicdomain/</A>
+  
+ You can copy freely from this file.  This work may be freely reproduced, 
+ distributed, transmitted, used, modified, built upon, or otherwise exploited
+ by anyone for any purpose.
+  
+ This work is provided on an &quot;AS IS&quot; basis, without warranties or conditions 
+ of any kind, either express or implied, including, without limitation, any 
+ warranties or conditions of title, non-infringement, merchantability, or 
+ fitness for a particular purpose. You are solely responsible for determining 
+ the appropriateness of using or distributing the work and assume all risks 
+ associated with use of this work, including but not limited to the risks and 
+ costs of errors, compliance with applicable laws, damage to or loss of data 
+ or equipment, and unavailability or interruption of operations.
+
+ In no event shall the authors or contributors have any liability for any 
+ direct, indirect, incidental, special, exemplary, or consequential damages,
+ however caused and on any theory of liability, whether in contract, strict 
+ liability, or tort (including negligence), arising in any way out of or in 
+ connection with the use or distribution of the work.
+*****************************************************************************/
+
+ 
+// -------------------------------------------------------------------
+// Dependencies:
+//   repository.js
+//   section_view.js
+//   page_view.js
+//   util.js
+// -------------------------------------------------------------------
+
+
+// -------------------------------------------------------------------
+// Register this layout type in the SectionView registry
+// -------------------------------------------------------------------
+SectionView.ourHashTableOfLayoutClassesKeyedByLayoutName[SectionView.LAYOUT_TABLE] = TableLayout;
+
+
+// -------------------------------------------------------------------
+// TableLayout public class constants
+// -------------------------------------------------------------------
+TableLayout.ELEMENT_ID_CURRENT_EDIT_FIELD = &quot;current_edit_field&quot;;
+
+
+/**
+ * When the TableLayout creates an HTML table, it sets up each HTML &quot;td&quot; table 
+ * cell element in the table to point to a corresponding CellDelegate instance.
+ *
+ * FIX_ME: This CellDelegate class should be privately owned by the
+ * TableLayout class.
+ *
+ * @scope    public instance constructor
+ */
+function _CellDelegate(inRowDelegate, inCellElementId, inCellCount, inColumnNumber, inAttribute, inTableLayout) {
+  Util.assert(inRowDelegate instanceof _RowDelegate);
+  Util.assert(inAttribute instanceof Item);
+  Util.assert(inTableLayout instanceof TableLayout);
+
+  this.myRowDelegate = inRowDelegate;
+  this.myCellElementId = inCellElementId;
+  this.myCellCount = inCellCount;
+  this.myColumnNumber = inColumnNumber;
+  this.myAttribute = inAttribute;
+  this.myTableLayout = inTableLayout;
+}
+
+
+/**
+ * When the TableLayout creates an HTML table, it sets up each HTML &quot;tr&quot; table
+ * row element in the table to point to a corresponding RowDelegate instance.
+ *
+ * FIX_ME: This RowDelegate class should be privately owned by the
+ * TableLayout class.
+ *
+ * @scope    public instance constructor
+ */
+function _RowDelegate(inContentItem, inRowNumber) {
+  Util.assert((inContentItem == null) || (inContentItem instanceof Item));
+
+  this.myContentItem = inContentItem;
+  this.myRowNumber = inRowNumber;
+  this.myArrayOfCellDelegates = new Array();
+}
+
+
+/**
+ * The TableLayout class knows how to display a Section of a Page as an
+ * HTML table.
+ *
+ * @scope    public instance constructor
+ * @param    inSectionView    The SectionView that this TableLayout will appears in. 
+ */
+function TableLayout(inSectionView) {
+  Util.assert(inSectionView instanceof SectionView);
+
+  this.mySectionView = inSectionView;
+  this.myDivElement = null;
+  this.myNumColumns = null;
+  this.myNumRows = null;
+  this.myArrayOfRowDelegates = new Array();
+  this.myNewItemCreatedFlag = false;
+}
+
+
+/**
+ * Returns a string with the display name for this type of layout.
+ *
+ * @scope    public instance method
+ * @return   A String with a display name for this type of layout. 
+ */
+TableLayout.prototype.getLayoutName = function () {
+  return SectionView.LAYOUT_TABLE;
+};
+
+  
+/**
+ * Gives the TableLayout a place on the page to put HTML code, allowing
+ * the TableLayout to display itself.
+ *
+ * @scope    public instance method
+ * @param    inDivElement    The HTMLDivElement that this layout should display itself in. 
+ */
+TableLayout.prototype.setDivElement = function (inDivElement) {
+  Util.assert(inDivElement instanceof HTMLDivElement);
+
+  this.myDivElement = inDivElement;
+  this.display();
+};
+
+
+/**
+ * Re-creates all the HTML for the TableLayout, and hands the HTML to the 
+ * browser to be re-drawn.
+ *
+ * @scope    public instance method
+ */
+TableLayout.prototype.display = function () {
+  var listOfStrings = [];
+  var hashTableOfAttributesKeyedByUuid = {};
+  var hashTableOfCellDelegatesKeyedByElementId = {};
+  var attribute = null;
+  var attributeUuid = null;
+  var contentItem = null;
+  var columnCount = 0;
+  
+  // find the union of the attribute lists of all the content items
+  var listOfContentItems = this.mySectionView.getListOfContentItems();
+  for (var iKey in listOfContentItems) {
+    contentItem = listOfContentItems[iKey];
+    var listOfAttributesForItem = contentItem.getListOfAttributeUuids();
+    for (var attributeKey in listOfAttributesForItem) {
+      attributeUuid = listOfAttributesForItem[attributeKey];
+      if (attributeUuid != Stevedore.UUID_FOR_ATTRIBUTE_CATEGORY) {
+        hashTableOfAttributesKeyedByUuid[attributeUuid] = this.mySectionView.getStevedore().getItemFromUuid(attributeUuid);
+      }
+    }
+  }
+
+  // add the table header row
+  listOfStrings.push(&quot;&lt;table class=\&quot;&quot; + SectionView.ELEMENT_CLASS_SIMPLE_TABLE + &quot;\&quot;&gt;&quot;);
+  listOfStrings.push(&quot;&lt;tr&gt;&quot;);
+  this.myNumColumns = 0;
+  for (var jKey in hashTableOfAttributesKeyedByUuid) {
+    attribute = hashTableOfAttributesKeyedByUuid[jKey];
+    this.myNumColumns += 1;
+    listOfStrings.push(&quot;&lt;th&gt;&quot; + attribute.getDisplayName() + &quot;&lt;/th&gt;&quot;);
+  }
+  listOfStrings.push(&quot;&lt;/tr&gt;&quot;);
+  
+  // add all the table body rows
+  var cellCount = 0;
+  var cellIdPrefix = this.mySectionView.myDivElement.id + SectionView.ELEMENT_ID_CELL_MIDFIX;
+  var cellId = &quot;&quot;;
+  this.myNumRows = 0;
+  for (var kKey in listOfContentItems) {
+    contentItem = listOfContentItems[kKey];
+    listOfStrings.push(&quot;&lt;tr&gt;&quot;);
+    var rowDelegate = new _RowDelegate(contentItem, this.myNumRows);
+    this.myArrayOfRowDelegates[this.myNumRows] = rowDelegate;
+    this.myNumRows += 1;
+    columnCount = 0;
+    for (var lKey in hashTableOfAttributesKeyedByUuid) {
+      attribute = hashTableOfAttributesKeyedByUuid[lKey];
+      cellCount += 1;
+      cellId = cellIdPrefix + cellCount;
+      var valueList = contentItem.getValueListFromAttribute(attribute);
+      var string = &quot;&quot;;
+      if (valueList) {
+        string = SectionView.getStringForValue(valueList[0]);
+      }
+      if (this.mySectionView.myPageView.isInEditMode()) {
+        listOfStrings.push(&quot;&lt;td class=\&quot;&quot; + SectionView.ELEMENT_CLASS_PLAIN + &quot;\&quot; id=\&quot;&quot; + cellId + &quot;\&quot; &quot; + SectionView.ELEMENT_ATTRIBUTE_SECTION_NUMBER + &quot;=\&quot;&quot; + this.mySectionView.mySectionNumber + &quot;\&quot; &quot; + SectionView.ELEMENT_ATTRIBUTE_CELL_NUMBER + &quot;=\&quot;&quot; + cellCount + &quot;\&quot; onclick=\&quot;TableLayout.clickOnCell(event)\&quot;&gt;&quot; + string + &quot;&lt;/td&gt;&quot;);
+        var cellDelegate = new _CellDelegate(rowDelegate, cellId, cellCount, columnCount, attribute, this);
+        rowDelegate.myArrayOfCellDelegates[columnCount] = cellDelegate;
+        hashTableOfCellDelegatesKeyedByElementId[cellId] = cellDelegate;
+      } else {
+        // if (columnCount == 0) {
+        //   string = &quot;&lt;a href=\&quot;&quot; + CompleteView.URL_HASH_ITEM_PREFIX + contentItem.getUuid() + &quot;\&quot; onclick=\&quot;CompleteView.clickOnLocalLink(event)\&quot;&gt;&quot; + string + &quot;&lt;/a&gt;&quot;;
+        // }
+        listOfStrings.push(&quot;&lt;td class=\&quot;&quot; + SectionView.ELEMENT_CLASS_PLAIN + &quot;\&quot;&gt;&quot; + string + &quot;&lt;/td&gt;&quot;);
+      }
+      columnCount += 1;
+    }
+    listOfStrings.push(&quot;&lt;/tr&gt;&quot;);
+  }  
+
+  // if we're in edit mode, add a row at the bottom of the table for entering new items
+  var firstCell = true;
+  var lastRowDelegate = new _RowDelegate(null, this.myNumRows);
+  this.myArrayOfRowDelegates[this.myNumRows] = lastRowDelegate;
+  this.myNumRows += 1;
+  if (this.mySectionView.myPageView.isInEditMode()) {
+    listOfStrings.push(&quot;&lt;tr&gt;&quot;);
+    columnCount = 0;
+    for (var mKey in hashTableOfAttributesKeyedByUuid) {
+      attribute = hashTableOfAttributesKeyedByUuid[mKey];
+      var contentString = (firstCell) ? &quot;&gt;&quot; : &quot;&quot;;
+      firstCell = false;
+      cellCount += 1;
+      cellId = cellIdPrefix + cellCount;
+      listOfStrings.push(&quot;&lt;td class=\&quot;&quot; + SectionView.ELEMENT_CLASS_NEW_ITEM + &quot;\&quot; id=\&quot;&quot; + cellId + &quot;\&quot; &quot; + SectionView.ELEMENT_ATTRIBUTE_SECTION_NUMBER + &quot;=\&quot;&quot; + this.mySectionView.mySectionNumber + &quot;\&quot; &quot; + SectionView.ELEMENT_ATTRIBUTE_CELL_NUMBER + &quot;=\&quot;&quot; + cellCount + &quot;\&quot; onclick=\&quot;TableLayout.clickOnCell(event)\&quot;&gt;&quot; + contentString + &quot;&lt;/td&gt;&quot;);
+      var lastRowCellDelegate = new _CellDelegate(lastRowDelegate, cellId, cellCount, columnCount, attribute, this);
+      lastRowDelegate.myArrayOfCellDelegates[columnCount] = lastRowCellDelegate;
+      hashTableOfCellDelegatesKeyedByElementId[cellId] = lastRowCellDelegate;
+      columnCount += 1;
+    }
+    listOfStrings.push(&quot;&lt;/tr&gt;&quot;);
+  }
+
+
+  listOfStrings.push(&quot;&lt;/table&gt;&quot;);
+  
+  // write out all the new content   
+  var finalString = listOfStrings.join(&quot;&quot;);
+  this.myDivElement.innerHTML = finalString;
+  
+  // attach back-pointers to the newly created UI elements
+  for (var elementId in hashTableOfCellDelegatesKeyedByElementId) {
+    var aCellDelegate = hashTableOfCellDelegatesKeyedByElementId[elementId];
+    var cellElement = document.getElementById(elementId);
+    cellElement.mydelegate = aCellDelegate;
+  }
+};
+  
+
+/**
+ * Called when the user clicks on a table cell.
+ * 
+ * Called from an HTML &quot;td&quot; element on the generated page.  There is no need
+ * to call this method directly.
+ *
+ * @scope    public class method
+ */
+TableLayout.clickOnCell = function (inEventObject) {
+  var eventObject = inEventObject;
+  if (!eventObject) { eventObject = window.event; } 
+  // FIX_ME: try this instead: var eventObject = inEventObject || window.event;
+  
+  var htmlElement = Util.getTargetFromEvent(eventObject);
+  // FIX_ME: We could replace the two lines above with &quot;var htmlElement = this;&quot;
+  // That would work fine in Firefox, but maybe it wouldn't work in other browsers?
+
+  var currentEditField = document.getElementById(TableLayout.ELEMENT_ID_CURRENT_EDIT_FIELD);
+  if (currentEditField &amp;&amp; (currentEditField == htmlElement)) {
+    // another click in the cell we're already editing -- just ignore it
+    return; 
+  }
+  TableLayout.leaveEditField();
+  TableLayout.startEditingInCell(htmlElement);
+};
+
+
+/**
+ * Called when the user first moves the cursor into one of the cells of
+ * the bottom table row, which is the row used for creating new items.
+ * 
+ * @scope    public instance method
+ * @param    inColumnNumber    An integer column number, telling which column to start editing in. 
+ */
+TableLayout.prototype.startEditingInCellForNewItemAtColumn = function (inColumnNumber) {
+  var rowForNewItemEntry = this.myNumRows - 1;
+  var rowDelegateForNewItemEntry = this.myArrayOfRowDelegates[rowForNewItemEntry];
+  var cellDelegate = rowDelegateForNewItemEntry.myArrayOfCellDelegates[inColumnNumber];
+  var nextCell = document.getElementById(cellDelegate.myCellElementId);
+  TableLayout.startEditingInCell(nextCell);
+};
+
+
+/**
+ * Given an HTML table cell element, adds a text field inside the
+ * table cell, so the user can edit the cell.
+ * 
+ * @scope    public class method
+ * @param    inCellElement    An HTMLTableCellElement. 
+ */
+TableLayout.startEditingInCell = function (inCellElement) {
+  Util.assert(inCellElement instanceof HTMLTableCellElement);
+
+  var initialEditValue = inCellElement.innerHTML.replace(/&quot;/g, &quot;&amp;quot&quot;);
+  var editFieldString = &quot;&lt;input type=\&quot;text\&quot; class=\&quot;&quot; + SectionView.ELEMENT_CLASS_TEXT_FIELD_IN_TABLE_CELL + &quot;\&quot; id=\&quot;&quot; + TableLayout.ELEMENT_ID_CURRENT_EDIT_FIELD + &quot;\&quot; value=\&quot;&quot; + initialEditValue + &quot;\&quot; size=\&quot;1\&quot;&gt;&lt;/input&gt;&quot;;
+  inCellElement.innerHTML = editFieldString;
+  inCellElement.className = SectionView.ELEMENT_CLASS_SELECTED + &quot; &quot; + inCellElement.className;
+  
+  var newEditField = document.getElementById(TableLayout.ELEMENT_ID_CURRENT_EDIT_FIELD);
+  newEditField.onkeypress = TableLayout.keyPressOnEditField;
+  newEditField.select();
+  newEditField.focus();
+};
+
+
+/**
+ * Called when the user is done editing a table cell. 
+ *
+ * @scope    public class method
+ */
+TableLayout.leaveEditField = function () {
+  var currentEditField = document.getElementById(TableLayout.ELEMENT_ID_CURRENT_EDIT_FIELD);
+
+  if (currentEditField) {
+    var newValueString = currentEditField.value;
+    var cellElement = currentEditField.parentNode;
+    var cellDelegate = cellElement.mydelegate;
+
+    // find the content item for this cell, and set the attribute to the new cell value
+    var contentItem = cellDelegate.myRowDelegate.myContentItem;
+    if (!contentItem) {
+      var sectionView = cellDelegate.myTableLayout.mySectionView;
+      var stevedore = sectionView.getStevedore();
+      contentItem = stevedore.newItem(); 
+      cellDelegate.myTableLayout.myNewItemCreatedFlag = true;
+      cellDelegate.myRowDelegate.myContentItem = contentItem;
+      var queryList = sectionView.mySection.getValueListFromAttribute(Stevedore.UUID_FOR_ATTRIBUTE_QUERY);
+      if (queryList) {
+        var query = queryList[0];
+        // FIX_ME: We should NOT get a value from the item's PRIVATE _myStevedore property
+        contentItem._myStevedore.setItemToBeIncludedInQueryResultList(contentItem, query);
+      }
+    }
+    var attribute = cellDelegate.myAttribute;
+    var valueList = contentItem.getValueListFromAttribute(attribute);
+    var oldValueString = &quot;&quot;;
+    if (valueList) {
+      oldValueString = SectionView.getStringForValue(valueList[0]);
+    }
+    if (oldValueString != newValueString) {
+      contentItem.clear(attribute);
+      contentItem.assign(attribute, newValueString);
+    }
+    
+    // remove the edit field from the cell, and replace it with the new cell value
+    valueList = contentItem.getValueListFromAttribute(attribute);
+    newValueString = &quot;&quot;;
+    if (valueList) {
+      newValueString = SectionView.getStringForValue(valueList[0]);
+    } 
+    cellElement.innerHTML = newValueString;
+    var regularExpression = new RegExp(SectionView.ELEMENT_CLASS_SELECTED, &quot;i&quot;);
+    cellElement.className = cellElement.className.replace(regularExpression, &quot;&quot;);    
+  }
+};
+
+
+/**
+ * Called when the user types a character when editing a table cell. 
+ *
+ * Called from an HTML &quot;input type='text'&quot; element within an HTML &quot;td&quot;
+ * table cell element on the generated page.  There is no need
+ * to call this method directly.
+ * 
+ * @scope    public class method
+ */
+TableLayout.keyPressOnEditField = function (inEventObject) {
+  var eventObject = inEventObject;
+  if (!eventObject) { eventObject = window.event; }
+  var asciiValueOfKey = eventObject.keyCode;
+  var shiftKeyPressed = eventObject.shiftKey;
+  
+  var MOVE_LEFT = &quot;left&quot;;
+  var MOVE_UP = &quot;up&quot;;
+  var MOVE_RIGHT = &quot;right&quot;;
+  var MOVE_DOWN = &quot;down&quot;;
+  
+  var move = null;
+  switch (asciiValueOfKey) {
+    case Util.ASCII_VALUE_FOR_LEFT_ARROW:
+      move = MOVE_LEFT;
+      break;
+    case Util.ASCII_VALUE_FOR_UP_ARROW:
+      move = MOVE_UP;
+      break;
+    case Util.ASCII_VALUE_FOR_RIGHT_ARROW:
+      move = MOVE_RIGHT;
+      break;
+    case Util.ASCII_VALUE_FOR_DOWN_ARROW:
+      move = MOVE_DOWN;
+      break;
+    case Util.ASCII_VALUE_FOR_RETURN:
+      move = (shiftKeyPressed) ? MOVE_UP : MOVE_DOWN;
+      break;
+    case Util.ASCII_VALUE_FOR_TAB:
+      move = (shiftKeyPressed) ? MOVE_LEFT : MOVE_RIGHT;
+      break;
+    default:
+      move = null;
+      break;
+  }
+  
+  if (move) {
+    var currentEditField = document.getElementById(TableLayout.ELEMENT_ID_CURRENT_EDIT_FIELD);
+    Util.assert(currentEditField == Util.getTargetFromEvent(eventObject));
+
+    var cellElement = currentEditField.parentNode;
+    var cellDelegate = cellElement.mydelegate;
+    var tableLayout = cellDelegate.myTableLayout;
+    var sectionView = tableLayout.mySectionView;
+    var userHitReturnInLastRow = false;
+    var nextCellDelegate = null;
+    var shiftBy;
+    
+    if (move == MOVE_LEFT || move == MOVE_RIGHT) {
+      shiftBy = (move == MOVE_LEFT) ? -1 : 1;
+      var nextColumnNumber = cellDelegate.myColumnNumber + shiftBy;
+      // FIX_ME: We should be able to do this in one line, using a modulo operator
+      if (nextColumnNumber &lt; 0) {
+        nextColumnNumber = (tableLayout.myNumColumns - 1);
+      }
+      if (nextColumnNumber &gt;= tableLayout.myNumColumns) {
+        nextColumnNumber = 0;
+      }
+      nextCellDelegate = cellDelegate.myRowDelegate.myArrayOfCellDelegates[nextColumnNumber];
+    }
+    
+    if (move == MOVE_UP || move == MOVE_DOWN) {
+      shiftBy = (move == MOVE_UP) ? -1 : 1;
+      var nextRowNumber = cellDelegate.myRowDelegate.myRowNumber + shiftBy;
+      if (nextRowNumber &lt; 0) {
+        nextRowNumber = (tableLayout.myNumRows - 1);
+      }
+      if (nextRowNumber &gt;= tableLayout.myNumRows) {
+        nextRowNumber = 0;
+        userHitReturnInLastRow = true;
+      }
+      var nextRowDelegate = tableLayout.myArrayOfRowDelegates[nextRowNumber];
+      nextCellDelegate = nextRowDelegate.myArrayOfCellDelegates[cellDelegate.myColumnNumber];
+    }
+    
+    var nextCellId = nextCellDelegate.myCellElementId;    
+    var nextCell = document.getElementById(nextCellId);
+    TableLayout.leaveEditField();
+    if (userHitReturnInLastRow &amp;&amp; tableLayout.myNewItemCreatedFlag) {
+      tableLayout.myNewItemCreatedFlag = false;
+      tableLayout.display();
+      tableLayout.startEditingInCellForNewItemAtColumn(cellDelegate.myColumnNumber);
+    } else {
+      if (nextCell) {
+        TableLayout.startEditingInCell(nextCell);
+      }
+    }
+  }
+};
+
+
+// -------------------------------------------------------------------
+// End of file
+// -------------------------------------------------------------------

Added: trunk/source/test_page.html
===================================================================
--- trunk/source/test_page.html	2005-03-24 23:11:51 UTC (rev 1)
+++ trunk/source/test_page.html	2005-03-24 23:22:45 UTC (rev 2)
@@ -0,0 +1,73 @@
+&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
+&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.1//EN&quot; &quot;<A HREF="http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd</A>&quot;&gt;
+&lt;html xmlns=&quot;<A HREF="http://www.w3.org/1999/xhtml">http://www.w3.org/1999/xhtml</A>&quot; xml:lang=&quot;en&quot; &gt;
+
+  &lt;head&gt;
+    &lt;title&gt;openagenda.org - Test Page&lt;/title&gt;
+    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;base_style.css&quot; /&gt;
+    &lt;script type=&quot;text/javascript&quot; src=&quot;util.js&quot;&gt;&lt;/script&gt;
+    &lt;script type=&quot;text/javascript&quot; src=&quot;complete_view.js&quot;&gt;&lt;/script&gt;
+    &lt;script type=&quot;text/javascript&quot; src=&quot;item_view.js&quot;&gt;&lt;/script&gt;
+    &lt;script type=&quot;text/javascript&quot; src=&quot;page_view.js&quot;&gt;&lt;/script&gt;
+    &lt;script type=&quot;text/javascript&quot; src=&quot;section_view.js&quot;&gt;&lt;/script&gt;
+    &lt;script type=&quot;text/javascript&quot; src=&quot;table_layout.js&quot;&gt;&lt;/script&gt;
+    &lt;script type=&quot;text/javascript&quot; src=&quot;outline_layout.js&quot;&gt;&lt;/script&gt;
+    &lt;script type=&quot;text/javascript&quot; src=&quot;detail_layout.js&quot;&gt;&lt;/script&gt;
+    &lt;script type=&quot;text/javascript&quot; src=&quot;bar_chart_layout.js&quot;&gt;&lt;/script&gt;
+    &lt;script type=&quot;text/javascript&quot; src=&quot;test_page.js&quot;&gt;&lt;/script&gt;
+    &lt;script type=&quot;text/javascript&quot; src=&quot;item.js&quot;&gt;&lt;/script&gt;
+    &lt;script type=&quot;text/javascript&quot; src=&quot;stevedore.js&quot;&gt;&lt;/script&gt;
+    &lt;script type=&quot;text/javascript&quot; src=&quot;datastore.js&quot;&gt;&lt;/script&gt;
+  &lt;/head&gt;
+  
+  &lt;body&gt;
+    &lt;p class=&quot;header&quot;&gt;
+      &lt;span class=&quot;logo&quot;&gt;
+        &lt;a href=&quot;<A HREF="http://openagenda.org">http://openagenda.org</A>&quot;&gt;&lt;span class=&quot;logostart&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;logomiddle&quot;&gt;agenda&lt;/span&gt;&lt;span class=&quot;logoend&quot;&gt;.org&lt;/span&gt;&lt;/a&gt;
+      &lt;/span&gt;
+      &lt;span id=&quot;main_control_span&quot;&gt;&lt;/span&gt;
+      &lt;br/&gt;
+    &lt;/p&gt;
+
+    &lt;noscript&gt;&lt;p&gt;Sorry, the browser you're using doesn't support JavaScript. 
+    This page won't display correctly.&lt;/p&gt;&lt;/noscript&gt;
+        
+    &lt;div class=&quot;navbar&quot; id=&quot;navbar_div&quot;&gt;&lt;/div&gt;
+    &lt;div class=&quot;content_area&quot;&gt;
+      &lt;div id=&quot;content_view_div&quot;&gt;&lt;/div&gt;
+    &lt;/div&gt;
+    &lt;div class=&quot;debug&quot; id=&quot;debug_div&quot;&gt;&lt;/div&gt;
+        
+    &lt;p class=&quot;footer&quot;&gt;
+      &lt;span class=&quot;copyright&quot;&gt;You can copy freely from this site &mdash; &lt;a href=&quot;../page/copyright.html&quot;&gt;copyright&lt;/a&gt; rights relinquished under the Creative Commons  
+      &lt;a rel=&quot;license external&quot; href=&quot;<A HREF="http://creativecommons.org/licenses/publicdomain/">http://creativecommons.org/licenses/publicdomain/</A>&quot;&gt;Public Domain Dedication&lt;/a&gt;.&lt;/span&gt;
+      &lt;span class=&quot;fileformat&quot;&gt;&lt;span id=&quot;status_blurb_span&quot;&gt;&lt;/span&gt;
+      &lt;/span&gt;
+      &lt;br/&gt;
+    &lt;/p&gt;
+    
+&lt;!-- Creative Commons metadata for Public Domain License 
+
+&lt;rdf:RDF xmlns=&quot;<A HREF="http://web.resource.org/cc/">http://web.resource.org/cc/</A>&quot;
+    xmlns:dc=&quot;<A HREF="http://purl.org/dc/elements/1.1/">http://purl.org/dc/elements/1.1/</A>&quot;
+    xmlns:rdf=&quot;<A HREF="http://www.w3.org/1999/02/22-rdf-syntax-ns#">http://www.w3.org/1999/02/22-rdf-syntax-ns#</A>&quot;&gt;
+&lt;Work rdf:about=&quot;&quot;&gt;
+   &lt;dc:title&gt;openagenda.org&lt;/dc:title&gt;
+   &lt;dc:type rdf:resource=&quot;<A HREF="http://purl.org/dc/dcmitype/Text">http://purl.org/dc/dcmitype/Text</A>&quot; /&gt;
+   &lt;license rdf:resource=&quot;<A HREF="http://web.resource.org/cc/PublicDomain">http://web.resource.org/cc/PublicDomain</A>&quot; /&gt;
+&lt;/Work&gt;
+
+&lt;License rdf:about=&quot;<A HREF="http://web.resource.org/cc/PublicDomain">http://web.resource.org/cc/PublicDomain</A>&quot;&gt;
+   &lt;permits rdf:resource=&quot;<A HREF="http://web.resource.org/cc/Reproduction">http://web.resource.org/cc/Reproduction</A>&quot; /&gt;
+   &lt;permits rdf:resource=&quot;<A HREF="http://web.resource.org/cc/Distribution">http://web.resource.org/cc/Distribution</A>&quot; /&gt;
+   &lt;permits rdf:resource=&quot;<A HREF="http://web.resource.org/cc/DerivativeWorks">http://web.resource.org/cc/DerivativeWorks</A>&quot; /&gt;
+&lt;/License&gt;
+
+&lt;/rdf:RDF&gt;
+
+--&gt;
+
+  &lt;/body&gt;
+  
+&lt;/html&gt;
+

Added: trunk/source/test_page.js
===================================================================
--- trunk/source/test_page.js	2005-03-24 23:11:51 UTC (rev 1)
+++ trunk/source/test_page.js	2005-03-24 23:22:45 UTC (rev 2)
@@ -0,0 +1,111 @@
+/*****************************************************************************
+ test_page.js
+ 
+******************************************************************************
+ Written in 2005 by Brian Douglas Skinner &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openrecord-svn">brian.skinner at gumption.org</A>&gt;
+  
+ Copyright rights relinquished under the Creative Commons  
+ Public Domain Dedication:
+    <A HREF="http://creativecommons.org/licenses/publicdomain/">http://creativecommons.org/licenses/publicdomain/</A>
+  
+ You can copy freely from this file.  This work may be freely reproduced, 
+ distributed, transmitted, used, modified, built upon, or otherwise exploited
+ by anyone for any purpose.
+  
+ This work is provided on an &quot;AS IS&quot; basis, without warranties or conditions 
+ of any kind, either express or implied, including, without limitation, any 
+ warranties or conditions of title, non-infringement, merchantability, or 
+ fitness for a particular purpose. You are solely responsible for determining 
+ the appropriateness of using or distributing the work and assume all risks 
+ associated with use of this work, including but not limited to the risks and 
+ costs of errors, compliance with applicable laws, damage to or loss of data 
+ or equipment, and unavailability or interruption of operations.
+
+ In no event shall the authors or contributors have any liability for any 
+ direct, indirect, incidental, special, exemplary, or consequential damages,
+ however caused and on any theory of liability, whether in contract, strict 
+ liability, or tort (including negligence), arising in any way out of or in 
+ connection with the use or distribution of the work.
+*****************************************************************************/
+
+
+// -------------------------------------------------------------------
+// Dependencies:
+//   repository.js
+//   complete_view.js
+// -------------------------------------------------------------------
+
+
+// -------------------------------------------------------------------
+// Global constants
+// -------------------------------------------------------------------
+window.GLOBAL_ELEMENT_ID_NAVBAR_DIV = &quot;navbar_div&quot;;
+window.GLOBAL_ELEMENT_ID_CONTENT_VIEW_DIV = &quot;content_view_div&quot;;
+window.GLOBAL_ELEMENT_ID_DEBUG_DIV = &quot;debug_div&quot;;
+window.GLOBAL_ELEMENT_ID_MAIN_CONTROL_SPAN = &quot;main_control_span&quot;;
+window.GLOBAL_ELEMENT_ID_STATUS_BLURB_SPAN = &quot;status_blurb_span&quot;;
+                  
+
+/**
+ * Called when the window first loads. Calls all the functions that do 
+ * initialization when the page is loaded.
+ *
+ * @scope    global function
+ */
+window.doOnloadActions = function() {  
+  Util.setTargetsForExternalLinks();
+  
+  // Repository.initialize();
+  
+  var navbarDivElement = document.getElementById(window.GLOBAL_ELEMENT_ID_NAVBAR_DIV);
+  var contentViewDivElement = document.getElementById(window.GLOBAL_ELEMENT_ID_CONTENT_VIEW_DIV);
+  var debugDivElement = document.getElementById(window.GLOBAL_ELEMENT_ID_DEBUG_DIV);
+  var mainControlSpanElement = document.getElementById(window.GLOBAL_ELEMENT_ID_MAIN_CONTROL_SPAN);
+  var statusBlurbSpanElement = document.getElementById(window.GLOBAL_ELEMENT_ID_STATUS_BLURB_SPAN);
+
+  Util.assert(navbarDivElement instanceof HTMLDivElement);
+  Util.assert(contentViewDivElement instanceof HTMLDivElement);
+  Util.assert(debugDivElement instanceof HTMLDivElement);
+  Util.assert(mainControlSpanElement instanceof HTMLSpanElement);
+  Util.assert(statusBlurbSpanElement instanceof HTMLSpanElement);
+
+  var stevedore = new Stevedore();
+  stevedore._loadItemsFromList(Stevedore._ourRepositoryInJsonFormat);
+  window.completeView = new CompleteView(stevedore, navbarDivElement, contentViewDivElement, debugDivElement, mainControlSpanElement, statusBlurbSpanElement);
+  // window.completeView.displayTextInDebugTextarea(stevedore._getPickleForAllItems());
+};
+
+
+/**
+ * Called when the user leaves the browser window.  Save any unsaved changes,
+ * and prepare to exit.
+ *
+ * @scope    global function
+ */
+window.doOnunloadActions = function() {
+  // stevedore.saveChanges();
+};
+
+window.doOnfocusActions = function() {
+  // window.completeView.displayTextInDebugTextarea(&quot;onfocus&quot;);
+};
+
+window.doOnblurActions = function() {
+  // window.completeView.displayTextInDebugTextarea(&quot;onblur&quot;);
+};
+
+
+// -------------------------------------------------------------------
+// Register for window events
+// -------------------------------------------------------------------
+window.onload = window.doOnloadActions;
+window.onunload = window.doOnunloadActions;
+window.onerror = Util.handleError;
+window.onfocus = window.doOnfocusActions;
+window.onblur = window.doOnblurActions;
+// window.onresize = window.doOnresizeActions;
+
+
+// -------------------------------------------------------------------
+// End of file
+// -------------------------------------------------------------------

Added: trunk/source/util.js
===================================================================
--- trunk/source/util.js	2005-03-24 23:11:51 UTC (rev 1)
+++ trunk/source/util.js	2005-03-24 23:22:45 UTC (rev 2)
@@ -0,0 +1,367 @@
+/*****************************************************************************
+ util.js
+ 
+******************************************************************************
+ Written in 2005 by Brian Douglas Skinner &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openrecord-svn">brian.skinner at gumption.org</A>&gt;
+  
+ Copyright rights relinquished under the Creative Commons  
+ Public Domain Dedication:
+    <A HREF="http://creativecommons.org/licenses/publicdomain/">http://creativecommons.org/licenses/publicdomain/</A>
+  
+ You can copy freely from this file.  This work may be freely reproduced, 
+ distributed, transmitted, used, modified, built upon, or otherwise exploited
+ by anyone for any purpose.
+  
+ This work is provided on an &quot;AS IS&quot; basis, without warranties or conditions 
+ of any kind, either express or implied, including, without limitation, any 
+ warranties or conditions of title, non-infringement, merchantability, or 
+ fitness for a particular purpose. You are solely responsible for determining 
+ the appropriateness of using or distributing the work and assume all risks 
+ associated with use of this work, including but not limited to the risks and 
+ costs of errors, compliance with applicable laws, damage to or loss of data 
+ or equipment, and unavailability or interruption of operations.
+
+ In no event shall the authors or contributors have any liability for any 
+ direct, indirect, incidental, special, exemplary, or consequential damages,
+ however caused and on any theory of liability, whether in contract, strict 
+ liability, or tort (including negligence), arising in any way out of or in 
+ connection with the use or distribution of the work.
+*****************************************************************************/
+ 
+
+/**
+ * The Util class offers general utility methods that might
+ * be useful in a wide variety of applications.
+ *
+ * There is no need to ever call this constructor.  All the Util
+ * methods are class methods, not instance methods, and the only 
+ * reason this constructor exists is to cause the name &quot;Util&quot;
+ * to be a globally-scoped class name, which the class methods 
+ * can then be attached to.
+ *
+ * @scope    public instance constructor
+ * @syntax   DO NOT CALL THIS CONSTRUCTOR
+ */
+function Util() {
+}
+
+
+// -------------------------------------------------------------------
+// Util public class constants
+// -------------------------------------------------------------------
+Util.ASCII_VALUE_FOR_RETURN = 13;
+Util.ASCII_VALUE_FOR_TAB = 9;
+Util.ASCII_VALUE_FOR_ESCAPE = 27;
+
+// &#37; = %
+// &#38; = &amp;
+// &#39; = '
+// &#40; = (
+Util.ASCII_VALUE_FOR_LEFT_ARROW = 37;  // 123
+Util.ASCII_VALUE_FOR_UP_ARROW = 38;    // 126
+Util.ASCII_VALUE_FOR_RIGHT_ARROW = 39; // 124
+Util.ASCII_VALUE_FOR_DOWN_ARROW = 40;  // 125
+
+/**
+ * Returns a copy of the input string, cleaned up so that it can be 
+ * included in a valid HTML page.
+ *
+ * Returns a copy of the string, but with the original characters 
+ * '&lt;', '&gt;', and '&amp;' all replaced by their HTML entities: &quot;&lt;&quot;, 
+ * &quot;&gt;&quot;, and &quot;&amp;&quot;.  Allows strings to displayed on HTML pages.
+ *
+ * @scope    public class method
+ * @syntax   var cleanString = Util.getCleanString(dirtyString);
+ * @param    inString    A dirty string to be cleaned up.
+ * @return   String
+ */
+Util.getCleanString = function(inString) {
+  Util.assert(Util.isString(inString));
+  
+  var returnString = inString;
+  returnString = returnString.replace(/&amp;/g, &quot;&amp;&quot;);
+  returnString = returnString.replace(/&lt;/g, &quot;&lt;&quot;);
+  returnString = returnString.replace(/&gt;/g, &quot;&gt;&quot;);
+  returnString = returnString.replace(/&quot;/g, &quot;&quot;&quot;);
+  return returnString;
+};
+
+
+/**
+ * Registers a function to be used to report errors.
+ *
+ * @scope    public class method
+ * @param    inFunction    A function which takes a single string argument. 
+ */
+Util.setErrorReportCallback = function (inFunction) {
+  Util.ourErrorReporter = inFunction;
+};
+
+
+/**
+ * This defaultErrorReporter simply calls &quot;alert&quot; to report errors.
+ *
+ * @scope    public class method
+ * @param    inText    The error message to be reported. 
+ */
+Util.defaultErrorReporter = function (inText) {
+  window.alert(inText);
+};
+Util.ourErrorReporter = Util.defaultErrorReporter;
+
+ 
+ /**
+ * Pops up an alert box showing an error message.
+ *
+ * @scope    public class method
+ * @param    inMessage    A string describing the error.
+ * @param    inUrl    A string that gives the name of the file where the error was found.
+ * @param    inLine    The line number where the error was found.
+ */
+Util.handleError = function (inMessage, inUrl, inLine) {
+  Util.ourErrorReporter(&quot;Util.handleError()\n&quot; + inMessage + &quot;\nline: &quot; + inLine + &quot;\nURL: &quot; + inUrl);
+};
+
+
+/**
+ * Pops up an alert box if the assertion fails.
+ *
+ * If the asserted condition is true, this method does nothing. If the condition
+ * is false, this method pops up an alert box.  The alert box explains that an
+ * assertion failed, and it gives a stack trace showing the file name and line
+ * number where the assertion failed.
+ *
+ * @scope    public class method
+ * @param    inBoolean    A boolean value, which needs to be true for the assertion to succeed. 
+ * @param    inMessage    Optional. A string describing the assertion.
+ */
+Util.assert = function (inBoolean, inMessage) {
+  var exception = new Error();  // create an exception, just to get a stack trace
+  var stackString = exception.stack;
+  var stackList = stackString.split(&quot;\n&quot;);
+  stackList.shift(); // get rid of the &quot;ReferenceError()@:0&quot; at the start of the list
+  stackList.shift(); // get rid of the &quot;(false)@file ... util.js:67&quot; at the start of the list
+  stackList.pop();   // get rid of the trailing &quot;\n&quot;
+  stackList.pop();   // get rid of the &quot;@:0&quot; at the end of the list
+  stackString = stackList.join(&quot;\n&quot;);
+  if (Util.isBoolean(inBoolean)) {
+    if (!inBoolean) {    
+      Util.ourErrorReporter(&quot;An assert statement failed.\nThe method Util.assert() was called with a 'false' value.\nHere's the stack trace, with the line number where the assert statement failed:\n&quot; + (stackString || &quot;&quot;));
+    }
+  } else {
+    Util.ourErrorReporter(&quot;An assert statement went sour.\nThe method Util.assert() was passed a non-boolean argument.\nHere's the stack trace, with the line number where the assert statement failed:\n&quot; + (stackString || &quot;&quot;));
+  }
+};
+
+
+/**
+ * Returns true if the given value is a string.
+ *
+ * @scope    public class method
+ * @param    inValue    Any object or literal value. 
+ * @return   A boolean value. True if inValue is a string.
+ */
+Util.isString = function (inValue) {
+  return (typeof(inValue) == &quot;string&quot;);
+};
+
+
+/**
+ * Returns true if the given value is a number (and is finite number).
+ *
+ * @scope    public class method
+ * @param    inValue    Any object or literal value. 
+ * @return   A boolean value. True if inValue is a number.
+ */
+Util.isNumber = function (inValue) {
+  return ((typeof(inValue) == &quot;number&quot;) &amp;&amp; isFinite(inValue));
+};
+
+
+/**
+ * Returns true if the given value is a number or a string that 
+ * represents a number.
+ *
+ * @scope    public class method
+ * @param    inValue    Any object or literal value. 
+ * @return   A boolean value. True if inValue is a number or a string that represents a number.
+ */
+Util.isNumeric = function (inValue) {
+  var isNumber = Util.isNumber(inValue);
+  if (isNumber) {
+    return true;
+  }
+  var isNumeric = Util.isString(inValue) &amp;&amp; Util.isNumber(parseInt(inValue));
+  return isNumeric;
+};
+
+
+/**
+ * Returns true if the given value is a boolean.
+ *
+ * @scope    public class method
+ * @param    inValue    Any object or literal value. 
+ * @return   A boolean value. True if inValue is a boolean.
+ */
+Util.isBoolean = function (inValue) {
+  return (typeof(inValue) == &quot;boolean&quot;);
+};
+
+
+/**
+ * Returns true if the given value is an object.
+ *
+ * @scope    public class method
+ * @param    inValue    Any object or literal value. 
+ * @return   A boolean value. True if inValue is an object.
+ */
+Util.isObject = function (inValue) {
+  return (inValue &amp;&amp; (typeof(inValue) == &quot;object&quot;));
+};
+
+
+/**
+ * Returns true if the given value is an array.
+ *
+ * @scope    public class method
+ * @param    inValue    Any object or literal value. 
+ * @return   A boolean value. True if inValue is an array.
+ */
+Util.isArray = function (inValue) {
+  return (inValue &amp;&amp; (typeof(inValue) == &quot;object&quot;) &amp;&amp; (inValue.constructor == Array));
+};
+
+
+/**
+ * Returns true if the given value is a hash table.
+ *
+ * @scope    public class method
+ * @param    inValue    Any object or literal value. 
+ * @return   A boolean value. True if inValue is a hash table.
+ */
+Util.isHashTable = function (inValue) {
+  return (inValue &amp;&amp; (typeof(inValue) == &quot;object&quot;));  // FIX_ME: we should be more restrictive!
+};
+
+
+/**
+ * Given an event object, returns the HTML element that was the 
+ * target of the event.  
+ * 
+ * Should work for IE, Mozilla, and _some_ other browsers.  
+ *
+ * @scope    public class method
+ * @param    inEventObject    An event object. 
+ * @return   An HTML element.
+ */
+Util.getTargetFromEvent = function (inEventObject) {
+  var target = null;
+  if (inEventObject.target) {
+    target = inEventObject.target;
+  } else {
+    if (inEventObject.srcElement) {
+      target = inEventObject.srcElement;
+    }
+  }
+  if (target &amp;&amp; target.nodeType == 3) { // defeat Safari bug
+    target = target.parentNode;
+  }
+  return target;
+};
+
+
+/**
+ * Looks at all the anchor links in the document, finds the ones with the 
+ * attribute rel=&quot;external&quot;, and sets the target attribute of those anchor
+ * links so that the links will open in a new browser window.  
+ * 
+ * @scope    public class method
+ */
+Util.setTargetsForExternalLinks = function () {
+  if (!window.document.getElementsByTagName) {
+    return;
+  }
+  var listOfAnchorElements = window.document.getElementsByTagName(&quot;a&quot;);
+  for (var i=0; i&lt;listOfAnchorElements.length; i+=1) {
+    var anchor = listOfAnchorElements[i];
+    // FIX_ME: This only works if the &quot;rel&quot; attribute has a single value == &quot;external&quot;.
+    // To make it work with multi-valued rel attributes, we should do some regular
+    // expression matching to check for strings like &quot;external&quot;, &quot;foo external&quot;, 
+    // and &quot;external foo&quot;.
+    if (anchor.getAttribute(&quot;href&quot;) &amp;&amp; (anchor.getAttribute(&quot;rel&quot;) == &quot;external&quot;)) {
+      anchor.target = &quot;_blank&quot;;
+    }
+  }
+};
+
+
+/**
+ * Returns true if the given object is a member of the set.  
+ * 
+ * @scope    public class method
+ * @param    inObject    The object to look for. 
+ * @param    inSet    The Array to look for the object in. 
+ * @return   Returns true if the object was found in the set.
+ */
+Util.isObjectInSet = function (inObject, inSet) {
+  Util.assert(Util.isArray(inSet));
+  
+  for (var i=0; i&lt;inSet.length; i+=1) {
+    if (inSet[i] == inObject) {
+      return true;
+    }
+  }
+  return false;
+};
+
+
+/**
+ * Removes an object from an array.  
+ * 
+ * @scope    public class method
+ * @param    inObject    The object to be removed. 
+ * @param    inSet    The Array that the object should be removed from. 
+ * @return   Returns true if the object was removed from the array.
+ */
+Util.removeObjectFromSet = function (inObject, inSet) {
+  Util.assert(Util.isArray(inSet));
+  
+  if (!inObject) {
+    return false;
+  }
+  for (var i=0; i&lt;inSet.length; i+=1) {
+    if (inSet[i] == inObject) {
+      inSet.splice(i, 1);
+      return true;
+    }
+  }
+  return false;
+};
+
+
+/**
+ * This method is similar to array.push(object), but it will only add the
+ * object to the array if the object is not already in the array.  
+ * 
+ * @scope    public class method
+ * @param    inObject    The object to be added. 
+ * @param    inSet    The Array that the object should be added to. 
+ * @return   Returns true if the object was added to the array.
+ */
+Util.addObjectToSet = function (inObject, inSet) {
+  Util.assert(Util.isArray(inSet));
+
+  if (!inObject) {
+    return false;
+  }
+  if (Util.isObjectInSet(inObject, inSet)) {
+    return false;
+  }
+  inSet.push(inObject);
+  return true;
+};
+
+
+// -------------------------------------------------------------------
+// End of file
+// -------------------------------------------------------------------


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000000.html">[openrecord-svn] r1 - /
</A></li>
	<LI>Next message: <A HREF="000002.html">[openrecord-svn] r3 - trunk/source
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1">[ date ]</a>
              <a href="thread.html#1">[ thread ]</a>
              <a href="subject.html#1">[ subject ]</a>
              <a href="author.html#1">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/openrecord-svn">More information about the openrecord-svn
mailing list</a><br>
</body></html>
